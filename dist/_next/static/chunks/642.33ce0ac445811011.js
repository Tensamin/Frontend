"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[642],{12642:(t,e,r)=>{let n,i,f;r.d(e,{x448:()=>eh});let o=BigInt(0x100000000-1),s=BigInt(32),u=(t,e,r)=>t<<r|e>>>32-r,a=(t,e,r)=>e<<r|t>>>32-r,l=(t,e,r)=>e<<r-32|t>>>64-r,c=(t,e,r)=>t<<r-32|e>>>64-r,h="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function d(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name}function p(t){if(!Number.isSafeInteger(t)||t<0)throw Error("positive integer expected, got "+t)}function g(t,...e){if(!d(t))throw Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw Error("Uint8Array expected of length "+e+", got length="+t.length)}function y(t,e=!0){if(t.destroyed)throw Error("Hash instance has been destroyed");if(e&&t.finished)throw Error("Hash#digest() has already been called")}function m(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}let E=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0]?t=>t:function(t){for(let r=0;r<t.length;r++){var e;t[r]=(e=t[r])<<24&0xff000000|e<<8&0xff0000|e>>>8&65280|e>>>24&255}return t},w="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,B=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function b(t){if(g(t),w)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=B[t[r]];return e}let x={_0:48,_9:57,A:65,F:70,a:97,f:102};function I(t){return t>=x._0&&t<=x._9?t-x._0:t>=x.A&&t<=x.F?t-(x.A-10):t>=x.a&&t<=x.f?t-(x.a-10):void 0}function v(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);if(w)return Uint8Array.fromHex(t);let e=t.length,r=e/2;if(e%2)throw Error("hex string expected, got unpadded hex of length "+e);let n=new Uint8Array(r);for(let e=0,i=0;e<r;e++,i+=2){let r=I(t.charCodeAt(i)),f=I(t.charCodeAt(i+1));if(void 0===r||void 0===f)throw Error('hex string expected, got non-hex character "'+(t[i]+t[i+1])+'" at index '+i);n[e]=16*r+f}return n}function A(t){if("string"!=typeof t)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function O(t){return"string"==typeof t&&(t=A(t)),g(t),t}function R(...t){let e=0;for(let r=0;r<t.length;r++){let n=t[r];g(n),e+=n.length}let r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){let i=t[e];r.set(i,n),n+=i.length}return r}class S{}function U(t=32){if(h&&"function"==typeof h.getRandomValues)return h.getRandomValues(new Uint8Array(t));if(h&&"function"==typeof h.randomBytes)return Uint8Array.from(h.randomBytes(t));throw Error("crypto.getRandomValues must be defined")}let q=BigInt(0),F=BigInt(1),N=BigInt(2),L=BigInt(7),T=BigInt(256),k=BigInt(113),V=[],Z=[],C=[];for(let t=0,e=F,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],V.push(2*(5*n+r)),Z.push((t+1)*(t+2)/2%64);let i=q;for(let t=0;t<7;t++)(e=(e<<F^(e>>L)*k)%T)&N&&(i^=F<<(F<<BigInt(t))-F);C.push(i)}let j=function(t,e=!1){let r=t.length,n=new Uint32Array(r),i=new Uint32Array(r);for(let f=0;f<r;f++){let{h:r,l:u}=function(t,e=!1){return e?{h:Number(t&o),l:Number(t>>s&o)}:{h:0|Number(t>>s&o),l:0|Number(t&o)}}(t[f],e);[n[f],i[f]]=[r,u]}return[n,i]}(C,!0),P=j[0],_=j[1],K=(t,e,r)=>r>32?l(t,e,r):u(t,e,r),G=(t,e,r)=>r>32?c(t,e,r):a(t,e,r);class D extends S{constructor(t,e,r,n=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=e,this.outputLen=r,this.enableXOF=n,this.rounds=i,p(r),!(0<t&&t<200))throw Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=function(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}(this.state)}clone(){return this._cloneInto()}keccak(){E(this.state32),function(t,e=24){let r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let e=0;e<10;e++)r[e]=t[e]^t[e+10]^t[e+20]^t[e+30]^t[e+40];for(let e=0;e<10;e+=2){let n=(e+8)%10,i=(e+2)%10,f=r[i],o=r[i+1],s=K(f,o,1)^r[n],u=G(f,o,1)^r[n+1];for(let r=0;r<50;r+=10)t[e+r]^=s,t[e+r+1]^=u}let e=t[2],i=t[3];for(let r=0;r<24;r++){let n=Z[r],f=K(e,i,n),o=G(e,i,n),s=V[r];e=t[s],i=t[s+1],t[s]=f,t[s+1]=o}for(let e=0;e<50;e+=10){for(let n=0;n<10;n++)r[n]=t[e+n];for(let n=0;n<10;n++)t[e+n]^=~r[(n+2)%10]&r[(n+4)%10]}t[0]^=P[n],t[1]^=_[n]}m(r)}(this.state32,this.rounds),E(this.state32),this.posOut=0,this.pos=0}update(t){y(this),g(t=O(t));let{blockLen:e,state:r}=this,n=t.length;for(let i=0;i<n;){let f=Math.min(e-this.pos,n-i);for(let e=0;e<f;e++)r[this.pos++]^=t[i++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:e,pos:r,blockLen:n}=this;t[r]^=e,(128&e)!=0&&r===n-1&&this.keccak(),t[n-1]^=128,this.keccak()}writeInto(t){y(this,!1),g(t),this.finish();let e=this.state,{blockLen:r}=this;for(let n=0,i=t.length;n<i;){this.posOut>=r&&this.keccak();let f=Math.min(r-this.posOut,i-n);t.set(e.subarray(this.posOut,this.posOut+f),n),this.posOut+=f,n+=f}return t}xofInto(t){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return p(t),this.xofInto(new Uint8Array(t))}digestInto(t){g(t);let e=this.outputLen;if(t.length<e)throw Error("digestInto() expects output buffer of length at least "+e);if(this.finished)throw Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,m(this.state)}_cloneInto(t){let{blockLen:e,suffix:r,outputLen:n,rounds:i,enableXOF:f}=this;return t||(t=new D(e,r,n,f,i)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=i,t.suffix=r,t.outputLen=n,t.enableXOF=f,t.destroyed=this.destroyed,t}}let H=(n=31,i=136,f=32,function(t){let e=(e,r)=>t(r).update(O(e)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=e=>t(e),e}((t={})=>new D(136,31,void 0===t.dkLen?32:t.dkLen,!0))),Y=BigInt(0),z=BigInt(1);function X(t,e=""){if("boolean"!=typeof t)throw Error((e&&`"${e}"`)+"expected boolean, got type="+typeof t);return t}function $(t,e,r=""){let n=d(t),i=t?.length,f=void 0!==e;if(!n||f&&i!==e)throw Error((r&&`"${r}" `)+"expected Uint8Array"+(f?` of length ${e}`:"")+", got "+(n?`length=${i}`:`type=${typeof t}`));return t}function M(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);return""===t?Y:BigInt("0x"+t)}function W(t){return g(t),M(b(Uint8Array.from(t).reverse()))}function J(t,e){return v(t.toString(16).padStart(2*e,"0"))}function Q(t,e){return J(t,e).reverse()}function tt(t,e,r){let n;if("string"==typeof e)try{n=v(e)}catch(e){throw Error(t+" must be hex string or Uint8Array, cause: "+e)}else if(d(e))n=Uint8Array.from(e);else throw Error(t+" must be hex string or Uint8Array");let i=n.length;if("number"==typeof r&&i!==r)throw Error(t+" of length "+r+" expected, got "+i);return n}function te(t){return Uint8Array.from(t)}let tr=t=>"bigint"==typeof t&&Y<=t;function tn(t,e,r,n){if(!(tr(e)&&tr(r)&&tr(n))||!(r<=e)||!(e<n))throw Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}let ti=t=>(z<<BigInt(t))-z;function tf(t,e,r={}){if(!t||"object"!=typeof t)throw Error("expected valid options object");function n(e,r,n){let i=t[e];if(n&&void 0===i)return;let f=typeof i;if(f!==r||null===i)throw Error(`param "${e}" is invalid: expected ${r}, got ${f}`)}Object.entries(e).forEach(([t,e])=>n(t,e,!1)),Object.entries(r).forEach(([t,e])=>n(t,e,!0))}let to=()=>{throw Error("not implemented")};function ts(t){let e=new WeakMap;return(r,...n)=>{let i=e.get(r);if(void 0!==i)return i;let f=t(r,...n);return e.set(r,f),f}}let tu=BigInt(0),ta=BigInt(1),tl=BigInt(2),tc=BigInt(3),th=BigInt(4),td=BigInt(5),tp=BigInt(7),tg=BigInt(8),ty=BigInt(9),tm=BigInt(16);function tE(t,e){let r=t%e;return r>=tu?r:e+r}function tw(t,e,r){let n=t;for(;e-- >tu;)n*=n,n%=r;return n}function tB(t,e){if(t===tu)throw Error("invert: expected non-zero number");if(e<=tu)throw Error("invert: expected positive modulus, got "+e);let r=tE(t,e),n=e,i=tu,f=ta,o=ta,s=tu;for(;r!==tu;){let t=n/r,e=n%r,u=i-o*t,a=f-s*t;n=r,r=e,i=o,f=s,o=u,s=a}if(n!==ta)throw Error("invert: does not exist");return tE(i,e)}function tb(t,e,r){if(!t.eql(t.sqr(e),r))throw Error("Cannot find square root")}function tx(t,e){let r=(t.ORDER+ta)/th,n=t.pow(e,r);return tb(t,n,e),n}function tI(t,e){let r=(t.ORDER-td)/tg,n=t.mul(e,tl),i=t.pow(n,r),f=t.mul(e,i),o=t.mul(t.mul(f,tl),i),s=t.mul(f,t.sub(o,t.ONE));return tb(t,s,e),s}function tv(t){if(t<tc)throw Error("sqrt is not defined for small field");let e=t-ta,r=0;for(;e%tl===tu;)e/=tl,r++;let n=tl,i=tU(t);for(;1===tS(i,n);)if(n++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===r)return tx;let f=i.pow(n,e),o=(e+ta)/tl;return function(t,n){if(t.is0(n))return n;if(1!==tS(t,n))throw Error("Cannot find square root");let i=r,s=t.mul(t.ONE,f),u=t.pow(n,e),a=t.pow(n,o);for(;!t.eql(u,t.ONE);){if(t.is0(u))return t.ZERO;let e=1,r=t.sqr(u);for(;!t.eql(r,t.ONE);)if(e++,r=t.sqr(r),e===i)throw Error("Cannot find square root");let n=ta<<BigInt(i-e-1),f=t.pow(s,n);i=e,s=t.sqr(f),u=t.mul(u,s),a=t.mul(a,f)}return a}}let tA=(t,e)=>(tE(t,e)&ta)===ta,tO=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function tR(t,e,r=!1){let n=Array(e.length).fill(r?t.ZERO:void 0),i=e.reduce((e,r,i)=>t.is0(r)?e:(n[i]=e,t.mul(e,r)),t.ONE),f=t.inv(i);return e.reduceRight((e,r,i)=>t.is0(r)?e:(n[i]=t.mul(e,n[i]),t.mul(e,r)),f),n}function tS(t,e){let r=(t.ORDER-ta)/tl,n=t.pow(e,r),i=t.eql(n,t.ONE),f=t.eql(n,t.ZERO),o=t.eql(n,t.neg(t.ONE));if(!i&&!f&&!o)throw Error("invalid Legendre symbol result");return i?1:f?0:-1}function tU(t,e,r=!1,n={}){let i,f,o,s;if(t<=tu)throw Error("invalid field: expected ORDER > 0, got "+t);let u=!1;if("object"==typeof e&&null!=e){if(n.sqrt||r)throw Error("cannot specify opts in two arguments");e.BITS&&(f=e.BITS),e.sqrt&&(o=e.sqrt),"boolean"==typeof e.isLE&&(r=e.isLE),"boolean"==typeof e.modFromBytes&&(u=e.modFromBytes),s=e.allowedLengths}else"number"==typeof e&&(f=e),n.sqrt&&(o=n.sqrt);let{nBitLength:a,nByteLength:l}=function(t,e){void 0!==e&&p(e);let r=void 0!==e?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}(t,f);if(l>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let c=Object.freeze({ORDER:t,isLE:r,BITS:a,BYTES:l,MASK:ti(a),ZERO:tu,ONE:ta,allowedLengths:s,create:e=>tE(e,t),isValid:e=>{if("bigint"!=typeof e)throw Error("invalid field element: expected bigint, got "+typeof e);return tu<=e&&e<t},is0:t=>t===tu,isValidNot0:t=>!c.is0(t)&&c.isValid(t),isOdd:t=>(t&ta)===ta,neg:e=>tE(-e,t),eql:(t,e)=>t===e,sqr:e=>tE(e*e,t),add:(e,r)=>tE(e+r,t),sub:(e,r)=>tE(e-r,t),mul:(e,r)=>tE(e*r,t),pow:(t,e)=>(function(t,e,r){if(r<tu)throw Error("invalid exponent, negatives unsupported");if(r===tu)return t.ONE;if(r===ta)return e;let n=t.ONE,i=e;for(;r>tu;)r&ta&&(n=t.mul(n,i)),i=t.sqr(i),r>>=ta;return n})(c,t,e),div:(e,r)=>tE(e*tB(r,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>tB(e,t),sqrt:o||(e=>(i||(i=t%th===tc?tx:t%tg===td?tI:t%tm===ty?function(t){let e=tU(t),r=tv(t),n=r(e,e.neg(e.ONE)),i=r(e,n),f=r(e,e.neg(n)),o=(t+tp)/tm;return(t,e)=>{let r=t.pow(e,o),s=t.mul(r,n),u=t.mul(r,i),a=t.mul(r,f),l=t.eql(t.sqr(s),e),c=t.eql(t.sqr(u),e);r=t.cmov(r,s,l),s=t.cmov(a,u,c);let h=t.eql(t.sqr(s),e),d=t.cmov(r,s,h);return tb(t,d,e),d}}(t):tv(t)),i(c,e))),toBytes:t=>r?Q(t,l):J(t,l),fromBytes:(e,n=!0)=>{if(s){if(!s.includes(e.length)||e.length>l)throw Error("Field.fromBytes: expected "+s+" bytes, got "+e.length);let t=new Uint8Array(l);t.set(e,r?0:t.length-e.length),e=t}if(e.length!==l)throw Error("Field.fromBytes: expected "+l+" bytes, got "+e.length);let i=r?W(e):M(b(e));if(u&&(i=tE(i,t)),!n&&!c.isValid(i))throw Error("invalid field element: outside of range 0..ORDER");return i},invertBatch:t=>tR(c,t),cmov:(t,e,r)=>r?e:t});return Object.freeze(c)}let tq=BigInt(0),tF=BigInt(1);function tN(t,e){let r=e.negate();return t?r:e}function tL(t,e){let r=tR(t.Fp,e.map(t=>t.Z));return e.map((e,n)=>t.fromAffine(e.toAffine(r[n])))}function tT(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw Error("invalid window size, expected [1.."+e+"], got W="+t)}function tk(t,e){tT(t,e);let r=Math.ceil(e/t)+1,n=2**(t-1),i=2**t;return{windows:r,windowSize:n,mask:ti(t),maxNumber:i,shiftBy:BigInt(t)}}function tV(t,e,r){let{windowSize:n,mask:i,maxNumber:f,shiftBy:o}=r,s=Number(t&i),u=t>>o;s>n&&(s-=f,u+=tF);let a=e*n,l=a+Math.abs(s)-1,c=0===s;return{nextN:u,offset:l,isZero:c,isNeg:s<0,isNegF:e%2!=0,offsetF:a}}let tZ=new WeakMap,tC=new WeakMap;function tj(t){return tC.get(t)||1}function tP(t){if(t!==tq)throw Error("invalid wNAF")}class t_{constructor(t,e){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=e}_unsafeLadder(t,e,r=this.ZERO){let n=t;for(;e>tq;)e&tF&&(r=r.add(n)),n=n.double(),e>>=tF;return r}precomputeWindow(t,e){let{windows:r,windowSize:n}=tk(e,this.bits),i=[],f=t,o=f;for(let t=0;t<r;t++){o=f,i.push(o);for(let t=1;t<n;t++)o=o.add(f),i.push(o);f=o.double()}return i}wNAF(t,e,r){if(!this.Fn.isValid(r))throw Error("invalid scalar");let n=this.ZERO,i=this.BASE,f=tk(t,this.bits);for(let t=0;t<f.windows;t++){let{nextN:o,offset:s,isZero:u,isNeg:a,isNegF:l,offsetF:c}=tV(r,t,f);r=o,u?i=i.add(tN(l,e[c])):n=n.add(tN(a,e[s]))}return tP(r),{p:n,f:i}}wNAFUnsafe(t,e,r,n=this.ZERO){let i=tk(t,this.bits);for(let t=0;t<i.windows&&r!==tq;t++){let{nextN:f,offset:o,isZero:s,isNeg:u}=tV(r,t,i);if(r=f,!s){let t=e[o];n=n.add(u?t.negate():t)}}return tP(r),n}getPrecomputes(t,e,r){let n=tZ.get(e);return n||(n=this.precomputeWindow(e,t),1!==t&&("function"==typeof r&&(n=r(n)),tZ.set(e,n))),n}cached(t,e,r){let n=tj(t);return this.wNAF(n,this.getPrecomputes(n,t,r),e)}unsafe(t,e,r,n){let i=tj(t);return 1===i?this._unsafeLadder(t,e,n):this.wNAFUnsafe(i,this.getPrecomputes(i,t,r),e,n)}createCache(t,e){tT(e,this.bits),tC.set(t,e),tZ.delete(t)}hasCache(t){return 1!==tj(t)}}function tK(t,e,r,n){(function(t,e){if(!Array.isArray(t))throw Error("array expected");t.forEach((t,r)=>{if(!(t instanceof e))throw Error("invalid point at index "+r)})})(r,t),function(t,e){if(!Array.isArray(t))throw Error("array of scalars expected");t.forEach((t,r)=>{if(!e.isValid(t))throw Error("invalid scalar at index "+r)})}(n,e);let i=r.length,f=n.length;if(i!==f)throw Error("arrays of points and scalars must have equal length");let o=t.ZERO,s=function(t){let e;for(e=0;t>Y;t>>=z,e+=1);return e}(BigInt(i)),u=1;s>12?u=s-3:s>4?u=s-2:s>0&&(u=2);let a=ti(u),l=Array(Number(a)+1).fill(o),c=Math.floor((e.BITS-1)/u)*u,h=o;for(let t=c;t>=0;t-=u){l.fill(o);for(let e=0;e<f;e++){let i=Number(n[e]>>BigInt(t)&a);l[i]=l[i].add(r[e])}let e=o;for(let t=l.length-1,r=o;t>0;t--)r=r.add(l[t]),e=e.add(r);if(h=h.add(e),0!==t)for(let t=0;t<u;t++)h=h.double()}return h}function tG(t,e,r){if(!e)return tU(t,{isLE:r});if(e.ORDER!==t)throw Error("Field.ORDER must match order: Fp == p, Fn == n");return tf(e,tO.reduce((t,e)=>(t[e]="function",t),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"})),e}let tD=BigInt(0),tH=BigInt(1),tY=BigInt(2),tz=BigInt(8);function tX(t,e={}){let r=function(t,e,r={},n){if(void 0===n&&(n="edwards"===t),!e||"object"!=typeof e)throw Error(`expected valid ${t} CURVE object`);for(let t of["p","n","h"]){let r=e[t];if(!("bigint"==typeof r&&r>tq))throw Error(`CURVE.${t} must be positive bigint`)}let i=tG(e.p,r.Fp,n),f=tG(e.n,r.Fn,n);for(let r of["Gx","Gy","a","weierstrass"===t?"b":"d"])if(!i.isValid(e[r]))throw Error(`CURVE.${r} must be valid field element of CURVE.Fp`);return{CURVE:e=Object.freeze(Object.assign({},e)),Fp:i,Fn:f}}("edwards",t,e,e.FpFnLE),{Fp:n,Fn:i}=r,f=r.CURVE,{h:o}=f;tf(e,{},{uvRatio:"function"});let s=tY<<BigInt(8*i.BYTES)-tH,u=t=>n.create(t),a=e.uvRatio||((t,e)=>{try{return{isValid:!0,value:n.sqrt(n.div(t,e))}}catch(t){return{isValid:!1,value:tD}}});if(!function(t,e,r,n){let i=t.sqr(r),f=t.sqr(n),o=t.add(t.mul(e.a,i),f),s=t.add(t.ONE,t.mul(e.d,t.mul(i,f)));return t.eql(o,s)}(n,f,f.Gx,f.Gy))throw Error("bad curve params: generator point");function l(t,e,r=!1){return tn("coordinate "+t,e,r?tH:tD,s),e}function c(t){if(!(t instanceof p))throw Error("ExtendedPoint expected")}let h=ts((t,e)=>{let{X:r,Y:i,Z:f}=t,o=t.is0();null==e&&(e=o?tz:n.inv(f));let s=u(r*e),a=u(i*e),l=n.mul(f,e);if(o)return{x:tD,y:tH};if(l!==tH)throw Error("invZ was invalid");return{x:s,y:a}}),d=ts(t=>{let{a:e,d:r}=f;if(t.is0())throw Error("bad point: ZERO");let{X:n,Y:i,Z:o,T:s}=t,a=u(n*n),l=u(i*i),c=u(o*o),h=u(c*c),d=u(a*e);if(u(c*u(d+l))!==u(h+u(r*u(a*l))))throw Error("bad point: equation left != right (1)");if(u(n*i)!==u(o*s))throw Error("bad point: equation left != right (2)");return!0});class p{constructor(t,e,r,n){this.X=l("x",t),this.Y=l("y",e),this.Z=l("z",r,!0),this.T=l("t",n),Object.freeze(this)}static CURVE(){return f}static fromAffine(t){if(t instanceof p)throw Error("extended point not allowed");let{x:e,y:r}=t||{};return l("x",e),l("y",r),new p(e,r,tH,u(e*r))}static fromBytes(t,e=!1){let r=n.BYTES,{a:i,d:o}=f;t=te($(t,r,"point")),X(e,"zip215");let l=te(t),c=t[r-1];l[r-1]=-129&c;let h=W(l);tn("point.y",h,tD,e?s:n.ORDER);let d=u(h*h),{isValid:g,value:y}=a(u(d-tH),u(o*d-i));if(!g)throw Error("bad point: invalid y coordinate");let m=(y&tH)===tH,E=(128&c)!=0;if(!e&&y===tD&&E)throw Error("bad point: x=0 and x_0=1");return E!==m&&(y=u(-y)),p.fromAffine({x:y,y:h})}static fromHex(t,e=!1){return p.fromBytes(tt("point",t),e)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(t=8,e=!0){return g.createCache(this,t),e||this.multiply(tY),this}assertValidity(){d(this)}equals(t){c(t);let{X:e,Y:r,Z:n}=this,{X:i,Y:f,Z:o}=t,s=u(e*o),a=u(i*n),l=u(r*o),h=u(f*n);return s===a&&l===h}is0(){return this.equals(p.ZERO)}negate(){return new p(u(-this.X),this.Y,this.Z,u(-this.T))}double(){let{a:t}=f,{X:e,Y:r,Z:n}=this,i=u(e*e),o=u(r*r),s=u(tY*u(n*n)),a=u(t*i),l=e+r,c=u(u(l*l)-i-o),h=a+o,d=h-s,g=a-o,y=u(c*d),m=u(h*g),E=u(c*g);return new p(y,m,u(d*h),E)}add(t){c(t);let{a:e,d:r}=f,{X:n,Y:i,Z:o,T:s}=this,{X:a,Y:l,Z:h,T:d}=t,g=u(n*a),y=u(i*l),m=u(s*r*d),E=u(o*h),w=u((n+i)*(a+l)-g-y),B=E-m,b=E+m,x=u(y-e*g),I=u(w*B),v=u(b*x),A=u(w*x);return new p(I,v,u(B*b),A)}subtract(t){return this.add(t.negate())}multiply(t){if(!i.isValidNot0(t))throw Error("invalid scalar: expected 1 <= sc < curve.n");let{p:e,f:r}=g.cached(this,t,t=>tL(p,t));return tL(p,[e,r])[0]}multiplyUnsafe(t,e=p.ZERO){if(!i.isValid(t))throw Error("invalid scalar: expected 0 <= sc < curve.n");return t===tD?p.ZERO:this.is0()||t===tH?this:g.unsafe(this,t,t=>tL(p,t),e)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}isTorsionFree(){return g.unsafe(this,f.n).is0()}toAffine(t){return h(this,t)}clearCofactor(){return o===tH?this:this.multiplyUnsafe(o)}toBytes(){let{x:t,y:e}=this.toAffine(),r=n.toBytes(e);return r[r.length-1]|=t&tH?128:0,r}toHex(){return b(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(t){return tL(p,t)}static msm(t,e){return tK(p,i,t,e)}_setWindowSize(t){this.precompute(t)}toRawBytes(){return this.toBytes()}}p.BASE=new p(f.Gx,f.Gy,tH,u(f.Gx*f.Gy)),p.ZERO=new p(tD,tH,tH,tD),p.Fp=n,p.Fn=i;let g=new t_(p,i.BITS);return p.BASE.precompute(8),p}class t${constructor(t){this.ep=t}static fromBytes(t){to()}static fromHex(t){to()}get x(){return this.toAffine().x}get y(){return this.toAffine().y}clearCofactor(){return this}assertValidity(){this.ep.assertValidity()}toAffine(t){return this.ep.toAffine(t)}toHex(){return b(this.toBytes())}toString(){return this.toHex()}isTorsionFree(){return!0}isSmallOrder(){return!1}add(t){return this.assertSame(t),this.init(this.ep.add(t.ep))}subtract(t){return this.assertSame(t),this.init(this.ep.subtract(t.ep))}multiply(t){return this.init(this.ep.multiply(t))}multiplyUnsafe(t){return this.init(this.ep.multiplyUnsafe(t))}double(){return this.init(this.ep.double())}negate(){return this.init(this.ep.negate())}precompute(t,e){return this.init(this.ep.precompute(t,e))}toRawBytes(){return this.toBytes()}}function tM(t,e){if(tW(t),tW(e),t<0||t>=1<<8*e)throw Error("invalid I2OSP input: "+t);let r=Array.from({length:e}).fill(0);for(let n=e-1;n>=0;n--)r[n]=255&t,t>>>=8;return new Uint8Array(r)}function tW(t){if(!Number.isSafeInteger(t))throw Error("number expected")}function tJ(t){if(!d(t)&&"string"!=typeof t)throw Error("DST must be Uint8Array or string");return"string"==typeof t?A(t):t}A("HashToScalar-");let tQ=BigInt(0),t0=BigInt(1),t1=BigInt(2),t2={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x3fffffffffffffffffffffffffffffffffffffffffffffffffffffff7cca23e9c44edb49aed63690216cc2728dc58f552378c292ab5844f3"),h:BigInt(4),a:BigInt(1),d:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffff6756"),Gx:BigInt("0x4f1970c66bed0ded221d15a622bf36da9e146570470f1767ea6de324a3d3a46412ae1af72ab66511433b80e18b00938e2626a82bc70cc05e"),Gy:BigInt("0x693f46716eb6bc248876203756c9c7624bea73736ca3984087789c1e05a0c2d73ad3ff1ce67c39c4fdbd132c4ed7c8ad9808795bf230fa14")},t8=Object.assign({},t2,{d:BigInt("0xd78b4bdc7f0daf19f24f38c29373a2ccad46157242a50f37809b1da3412a12e79ccc9c81264cfe9ad080997058fb61c4243cc32dbaa156b9"),Gx:BigInt("0x79a70b2b70400553ae7c9df416c792c61128751ac92969240c25a07d728bdc93e21f7787ed6972249de732f38496cd11698713093e9c04fc"),Gy:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffff80000000000000000000000000000000000000000000000000000001")}),t3=function(t){let e=e=>t().update(O(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}(()=>H.create({dkLen:114})),t4=BigInt(1),t6=BigInt(2),t7=BigInt(3),t5=BigInt(4),t9=BigInt(11),et=BigInt(22),ee=BigInt(44),er=BigInt(88),en=BigInt(223);function ei(t){let e=t2.p,r=t*t*t%e,n=r*r*t%e,i=tw(n,t7,e)*n%e,f=tw(i,t7,e)*n%e,o=tw(f,t6,e)*r%e,s=tw(o,t9,e)*o%e,u=tw(s,et,e)*s%e,a=tw(u,ee,e)*u%e,l=tw(a,er,e)*a%e,c=tw(l,ee,e)*u%e,h=tw(c,t6,e)*r%e,d=tw(h,t4,e)*t%e;return tw(d,en,e)*h%e}function ef(t){return t[0]&=252,t[55]|=128,t[56]=0,t}function eo(t,e){let r=t2.p,n=tE(t*t*e,r),i=tE(n*t,r),f=ei(tE(i*n*e,r)),o=tE(i*f,r),s=tE(o*o,r);return{isValid:tE(s*e,r)===t,value:o}}let es=tU(t2.p,{BITS:456,isLE:!0}),eu=tU(t2.n,{BITS:456,isLE:!0}),ea=tU(t2.p,{BITS:448,isLE:!0}),el=tU(t2.n,{BITS:448,isLE:!0}),ec=function(t){let{CURVE:e,curveOpts:r,hash:n,eddsaOpts:i}=function(t){let e={a:t.a,d:t.d,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},r={Fp:t.Fp,Fn:tU(e.n,t.nBitLength,!0),uvRatio:t.uvRatio},n={randomBytes:t.randomBytes,adjustScalarBytes:t.adjustScalarBytes,domain:t.domain,prehash:t.prehash,mapToCurve:t.mapToCurve};return{CURVE:e,curveOpts:r,hash:t.hash,eddsaOpts:n}}(t),f=function(t,e,r={}){if("function"!=typeof e)throw Error('"hash" function param is required');tf(r,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});let{prehash:n}=r,{BASE:i,Fp:f,Fn:o}=t,s=r.randomBytes||U,u=r.adjustScalarBytes||(t=>t),a=r.domain||((t,e,r)=>{if(X(r,"phflag"),e.length||r)throw Error("Contexts/pre-hash are not supported");return t});function l(t){return o.create(W(t))}function c(t){let{head:r,prefix:n,scalar:f}=function(t){let r=m.secretKey;t=tt("private key",t,r);let n=tt("hashed private key",e(t),2*r),i=u(n.slice(0,r)),f=n.slice(r,2*r),o=l(i);return{head:i,prefix:f,scalar:o}}(t),o=i.multiply(f),s=o.toBytes();return{head:r,prefix:n,scalar:f,point:o,pointBytes:s}}function h(t){return c(t).pointBytes}function p(t=Uint8Array.of(),...r){return l(e(a(R(...r),tt("context",t),!!n)))}let g={zip215:!0},y=f.BYTES,m={secretKey:y,publicKey:y,signature:2*y,seed:y};function E(t=s(m.seed)){return $(t,m.seed,"seed")}let w={getExtendedPublicKey:c,randomSecretKey:E,isValidSecretKey:function(t){return d(t)&&t.length===o.BYTES},isValidPublicKey:function(e,r){try{return!!t.fromBytes(e,r)}catch(t){return!1}},toMontgomery(e){let{y:r}=t.fromBytes(e),n=m.publicKey,i=32===n;if(!i&&57!==n)throw Error("only defined for 25519 and 448");let o=i?f.div(tH+r,tH-r):f.div(r-tH,r+tH);return f.toBytes(o)},toMontgomerySecret(t){let r=m.secretKey;return $(t,r),u(e(t.subarray(0,r))).subarray(0,r)},randomPrivateKey:E,precompute:(e=8,r=t.BASE)=>r.precompute(e,!1)};return Object.freeze({keygen:function(t){let e=w.randomSecretKey(t);return{secretKey:e,publicKey:h(e)}},getPublicKey:h,sign:function(t,e,r={}){t=tt("message",t),n&&(t=n(t));let{prefix:f,scalar:s,pointBytes:u}=c(e),a=p(r.context,f,t),l=i.multiply(a).toBytes(),h=p(r.context,l,u,t),d=o.create(a+h*s);if(!o.isValid(d))throw Error("sign failed: invalid s");return $(R(l,o.toBytes(d)),m.signature,"result")},verify:function(e,r,f,o=g){let s,u,a,{context:l,zip215:c}=o,h=m.signature;e=tt("signature",e,h),r=tt("message",r),f=tt("publicKey",f,m.publicKey),void 0!==c&&X(c,"zip215"),n&&(r=n(r));let d=h/2,y=e.subarray(0,d),E=W(e.subarray(d,h));try{s=t.fromBytes(f,c),u=t.fromBytes(y,c),a=i.multiplyUnsafe(E)}catch(t){return!1}if(!c&&s.isSmallOrder())return!1;let w=p(l,u.toBytes(),s.toBytes(),r);return u.add(s.multiplyUnsafe(w)).subtract(a).clearCofactor().is0()},utils:w,Point:t,lengths:m})}(tX(e,r),n,i),o=f.Point;return Object.assign({},f,{ExtendedPoint:o,CURVE:t,nBitLength:o.Fn.BITS,nByteLength:o.Fn.BYTES})}({...t2,Fp:es,Fn:eu,nBitLength:eu.BITS,hash:t3,adjustScalarBytes:ef,domain:function(t,e,r){var n;if(e.length>255)throw Error("context must be smaller than 255, got: "+e.length);return R((n="SigEd448",Uint8Array.from(n,(t,e)=>{let r=t.charCodeAt(0);if(1!==t.length||r>127)throw Error(`string contains non-ASCII character "${n[e]}" with code ${r} at position ${e}`);return r})),new Uint8Array([+!!r,e.length]),e,t)},uvRatio:eo});tX(t8);let eh=(()=>{let t=t2.p;return function(t){let{P:e,type:r,adjustScalarBytes:n,powPminus2:i,randomBytes:f}=(tf(t,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...t})),o="x25519"===r;if(!o&&"x448"!==r)throw Error("invalid type");let s=f||U,u=o?255:448,a=o?32:56,l=o?BigInt(9):BigInt(5),c=o?BigInt(121665):BigInt(39081),h=o?t1**BigInt(254):t1**BigInt(447),d=h+(o?BigInt(8)*t1**BigInt(251)-t0:BigInt(4)*t1**BigInt(445)-t0)+t0,p=t=>tE(t,e),y=Q(p(l),a);function m(t,r){let f=function(t,r){tn("u",t,tQ,e),tn("scalar",r,h,d);let n=t0,f=tQ,o=t,s=t0,a=tQ;for(let e=BigInt(u-1);e>=tQ;e--){let i=r>>e&t0;a^=i,({x_2:n,x_3:o}=w(a,n,o)),({x_2:f,x_3:s}=w(a,f,s)),a=i;let u=n+f,l=p(u*u),h=n-f,d=p(h*h),g=l-d,y=o+s,m=p((o-s)*u),E=p(y*h),B=m+E,b=m-E;o=p(B*B),s=p(t*p(b*b)),n=p(l*d),f=p(g*(l+p(c*g)))}return{x_2:n,x_3:o}=w(a,n,o),{x_2:f,x_3:s}=w(a,f,s),p(n*i(f))}(function(t){let e=tt("u coordinate",t,a);return o&&(e[31]&=127),p(W(e))}(r),W(n(tt("scalar",t,a))));if(f===tQ)throw Error("invalid private or public key received");return Q(p(f),a)}function E(t){return m(t,y)}function w(t,e,r){let n=p(t*(e-r));return{x_2:e=p(e-n),x_3:r=p(r+n)}}let B={secretKey:a,publicKey:a,seed:a},b=(t=s(a))=>(g(t,B.seed),t);return{keygen:function(t){let e=b(t);return{secretKey:e,publicKey:E(e)}},getSharedSecret:(t,e)=>m(t,e),getPublicKey:t=>E(t),scalarMult:m,scalarMultBase:E,utils:{randomSecretKey:b,randomPrivateKey:b},GuBytes:y.slice(),lengths:B}}({P:t,type:"x448",powPminus2:e=>tE(tw(ei(e),t6,t)*e,t),adjustScalarBytes:ef})})(),ed=BigInt("39082"),ep=BigInt("78163"),eg=BigInt("98944233647732219769177004876929019128417576295529901074099889598043702116001257856802131563896515373927712232092845883226922417596214"),ey=BigInt("315019913931389607337177038330951043522456072897266928557328499619017160722351061360252776265186336876723201881398623946864393857820716"),em=t=>eo(t4,t);function eE(t){let{d:e}=t2,r=es.ORDER,n=t=>es.create(t),i=n(-(t*t)),f=n(e*(i-t4)),o=n((f+t4)*(f-i)),{isValid:s,value:u}=eo(ep,n((i+t4)*o)),a=u;s||(a=n(t*u));let l=t4;s||(l=n(-t4));let c=n(a*(i+t4)),h=c;tA(c,r)&&(h=n(-c));let d=c*c,p=n(h*t6),g=n(d+t4),y=n(d-t4),m=n(a*c*(i-t4)*ep+l);return new ec.Point(n(p*m),n(y*g),n(g*m),n(p*y))}class ew extends t${constructor(t){super(t)}static fromAffine(t){return new ew(ec.Point.fromAffine(t))}assertSame(t){if(!(t instanceof ew))throw Error("DecafPoint expected")}init(t){return new ew(t)}static hashToCurve(t){var e=tt("decafHash",t,112);g(e,112);let r=eE(ea.create(ea.fromBytes(e.subarray(0,56),!0))),n=eE(ea.create(ea.fromBytes(e.subarray(56,112),!0)));return new ew(r.add(n))}static fromBytes(t){g(t,56);let{d:e}=t2,r=es.ORDER,n=t=>ea.create(t),i=ea.fromBytes(t);if(!function(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return 0===r}(el.toBytes(i),t)||tA(i,r))throw Error("invalid decaf448 encoding 1");let f=n(i*i),o=n(t4+f),s=n(o*o),u=n(s-t5*e*f),{isValid:a,value:l}=em(n(u*s)),c=n((i+i)*l*o*eg);tA(c,r)&&(c=n(-c));let h=n(c*l*u*ey),d=n((t4-f)*l*o),p=n(h*d);if(!a)throw Error("invalid decaf448 encoding 2");return new ew(new ec.Point(h,d,t4,p))}static fromHex(t){return ew.fromBytes(tt("decafHex",t,56))}static msm(t,e){return tK(ew,eu,t,e)}toBytes(){let{X:t,Z:e,T:r}=this.ep,n=es.ORDER,i=t=>es.create(t),f=i(i(t+r)*i(t-r)),o=i(t*t),{value:s}=em(i(f*ed*o)),u=i(s*f*eg);tA(u,n)&&(u=i(-u));let a=i(ey*u*e-r),l=i(ed*s*t*a);return tA(l,n)&&(l=i(-l)),el.toBytes(l)}equals(t){this.assertSame(t);let{X:e,Y:r}=this.ep,{X:n,Y:i}=t.ep;return es.create(e*i)===es.create(r*n)}is0(){return this.equals(ew.ZERO)}}ew.BASE=new ew(ec.Point.BASE).multiplyUnsafe(t6),ew.ZERO=new ew(ec.Point.ZERO),ew.Fp=ea,ew.Fn=el}}]);