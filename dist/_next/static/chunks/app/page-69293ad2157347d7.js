(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{8180:(e,t,a)=>{"use strict";a.d(t,{LoadingWrapper:()=>ri});var r=a(95155),s=a(12115),n=a(35695),l=a(38726),i=a(14448),c=a(54921),o=a(25384),d=a(91311),u=a(49763),m=a(53613);let h=(0,s.createContext)();function f(){let e=(0,s.useContext)(h);if(void 0===e)throw Error("useUsersContext must be used within a UsersProvider");return e}function x(e){let{children:t}=e,[a,n]=(0,s.useState)({}),[i,c]=(0,s.useState)({}),[u,m]=(0,s.useState)([]),[f,x]=(0,s.useState)([]),[g,p]=(0,s.useState)(!1),[v,b]=(0,s.useState)("ONLINE"),[j,y]=(0,s.useState)(!1),[w,N]=(0,s.useState)(!1),[_,S]=(0,s.useState)(!1);async function k(e){await A(e,!0),y(e=>!e)}async function A(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(void 0===e)return{};if(a[e]&&!t)return(0,o.Rm)("User already fetched: "+e,"debug"),a[e];{let t=null;for(let a=0;a<=5;a++)try{let a=await fetch("".concat(d.s.user).concat(e));if(!a.ok)throw Error("HTTP ".concat(a.status));let r=await a.json();if(r&&"error"!==r.type&&r.data){t=r.data;break}throw Error("API responded with error type")}catch(t){if(a<5){var r;let s=200*Math.pow(2,a);(0,o.Rm)("Retry ".concat(a+1,"/").concat(5," fetching user ").concat(e," after error: ").concat(null!=(r=null==t?void 0:t.message)?r:t),"debug"),await function(e){return new Promise(t=>setTimeout(t,e))}(s)}}t&&null!==t||(t={uuid:e,created_at:0,username:"Failed to load",display:"Failed to load",avatar:"...",about:"Failed to load",status:"",public_key:"MIICLjANBgkqhkiG9w0BAQEFAAOCAhsAMIICFgKCAg0NmcU0Xqog/GN/Fvg8EXPirko4RIHjDxq4gbQ8eqEj0ui4GpL5DVt50u/6Lx81/thYrCfg/jq75n6ARYxMgadC4BRKrpaWiKFVilprZ/8fjCpD1k3RPaxMjaKtjncxNzoCUTwQkq4Yoy++Kh8FWAim7454lNd1r1YtyeiPn/WsDX+h/PrIVqR0PStx4QHxO3SkPRwNQR+1paJBKPK4SiKGJyHNDXlcxuz6A0FD1tZ8IBidSSqloayg+kCMZpgSRceOMZONvWJKlsRkaJZcwPJ/up5aDGT55DSoHtwZpI/L3XHKNukc3+X9moj1dSTbH1yAJNQqJdyEnYD8P37+uxBS44A42aFhqrbsimcadIev+Fqp3CWiZz9oAxx3bQBeTKCj/IzMGQFdN4Lq5oGSWJE/Banb6VdaPdfdIAAP1CSXLL1KpENlJvxkD+2UKptHjoz5cVo2lv6sHZacztuLa4nzAq3AXs53D+givWHzeyXIOYEnt6tq6eLn5lfWLBCbwIaQCcEuKmoJm8qhzO9nrB3ISg42RRkLd+ccSt7ZTo+4UmkFnUsfg3F0l2/NrasWH57Sw/+EhBEDWscKKt15HdJFkeWKYPpkjSySofwq7U00bgIFvWohgGca3o04CDmSq1u2RLDayIUKAt6hNXBxcTVQeK+l/uQKFhtvz2t2Ow2d+jXDAXg4g2gJg5YBrU0CAwEAAQ==",sub_level:0,sub_end:0});let a={uuid:e,created_at:t.created_at,username:t.username,display:(0,o.lf)(t.username,t.display),avatar:t.avatar,about:function(e){try{if("string"!=typeof e||0===e.length)return"";return atob(e)}catch(t){return"string"==typeof e?e:""}}(t.about),status:t.status,public_key:t.public_key,sub_level:t.sub_level,sub_end:t.sub_end};return n(t=>({...t,[e]:a})),a}}return(0,r.jsx)(h.Provider,{value:{get:A,fetchedUsers:a,userStates:i,getUserState:function(e){return i[e]?i[e]:"none"},setUserState:function(e,t){c(a=>({...a,[e]:t}))},setUserStates:c,chatsArray:u,setChatsArray:m,communitiesArray:f,setCommunitiesArray:x,makeChatTop:function(e){let t=[...u],a=t.findIndex(t=>t.user_id===e);if(a>0){let[e]=t.splice(a,1);t.unshift(e),m(t)}},forceLoad:g,setForceLoad:p,ownUuid:l.Ay.get("auth_uuid"),ownState:v,setOwnState:b,clearFromCache:k,refetchUser:j,refreshChats:w,refreshCommunities:_,doChatRefresh:function(){N(e=>!e)},doCommunityRefresh:function(){S(e=>!e)}},children:t})}var g=a(76708);let p=(0,s.createContext)();function v(){let e=(0,s.useContext)(p);if(void 0===e)throw Error("useCryptoContext must be used within a CryptoProvider");return e}function b(e){let{children:t}=e,[a,i]=(0,s.useState)("pending"),[c,h]=(0,s.useState)("pending"),[x,v]=(0,s.useState)(!1),{decrypt_base64_using_aes:b}=(0,m.w)(),{get:j}=f(),y=(0,s.useRef)(0),w=(0,n.useRouter)();return((0,s.useEffect)(()=>{let e=!0,t=null,a=async()=>{if(!e)return;if(!window.localStorage){e&&(w.push("/login"),v(!0));return}let r=l.Ay.get("auth_private_key"),s=l.Ay.get("auth_uuid"),n=l.Ay.get("auth_cred_id");if(!r||!s){"/login"!==window.location.pathname&&e&&w.push("/login"),e&&v(!0);return}try{var c,m,f,x;let t;if((0,o.b8)()){let e=await j(s).then(e=>e.username);t=await (null==(m=window)||null==(c=m.keyring)?void 0:c.get("net.methanium.tensamin",e))}if(l.Ay.get("auth_lambda"))t=await b(l.Ay.get("auth_lambda"),await (0,o.Hm)());else{let e,a=await fetch("".concat(d.s.webauthn_login_options).concat(s,"/").concat(n)),r=await a.json();if((null==r?void 0:r.type)==="error")throw Error((null==(f=r.log)?void 0:f.message)||"Failed to get options");e=JSON.parse(atob(r.data.options));let l=await (0,u.HS)(e),i=await fetch("".concat(d.s.webauthn_login_verify).concat(s,"/").concat(n),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({attestation:l})}),c=await i.json();if((null==c?void 0:c.type)==="error")throw Error((null==(x=c.log)?void 0:x.message)||"Passkey verify failed");t=c.data.lambda}y.current=0;let a=await b(r,t),g=JSON.parse(atob(a)),p=await (0,o.sc)(g.d);e&&(h(p),i(g),v(!0))}catch(r){if((0,o.Rm)((null==r?void 0:r.message)||String(r),"error","Crypto Provider:"),!e)return;if(y.current+=1,y.current>=5){e&&(w.push("/login"),v(!0));return}t=setTimeout(()=>{a()},500)}};return a(),()=>{e=!1,t&&clearTimeout(t)}},[w,b]),x)?(0,r.jsx)(p.Provider,{value:{privateKey:a,privateKeyHash:c},children:t}):(0,r.jsx)(g.Loading,{message:"Authenticating..."})}let j=(0,s.createContext)(null),y=()=>{let e=(0,s.useContext)(j);if(!e)throw Error("useWebSocketContext must be used within a WebSocketProvider");return e},w=e=>{let{children:t}=e,a=(0,s.useRef)(new Map),{privateKeyHash:n}=v(),{setUserState:u,setUserStates:m,forceLoad:h,setForceLoad:x,clearFromCache:p,doChatRefresh:b}=f(),[y,w]=(0,s.useState)("?"),[N,_]=(0,s.useState)("?"),[S,k]=(0,s.useState)(!1),[A,C]=(0,s.useState)(!1),[E,T]=(0,s.useState)(null),[R,I]=(0,s.useState)(null),O=(0,s.useCallback)(async e=>{try{let t=JSON.parse(e.data);switch("pong"!==t.type&&(0,o.Rm)(t,"debug","Client WebSocket (Received):"),t.type){case"get_states":m(t.data.user_states);break;case"client_changed":u(t.data.user_id,t.data.user_state),p(t.data.user_id);break;case"shared_secret_return":b()}if(I(t),t.id&&a.current.has(t.id)){let{resolve:e,reject:r,timeoutId:s}=a.current.get(t.id);clearTimeout(s),a.current.delete(t.id),"error"===t.type&&S?r(Error("Received unknown response type '".concat(t.type,"' for request ID '").concat(t.id,"'."))):e(t)}else(0,o.Rm)(t.log.message,"info")}catch(e){(0,o.Rm)(e.message,"error")}},[]),{sendMessage:M,readyState:D}=(0,i.Ay)(d.s.client_wss,{onOpen:()=>(0,o.Rm)("WebSocket connected","info"),onClose:()=>{(0,o.Rm)("WebSocket disconnected","info"),a.current.forEach(e=>{let{reject:t,timeoutId:a}=e;clearTimeout(a),t(Error("WebSocket connection closed before response was received."))}),a.current.clear()},onMessage:O,shouldReconnect:()=>!0,share:!0,reconnectAttempts:5,reconnectInterval:3e3}),L=D===i.vj.OPEN,P=(0,s.useCallback)(async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0;if(!h&&D!==i.vj.CLOSED&&D!==i.vj.CLOSING){if(s){try{M(JSON.stringify({type:e,log:t,data:r}))}catch(e){(0,o.Rm)(e.message,"error")}return}return new Promise((s,n)=>{let l=(0,c.A)(),i={id:l,type:e,log:t,data:r};"ping"!==i.type&&(0,o.Rm)(i,"debug","Client WebSocket (Sent):");let d=setTimeout(()=>{a.current.delete(l),n(Error("WebSocket request timed out for ID: ".concat(l," (Type: ").concat(e,") after ").concat(1e4,"ms.")))},1e4);a.current.set(l,{resolve:s,reject:n,timeoutId:d});try{M(JSON.stringify(i))}catch(t){clearTimeout(d),a.current.delete(l);let e=Error("Failed to send WebSocket message: ".concat(t.message));(0,o.Rm)(e,"error"),n(e)}})}},[M,D,h]);return(0,s.useEffect)(()=>{let e;return L&&!h?e=setInterval(async()=>{let e=Date.now();await P("ping",{message:"Ping from Client",log_level:-1},{last_ping:e}).then(t=>{_(Date.now()-e),w(t.data.ping_iota||"?")}).catch(e=>{(0,o.Rm)(e.message,"info")})},5e3):clearInterval(e),()=>clearInterval(e)},[L,P,h]),(0,s.useEffect)(()=>{L&&!h?P("identification",{message:"Client identifying",log_level:0},{user_id:l.Ay.get("auth_uuid"),private_key_hash:n}).then(e=>{"identification_response"===e.type?k(!0):(k(!1),C(!0),T(e.log.message))}):k(!1)},[L,M,h]),(0,s.useEffect)(()=>()=>{a.current.forEach(e=>{let{reject:t,timeoutId:a}=e;clearTimeout(a);let r=Error("WebSocket provider unmounted before response was received.");(0,o.Rm)(r.toString(),"error"),t(r)}),a.current.clear()},[]),L&&(S&&!A||h)?(0,r.jsx)(j.Provider,{value:{send:P,wsSend:P,message:R,connected:L,identified:S,readyState:D,iotaPing:y,clientPing:N},children:t}):A?(0,r.jsx)(g.Loading,{message:E,error:!0,allowDebugToForceLoad:!0,returnDebug:e=>{e&&x(!0)}},A):(0,r.jsx)(g.Loading,{message:"Connecting to Omikron..."})};var N=a(56671);let _=(0,s.createContext)();function S(){let e=(0,s.useContext)(_);if(void 0===e)throw Error("useMessageContext must be used within a MessageProvider");return e}function k(e){let{children:t}=e,{privateKey:a}=v(),{get:n,makeChatTop:l,ownUuid:i}=f(),{send:c,connected:d,message:u}=y(),{encrypt_base64_using_aes:h,decrypt_base64_using_aes:x,get_shared_secret:g}=(0,m.w)(),[p,b]=(0,s.useState)(""),[j,w]=(0,s.useState)(""),[S,k]=(0,s.useState)([]),[A,C]=(0,s.useState)(40),[E,T]=(0,s.useState)(""),[R,I]=(0,s.useState)(0),[O,M]=(0,s.useState)(!1),[D,L]=(0,s.useState)(!1),[P,F]=(0,s.useState)(!1),[z,H]=(0,s.useState)(!1),[K,W]=(0,s.useState)(!1),[J,U]=(0,s.useState)(!1),$=(0,s.useRef)(null),[Z,G]=(0,s.useState)("default");(0,s.useEffect)(()=>{"Notification"in window?G(Notification.permission):(0,o.Rm)("Notifications are not supported by this browser.","warning")},[]);let B=(0,s.useCallback)(async()=>{if(!("Notification"in window))return{success:!1,message:"Notifications are not supported by this browser."};try{let e=await Notification.requestPermission();if(G(e),"granted"===e)return{success:!0,message:"Notifications enabled!"};return{success:!1,message:"Notifications have been denied!"}}catch(e){return"Error requesting notification permission: "+e.message}});function q(e,t,a){if(!("Notification"in window))return void(0,o.Rm)("Notifications are not supported by this browser.","warning");"granted"===Z?new Notification(e,{body:t,icon:a}):N.oR.info("".concat(e," sent you a message, enable notifications in the settings!"))}class V{addSubMessage(e,t){this.subMessages.push({content:e,sendToServer:t})}constructor(e){this.id=e.id?parseInt(e.id,10):Date.now(),this.sender=e.sender,this.subMessages=[],e.content?this.subMessages.push({content:e.content,sendToServer:e.sendToServer||!1}):Array.isArray(e.messages)&&(this.subMessages=e.messages)}}let Y=(0,s.useCallback)(e=>{$.current&&(clearTimeout($.current),$.current=null),e?M(!0):$.current=setTimeout(()=>{M(!1)},500)},[]);function X(e){return 60*Math.floor(e/1e3/60)*1e3}async function Q(e,t,a){try{ee({id:e,sender:t,content:atob(await x(a,E)),sendToServer:!1})}catch(t){let e=t.toString();"OperationError"===e||"OperationError: The operation failed for an operation-specific reason"===e?I(e=>e+1):(0,o.Rm)(e,"error")}}let ee=(0,s.useCallback)(e=>{k(t=>{if(t.length>0){let a=t[t.length-1];if(a.sender===e.sender&&X(a.id)===X(e.id)){let r=new V({id:a.id,sender:a.sender,messages:[...a.subMessages]});return r.addSubMessage(e.content,e.sendToServer||!1),[...t.slice(0,-1),r]}}return[...t,new V(e)]})},[]);function et(e,t){if(e.length>0){let a=e[e.length-1];if(a.sender===t.sender&&X(a.id)===X(t.id)){let r=new V({id:a.id,sender:a.sender,messages:[...a.subMessages]});return r.addSubMessage(t.content,t.sendToServer||!1),[...e.slice(0,-1),r]}}return[...e,new V(t)]}return(0,s.useEffect)(()=>{P&&!K&&(Y(!0),L("Loading more messages."),c("message_get",{message:"Getting messages",log_level:0},{chat_partner_id:p,loaded_messages:A,message_amount:40}).then(async e=>{if(H(!0),void 0===e.data.message_chunk)L(""),Y(!1),F(!1),W(!0);else{let t=[...e.data.message_chunk].sort((e,t)=>e.message_time-t.message_time),a=await Promise.all(t.map(async e=>{try{let t=atob(await x(e.message_content,E));return{id:e.message_time,sender:e.sender_is_me?i:p,content:t,sendToServer:!1}}catch(t){let e=t.toString();return"OperationError"===e||"OperationError: The operation failed for an operation-specific reason"===e?I(e=>e+1):(0,o.Rm)(e,"error"),null}})),r=[];a.forEach(e=>{e&&(r=et(r,e))}),k(e=>[...r,...e]),L(""),Y(!1),C(e=>e+40),F(!1)}}))},[P,K]),(0,s.useEffect)(()=>{""!==p&&(k([]),""===j&&(Y(!0),L("Loading receivers public key."),n(p).then(e=>{w(e.public_key),L(""),Y(!1)})),""===E&&""!==j&&(Y(!0),L("Loading shared secret."),g(a,j).then(e=>{T(e.sharedSecretHex),L(""),Y(!1)})),""!==E&&(Y(!0),L("Loading messages."),c("message_get",{message:"Getting messages",log_level:0},{chat_partner_id:p,loaded_messages:0,message_amount:40}).then(async e=>{if(void 0!==e.data.message_chunk){let t=[...e.data.message_chunk].sort((e,t)=>e.message_time-t.message_time),a=await Promise.all(t.map(async e=>{try{let t=atob(await x(e.message_content,E));return{id:e.message_time,sender:e.sender_is_me?i:p,content:t,sendToServer:!1}}catch(t){let e=t.toString();return"OperationError"===e||"OperationError: The operation failed for an operation-specific reason"===e?I(e=>e+1):(0,o.Rm)(e,"error"),null}})),r=[];a.forEach(e=>{e&&(r=et(r,e))}),k(r)}else U(!0);L(""),Y(!1)})))},[p,E,j]),(0,s.useEffect)(()=>{!async function(){if(d&&null!==u&&"message_live"===u.type){let e=u.data.sender_id,t=u.data.message;e===p?await Q(u.data.send_time,e,t):n(e).then(async r=>{let s;g(a,r.public_key).then(e=>{s=e.sharedSecretHex,L(""),Y(!1)}),l(e),q(r.display,atob(await x(t,s)),r.avatar)})}}()},[u,d,p]),(0,s.useEffect)(()=>{""!==p&&""!==E&&S.forEach(async(e,t)=>{let a=e.subMessages.findIndex(e=>e.sendToServer);if(-1!==a){let r=e.subMessages[a];try{let e=await h(btoa(r.content),E);await c("message",{message:"",log_level:-1},{receiver_id:p,message_content:e}),k(e=>{let r=[...e],s=r[t];if(s){let e=new V({id:s.id,sender:s.sender,messages:[...s.subMessages]});e.subMessages[a]&&(e.subMessages[a]={...e.subMessages[a],sendToServer:!1}),r[t]=e}return r})}catch(e){(0,o.Rm)(e.message,"error")}}})},[S,a,j,p,E]),(0,s.useEffect)(()=>()=>{$.current&&clearTimeout($.current)},[]),(0,r.jsx)(_.Provider,{value:{messages:S,addMessage:ee,setReceiver:b,receiver:p,sharedSecret:E,resetReceiver:function(e){b(e),T(""),w(""),I(0),F(!1),C(40),H(!1),W(!1),U(!1)},failedMessages:R,setFailedMessages:I,navbarLoading:O,navbarLoadingMessage:D,loadMoreMessages:P,setLoadMoreMessages:F,moreMessagesLoadedOnce:z,setMoreMessagesLoadedOnce:H,loadedAllMessages:K,setLoadedAllMessages:W,sendNotification:q,requestNotificationPermission:B,noMessageWithUser:J},children:t})}let A=(0,s.createContext)();function C(){let e=(0,s.useContext)(A);if(void 0===e)throw Error("usePageContext must be used within a PageProvider");return e}function E(e){let{children:t}=e,[a,n]=(0,s.useState)({name:"home",data:""}),[i,c]=(0,s.useState)(l.Ay.get("layout_sidebar_category")||"chats"),{resetReceiver:o}=S();return(0,s.useEffect)(()=>{"chat"!==a.name&&o("")},[a]),(0,r.jsx)(A.Provider,{value:{page:a,setPage:n,sidebarCategory:i,setSidebarCategory:function(e){l.Ay.get("layout_sidebar_category_policy"),l.Ay.set("layout_sidebar_category",e),c(e)}},children:t})}var T=a(50126),R=a(86046);let I={LIGHTNESS_DISTRIBUTION_EXPONENT:1,LIGHT_THEME_BASE_COLORIZATION_STRENGTH:2,LIGHT_THEME_ACCENT_COLORIZATION_STRENGTH:1.1,LIGHT_THEME_GLOBAL_SATURATION_FACTOR:.9,LIGHT_THEME_PRIMARY_SATURATION_FACTOR:.9,LIGHT_THEME_HUE_SHIFT_AMOUNT:0,LIGHT_THEME_CONTRAST:.85,DARK_THEME_BASE_COLORIZATION_STRENGTH:1,DARK_THEME_ACCENT_COLORIZATION_STRENGTH:1.1,DARK_THEME_GLOBAL_SATURATION_FACTOR:1.2,DARK_THEME_PRIMARY_SATURATION_FACTOR:1.2,DARK_THEME_HUE_SHIFT_AMOUNT:0,DARK_THEME_CONTRAST:5},O={background:{l:1,c:0},foreground:{l:0,c:.03},card:{l:1,c:0},card_foreground:{l:0,c:.03},popover:{l:1,c:0},popover_foreground:{l:0,c:.03},primary:{l:.96,c:.01},primary_foreground:{l:.08,c:.04},secondary:{l:.96,c:.01},secondary_foreground:{l:.08,c:.04},muted:{l:.96,c:.01},muted_foreground:{l:.48,c:.09},accent:{l:.96,c:.01},accent_foreground:{l:.08,c:.04},destructive:{l:.51,c:.245,h:27.325},destructive_foreground:{l:.98,c:0},border:{l:.9,c:.02},input:{l:.9,c:.02},ring:{l:.66,c:.08},chart1:{l:.59,c:.222,h:41.116},chart2:{l:.53,c:.118,h:184.704},chart3:{l:.3,c:.07,h:227.392},chart4:{l:.8,c:.189,h:84.429},chart5:{l:.73,c:.188,h:70.08},sidebar:{l:.98,c:0},sidebar_foreground:{l:0,c:.03},sidebar_primary:{l:.08,c:.04},sidebar_primary_foreground:{l:.98,c:0},sidebar_accent:{l:.96,c:.01},sidebar_accent_foreground:{l:.08,c:.04},sidebar_border:{l:.9,c:.02},sidebar_ring:{l:.66,c:.08}},M={background:{l:.005,c:.03},foreground:{l:1,c:0},card:{l:.017,c:.02},card_foreground:{l:1,c:0},popover:{l:.01,c:.03},popover_foreground:{l:1,c:0},primary:{l:.11,c:.03},primary_foreground:{l:1,c:0},secondary:{l:.11,c:.03},secondary_foreground:{l:1,c:0},muted:{l:.11,c:.03},muted_foreground:{l:.61,c:.08},accent:{l:.08,c:.03},accent_foreground:{l:1,c:0},destructive:{l:.2,c:.53},destructive_foreground:{l:.005,c:.03},border:{l:.06,c:.04,alpha:.5},input:{l:.08,c:.05,alpha:.6},ring:{l:.5,c:.09},chart1:{l:.4,c:.243,h:264.376},chart2:{l:.68,c:.17,h:162.48},chart3:{l:.77,c:.188,h:70.08},chart4:{l:.59,c:.265,h:303.9},chart5:{l:.61,c:.246,h:16.439},sidebar:{l:.01,c:.02},sidebar_foreground:{l:1,c:0},sidebar_primary:{l:.4,c:.243,h:264.376},sidebar_primary_foreground:{l:1,c:0},sidebar_accent:{l:.11,c:.03},sidebar_accent_foreground:{l:1,c:0},sidebar_border:{l:.06,c:.04,alpha:.5},sidebar_ring:{l:.5,c:.09}},D=(e,t)=>{let{baseHue:a,baseChroma:r,l_range:s,l_exponent:n,saturationFactor:l,colorizationStrength:i,hueShift:c}=t,[o,d]=s,u=o+(d-o)*Math.pow(e.l,n),m=(e.c+r*i)*l,h=T.Ay.oklch(u,m,(a+c)%360);return void 0!==e.alpha&&(h=h.alpha(e.alpha)),h.css("oklch")};function L(e,t,a){t=t||I;try{let r="dark"===a,s=r?t.DARK_THEME_PRIMARY_SATURATION_FACTOR:t.LIGHT_THEME_PRIMARY_SATURATION_FACTOR,[n,l,i]=(0,T.Ay)(e).set("oklch.c","*".concat(s)).oklch(),c=Number.isNaN(i)?0:i,o=r?M:O,d=r?t.DARK_THEME_CONTRAST:t.LIGHT_THEME_CONTRAST,u=r?[.1,.1+.9*d]:[1-.9*d,1],m=r?t.DARK_THEME_BASE_COLORIZATION_STRENGTH:t.LIGHT_THEME_BASE_COLORIZATION_STRENGTH,h=r?t.DARK_THEME_ACCENT_COLORIZATION_STRENGTH:t.LIGHT_THEME_ACCENT_COLORIZATION_STRENGTH,f=r?t.DARK_THEME_GLOBAL_SATURATION_FACTOR:t.LIGHT_THEME_GLOBAL_SATURATION_FACTOR,x=r?t.DARK_THEME_HUE_SHIFT_AMOUNT:t.LIGHT_THEME_HUE_SHIFT_AMOUNT,g=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"base",r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return D(e,{baseHue:r?e.h:c,baseChroma:r?0:l,l_range:u,l_exponent:t.LIGHTNESS_DISTRIBUTION_EXPONENT,saturationFactor:f,colorizationStrength:"accent"===a?h:m,hueShift:"accent"!==a||r?0:x})};return{"--radius":"0.5rem","--background":g(o.background),"--foreground":g(o.foreground),"--card":g(o.card),"--card-foreground":g(o.card_foreground),"--popover":g(o.popover),"--popover-foreground":g(o.popover_foreground),"--primary":g(o.primary),"--primary-foreground":g(o.primary_foreground),"--secondary":g(o.secondary,"accent"),"--secondary-foreground":g(o.secondary_foreground,"accent"),"--muted":g(o.muted,"accent"),"--muted-foreground":g(o.muted_foreground,"accent"),"--accent":g(o.accent,"accent"),"--accent-foreground":g(o.accent_foreground,"accent"),"--destructive":g(o.destructive,"accent"),"--border":g(o.border),"--input":g(o.input),"--ring":g(o.ring,"accent"),"--chart-1":g(o.chart1,"base",!0),"--chart-2":g(o.chart2,"base",!0),"--chart-3":g(o.chart3,"base",!0),"--chart-4":g(o.chart4,"base",!0),"--chart-5":g(o.chart5,"base",!0),"--sidebar":g(o.sidebar),"--sidebar-foreground":g(o.sidebar_foreground),"--sidebar-primary":g(o.sidebar_primary,"base",!0),"--sidebar-primary_foreground":g(o.sidebar_primary_foreground,"base",!0),"--sidebar-accent":g(o.sidebar_accent,"accent"),"--sidebar-accent_foreground":g(o.sidebar_accent_foreground,"accent"),"--sidebar-border":g(o.sidebar_border),"--sidebar-ring":g(o.sidebar_ring,"accent")}}catch(t){return console.error("Invalid hex color for palette generation:",e,t),{}}}function P(e,t){let a=R.Ge.fromInt(e),r=Math.max(0,Math.min(100,a.tone+t));return a.tone=r,a.toInt()}function F(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"light",a=(0,R.MK)((0,R.cd)(e));console.log(a),console.log(t);let r=new R.Sp(a.schemes[t]);console.log(r);let s="light"===t,n=r.surface,l=s?-12:12,i=P(n,s?-3:3),c=P(n,s?-9:9),o=P(r.background,l),d=P(r.secondary,s?-15:15),u=P(r.surface,l);return{"--radius":"0.5rem","--background":(0,R.K0)(r.background),"--foreground":(0,R.K0)(r.onBackground),"--primary":(0,R.K0)(r.primary),"--primary-foreground":(0,R.K0)(r.onPrimary),"--secondary":(0,R.K0)(r.secondary),"--secondary-foreground":(0,R.K0)(r.onSecondary),"--accent":(0,R.K0)(o),"--accent-foreground":(0,R.K0)(d),"--destructive":(0,R.K0)(r.error),"--card":(0,R.K0)(r.surface),"--card-foreground":(0,R.K0)(r.onSurface),"--popover":(0,R.K0)(r.surface),"--popover-foreground":(0,R.K0)(r.onSurface),"--muted":(0,R.K0)(r.surfaceVariant),"--muted-foreground":(0,R.K0)(r.onSurfaceVariant),"--border":(0,R.K0)(u),"--input":(0,R.K0)(c),"--ring":(0,R.K0)(r.primary),"--sidebar":(0,R.K0)(i),"--sidebar-foreground":(0,R.K0)(r.onSurface),"--sidebar-primary":(0,R.K0)(r.primary),"--sidebar-primary-foreground":(0,R.K0)(r.onPrimary),"--sidebar-accent":(0,R.K0)(r.secondary),"--sidebar-accent-foreground":(0,R.K0)(r.onSecondary),"--sidebar-border":(0,R.K0)(r.outlineVariant),"--sidebar-ring":(0,R.K0)(r.primary),"--chart-1":(0,R.K0)(r.primary),"--chart-2":(0,R.K0)(r.secondary),"--chart-3":(0,R.K0)(r.tertiary),"--chart-4":(0,R.K0)(r.primaryContainer),"--chart-5":(0,R.K0)(r.tertiaryContainer)}}let z=(0,s.createContext)(null);function H(){let e=(0,s.useContext)(z);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}function K(e){let{children:t}=e,[a,n]=(0,s.useState)(""),[i,c]=(0,s.useState)(!1),[o,d]=(0,s.useState)("right"===l.Ay.get("theme_sidebar")),[u,m]=(0,s.useState)(""),[h,f]=(0,s.useState)(""),[x,g]=(0,s.useState)(l.Ay.get("theme_tint")||"soft"),[p,v]=(0,s.useState)(l.Ay.get("theme_scheme")||"dark"),b=e=>{try{let t=[document.documentElement,document.body].filter(Boolean);if(Array.isArray(e)&&e.length>0)for(let a of t)for(let t of e)a.style.removeProperty(t);else for(let e of t){let t=e.style,a=[];for(let e=0;e<t.length;e++){let r=t.item(e);r&&r.startsWith("--")&&a.push(r)}for(let t of a)e.style.removeProperty(t)}}catch(e){}};return(0,s.useEffect)(()=>{if(i)try{let e=document.getElementById("custom-css");e||((e=document.createElement("style")).id="custom-css",document.head.appendChild(e));let t=[h,u].filter(Boolean).join("\n\n");e.textContent=t,e.parentNode===document.head&&e!==document.head.lastChild&&document.head.appendChild(e),u&&""!==u?l.Ay.set("custom_css",u):l.Ay.remove("custom_css")}catch(e){}},[u,h,i]),(0,s.useEffect)(()=>{o?l.Ay.set("theme_sidebar","right"):l.Ay.set("theme_sidebar","left")},[o]),(0,s.useEffect)(()=>{c(!0);let e=l.Ay.get("theme_hex");e&&n(e);let t=l.Ay.get("custom_css");"string"==typeof t&&m(t)},[]),(0,s.useEffect)(()=>{if(i)try{l.Ay.set("theme_tint",x)}catch(e){}},[x,i]),(0,s.useEffect)(()=>{if(i)try{l.Ay.set("theme_scheme",p);let e="dark"===p?"dark":"light",t="dark"===p?"light":"dark";document.body.classList.add(e),document.body.classList.remove(t)}catch(e){}},[p,i]),(0,s.useEffect)(()=>{if(i)if(document.body.classList.add(p||"dark"),a){let e;switch(l.Ay.set("theme_hex",a),x){case"soft":e=F(a,p);break;case"hard":e=L(a,null,p);break;case"hard_a":e=L(a,JSON.parse(l.Ay.get("theme_control")),p);break;default:e=F(a,p),g("soft")}try{let t=Object.keys(e||{});b(t);let a=Object.entries(e).map(e=>{let[t,a]=e;return"".concat(t,": ").concat(a,";")}).join("\n");f(":root, body {\n".concat(a,"\n}"))}catch(e){f("")}}else l.Ay.remove("theme_hex"),b(),f("")},[a,x,p,i]),(0,r.jsx)(z.Provider,{value:{sidebarRightSide:o,setSidebarRightSide:d,customCss:u,setCustomCss:m,customHex:a,setCustomHex:n,themeTint:x,setThemeTint:g,themeScheme:p,setThemeScheme:v},children:t})}let W={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:3478"}],iceCandidatePoolSize:4,bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},J=(0,s.createContext)(null),U=()=>{let e=(0,s.useContext)(J);if(!e)throw Error("useCallContext must be used within a CallProvider");return e},$=e=>{let{children:t}=e,a=(0,s.useRef)(new Map),{encrypt_base64_using_aes:n,decrypt_base64_using_aes:u,get_shared_secret:h}=(0,m.w)(),{privateKeyHash:x,privateKey:g}=v(),{ownUuid:p,get:b}=f(),{receiver:j}=S(),{message:w,wsSend:N}=y(),[_,k]=(0,s.useState)(!1),[A,C]=(0,s.useState)(!1),[E,T]=(0,s.useState)({}),[R,I]=(0,s.useState)(!1),[O,M]=(0,s.useState)("?"),[D,L]=(0,s.useState)(!1),[P,F]=(0,s.useState)(null),[z,H]=(0,s.useState)(null),[K,U]=(0,s.useState)(!1),[$,Z]=(0,s.useState)(!1),[G,B]=(0,s.useState)("1280x720"),[q,V]=(0,s.useState)("30"),[Y,X]=(0,s.useState)(!1),Q=(0,s.useRef)(null),[ee,et]=(0,s.useState)("true"===l.Ay.get("call_mute")),[ea,er]=(0,s.useState)("true"===l.Ay.get("call_deaf")),[es,en]=(0,s.useState)(null),[el,ei]=(0,s.useState)(null),ec=(0,s.useRef)(null),eo=(0,s.useRef)(null),ed=(0,s.useRef)(new Map),eu=(0,s.useRef)(new Map),em=(0,s.useRef)(new Map),eh=(0,s.useRef)(new Map),ef=(0,s.useRef)(new Map),ex=(0,s.useRef)(new Map),[eg,ep]=(0,s.useState)({}),[ev,eb]=(0,s.useState)({}),[ej,ey]=(0,s.useState)(!1),[ew,eN]=(0,s.useState)({width:0,height:0}),e_=(0,s.useRef)(null),eS=(0,s.useRef)(null),[ek,eA]=(0,s.useState)([]),[eC,eE]=(0,s.useState)([]),[eT,eR]=(0,s.useState)([]),eI=(0,s.useRef)(null),eO=(0,s.useRef)(null),[eM,eD]=(0,s.useState)(()=>{let e=l.Ay.get("call_input_sensitivity");return Math.min(100,Math.max(0,Number.isFinite(Number(e))?Number(e):70))}),eL=(0,s.useRef)(null),eP=(0,s.useRef)(null),eF=(0,s.useCallback)(async e=>{try{let t=Array.from(document.querySelectorAll("audio"));await Promise.all(t.map(async t=>{if("function"==typeof t.setSinkId&&e)try{await t.setSinkId(e);try{t.dataset.sinkApplied=e}catch(e){}}catch(e){}}))}catch(e){}},[]);(0,s.useEffect)(()=>{l.Ay.set("call_input_sensitivity",String(eM))},[eM]),(0,s.useEffect)(()=>{null===es&&en(l.Ay.get("call_output")||"default")},[es]),(0,s.useEffect)(()=>{es&&(l.Ay.set("call_output",es),eo.current=es,eF(es))},[es,eF]),(0,s.useEffect)(()=>{if(!ec.current)try{let e=e=>{try{var t;if(!e||(null==(t=e.dataset)?void 0:t.sinkApplied)===eo.current)return;"function"==typeof e.setSinkId&&eo.current&&(e.setSinkId(eo.current).catch(()=>{}),e.dataset.sinkApplied=eo.current)}catch(e){}},t=null,a=[],r=()=>{t||(t=requestAnimationFrame(()=>{let r=a;for(let s of(a=[],t=null,r))s instanceof HTMLElement?s.querySelectorAll("audio").forEach(e):s instanceof HTMLMediaElement&&"audio"===s.tagName.toLowerCase()&&e(s)}))};return ec.current=new MutationObserver(e=>{for(let t of e)t.addedNodes.forEach(e=>{a.push(e)});r()}),ec.current.observe(document.body,{childList:!0,subtree:!0}),()=>{try{cancelAnimationFrame(t)}catch(e){}try{var e;null==(e=ec.current)||e.disconnect()}catch(e){}ec.current=null}}catch(e){}},[]);let ez=(0,s.useCallback)(e=>{eb(t=>{let a={...t},r=eg[e];return r&&(a[e]={x:r.x,y:r.y}),a})},[eg]);(0,s.useEffect)(()=>{eb(e=>{let t={...e};return Object.keys(t).forEach(e=>{ek.includes(e)||delete t[e]}),ek.forEach(e=>{!t[e]&&eg[e]&&(t[e]={...eg[e]})}),t})},[ek,eg]);let eH=(0,s.useCallback)(async e=>{try{var t,a;let r={echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},s=e&&"default"!==e?{audio:{deviceId:{exact:e},...r}}:{audio:{...r}},n=await navigator.mediaDevices.getUserMedia(s);try{null==(a=eO.current)||a.getTracks().forEach(e=>e.stop())}catch(e){}eO.current=n,n.getAudioTracks().forEach(e=>{e.enabled=!ee}),eI.current=n;let l=null==n||null==(t=n.getAudioTracks)?void 0:t.call(n)[0];if(l)for(let e of ed.current.values())try{let t=e.getSenders().find(e=>e.track&&"audio"===e.track.kind);t?await t.replaceTrack(l):e.addTrack(l,n)}catch(e){}}catch(e){(0,o.Rm)("Failed to switch mic input: ".concat(e.message),"error")}},[ee]);function eK(){var e,t,a,r;try{null==(t=eI.current)||t.getTracks().forEach(e=>e.stop())}catch(e){}try{null==(a=eO.current)||a.getTracks().forEach(e=>e.stop())}catch(e){}eO.current=null;try{clearInterval(eP.current)}catch(e){}eP.current=null;try{null==(r=eL.current)||r.close()}catch(e){}eL.current=null,null==(e=Q.current)||e.getTracks().forEach(e=>e.stop()),ed.current.clear(),eu.current.clear(),em.current.clear(),ef.current.clear(),ex.current.clear(),eA([]),eE([]),k(!1),F(null),H(null),U(!1),M("?"),L(!1)}(0,s.useEffect)(()=>{if(null===el)return void ei(l.Ay.get("call_input")||"default");l.Ay.set("call_input",el),D&&eH(el)},[el,eH,D]),(0,s.useEffect)(()=>{!async function(){"new_call"===w.type&&(T({callerId:w.data.sender_id,callId:w.data.call_id,callSecret:atob(await u(w.data.call_secret,await h(g,await b(w.data.sender_id).then(e=>e.public_key))))}),C(!0))}()},[w]);let eW=(0,s.useCallback)(()=>{et(e=>{let t=!e;return l.Ay.set("call_mute",t),t||(er(!1),l.Ay.set("call_deaf",!1)),t})},[]),eJ=(0,s.useCallback)(()=>{er(e=>{let t=!e;return l.Ay.set("call_deaf",t),t&&(et(!0),l.Ay.set("call_mute",!0)),t})},[]),eU=(0,s.useCallback)(e=>e?eh.current.get(e):Q.current,[]),e$=(0,s.useCallback)(async e=>{let t=JSON.parse(e.data);switch("pong"!==t.type&&(0,o.Rm)(t,"debug","Call WebSocket (Received):"),t.type){case"client_connected":eQ(t.data.user_id,!0);break;case"client_closed":eu.current.has(t.data.user_id)&&(eu.current.get(t.data.user_id).close(),eu.current.delete(t.data.user_id)),em.current.has(t.data.user_id)&&(em.current.get(t.data.user_id).close(),em.current.delete(t.data.user_id)),ed.current.has(t.data.user_id)&&(ed.current.get(t.data.user_id).close(),ed.current.delete(t.data.user_id)),ef.current.delete(t.data.user_id),ex.current.delete(t.data.user_id),eA(e=>e.filter(e=>e!==t.data.user_id)),eE(e=>e.filter(e=>e!==t.data.user_id));break;case"webrtc_sdp":let r,s,l=t.data.sender_id,i=t.data.screen_share,c=t.data.watcher;try{r=atob(await u(t.data.payload,z))}catch(e){(0,o.Rm)("".concat(l,": ").concat(e.message),"error","Voice WebSocket:");return}(s=i?c?em.current.get(l):eu.current.get(l):ed.current.get(l))||(s=await eQ(l,!1,i));try{let e=new RTCSessionDescription(JSON.parse(r));if(await s.setRemoteDescription(e),"offer"===e.type){let e=await s.createAnswer({offerToReceiveAudio:!i,offerToReceiveVideo:i});await s.setLocalDescription(e),eB("webrtc_sdp",{message:"Sending SDP Answer",log_level:0},{payload:await n(btoa(JSON.stringify(e)),z),screen_share:i,watcher:!c,receiver_id:l},!1),(0,o.Rm)("Answer sent to ".concat(l),"success")}}catch(e){(0,o.Rm)("SDP Error (".concat(l,"): ").concat(e),"error","Voice WebSocket:")}break;case"webrtc_ice":let d,m,h=t.data.sender_id,f=t.data.screen_share,x=t.data.watcher;try{d=atob(await u(t.data.payload,z))}catch(e){(0,o.Rm)("".concat(h,": ").concat(e.message),"error","Voice WebSocket:");return}if((m=f?x?em.current.get(h):eu.current.get(h):ed.current.get(h))&&d)try{await m.addIceCandidate(new RTCIceCandidate(JSON.parse(d)))}catch(e){(0,o.Rm)(e.message,"error","Voice WebSocket:")}else(0,o.Rm)("No peer connection found for ".concat(h," or ICE payload is empty."),"warning","Voice WebSocket:");break;case"start_stream":eE(e=>e.includes(t.data.user_id)?e:[...e,t.data.user_id]);break;case"end_stream":eE(e=>e.filter(e=>e!==t.data.user_id));break;case"watch_stream":t.data.want_to_watch?((0,o.Rm)("User wants to watch you","info"),eQ(t.data.sender_id,!0,!0)):((0,o.Rm)("User allowed you to watch them","info"),await eQ(t.data.sender_id,!1,!0),eR(e=>[...e,t.data.sender_id]))}if(t.id&&a.current.has(t.id)){let{resolve:e,reject:r,timeoutId:s}=a.current.get(t.id);clearTimeout(s),a.current.delete(t.id),"error"===t.type&&K?r(Error("Received unknown response type '".concat(t.type,"' for request ID '").concat(t.id,"'."))):e(t)}else(0,o.Rm)(t.log.message,"info")},[z,u,n,K]),{sendMessage:eZ,readyState:eG}=(0,i.Ay)(_&&P&&z?d.s.call_wss:null,{onOpen:async()=>{(0,o.Rm)("Call connected","info"),ee&&eW();try{var e;let t=null!=(e=null!=el?el:l.Ay.get("call_input"))?e:"default";await eH(t)}catch(e){}eA([p])},onClose:()=>{(0,o.Rm)("Call disconnected","info");try{var e;null==(e=eI.current)||e.getTracks().forEach(e=>e.stop())}catch(e){}eI.current=null,a.current.forEach(e=>{let{reject:t,timeoutId:a}=e;clearTimeout(a),t(Error("Call WebSocket connection closed before response was received."))}),a.current.clear(),L(!1),U(!1),ed.current.clear(),eu.current.clear(),ef.current.clear(),ex.current.clear()},onMessage:e$,shouldReconnect:()=>_&&P&&z,share:!0,reconnectAttempts:5,reconnectInterval:3e3}),eB=(0,s.useCallback)(async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=!(arguments.length>3)||void 0===arguments[3]||arguments[3];if(eG!==i.vj.CLOSED&&eG!==i.vj.CLOSING)if(s)return new Promise((s,n)=>{let l=(0,c.A)(),i={id:l,type:e,log:t,data:r};"ping"!==i.type&&(0,o.Rm)(i,"debug","Call WebSocket (Sent):");let d=setTimeout(()=>{a.current.delete(l),n(Error("Call WebSocket request timed out for ID: ".concat(l," (Type: ").concat(e,") after ").concat(1e4,"ms.")))},1e4);a.current.set(l,{resolve:s,reject:n,timeoutId:d});try{eZ(JSON.stringify(i))}catch(t){clearTimeout(d),a.current.delete(l);let e=Error("Failed to send Call WebSocket message: ".concat(t.message));(0,o.Rm)(e,"error"),n(e)}});else{let a={type:e,log:t,data:r};"ping"!==a.type&&(0,o.Rm)(a,"debug","Call WebSocket (Sent):"),eZ(JSON.stringify(a))}else(0,o.Rm)("Call WebSocket not connected","warning","Voice WebSocket:")},[eZ,eG]),eq=(0,s.useCallback)(async()=>{if($||Q.current)return Q.current;try{let[t,a]=String(G).split("x"),r=parseInt(t,10)||void 0,s=parseInt(a,10)||void 0,n=parseInt(String(q),10)||void 0,l=await navigator.mediaDevices.getDisplayMedia({video:{frameRate:n,width:r,height:s,displaySurface:"monitor"},audio:Y});async function e(){let e=Array.from(em.current.entries()).map(async e=>{let[t,a]=e;try{if("connected"!==a.connectionState||"stable"!==a.signalingState)return;let e=l.getVideoTracks()[0],t=l.getAudioTracks(),r=a.getTransceivers(),s=r.find(e=>e.receiver&&e.receiver.track&&"video"===e.receiver.track.kind)||r.find(e=>null!==e.mid&&e.direction.includes("recv"));s&&e&&(await s.sender.replaceTrack(e),s.direction="sendrecv"),t.forEach(e=>{a.addTrack(e,l)})}catch(e){(0,o.Rm)("Failed to add screen tracks to peer ".concat(t,": ").concat(e.message),"error","Voice WebSocket:")}});await Promise.allSettled(e)}return Q.current=l,Z(!0),eE(e=>e.includes(p)?e:[...e,p]),eB("start_stream",{message:"User started screen sharing",log_level:0},{user_id:p},!1),await e(),l.getVideoTracks()[0].addEventListener("ended",()=>{eV()}),(0,o.Rm)("Screen share started","success"),l}catch(e){Z(!1),(0,o.Rm)(e.message,"error")}},[p,eB]),eV=(0,s.useCallback)(()=>{if(!Q.current)return;eE(e=>e.filter(e=>e!==p)),eB("end_stream",{message:"User stopped screen sharing",log_level:0},{user_id:p},!1);let e=Q.current.getTracks().map(e=>({id:e.id,kind:e.kind}));Q.current.getTracks().forEach(e=>{e.stop()}),Promise.allSettled(Array.from(em.current.entries()).map(async t=>{let[a,r]=t;try{if("closed"===r.connectionState)return;let t=r.getTransceivers(),s=!1;e.forEach(e=>{if("video"===e.kind){let r=t.find(t=>t.sender.track&&t.sender.track.id===e.id);if(r)try{r.sender.replaceTrack(null),r.direction="recvonly",s=!0}catch(e){(0,o.Rm)("Error resetting video transceiver for peer ".concat(a,": ").concat(e.message),"error","Voice WebSocket:")}}else{let t=r.getSenders().find(t=>t.track&&t.track.id===e.id);if(t)try{r.removeTrack(t),s=!0}catch(t){(0,o.Rm)("Error removing ".concat(e.kind," track from peer ").concat(a,": ").concat(t.message),"error","Voice WebSocket:")}}}),s&&"stable"===r.signalingState&&"connected"===r.connectionState&&await r.setLocalDescription(r.localDescription)}catch(e){(0,o.Rm)("Error stopping screen stream for peer ".concat(a,": ").concat(e.message),"error","Voice WebSocket:")}})),Q.current=null,Z(!1)},[p,eB]),eY=(0,s.useMemo)(()=>{let[e,t]=String(G).split("x");return{widthNum:parseInt(e,10)||void 0,heightNum:parseInt(t,10)||void 0,frameNum:parseInt(String(q),10)||void 0}},[G,q]),eX=(0,s.useCallback)(()=>{var e,t,a;if(!$)return;let r=null==(a=Q.current)||null==(t=a.getVideoTracks)||null==(e=t.call(a))?void 0:e[0];if(!r)return;let{widthNum:s,heightNum:n,frameNum:l}=eY,i={};l&&(i.frameRate={ideal:l,max:l}),s&&(i.width={ideal:s,max:s}),n&&(i.height={ideal:n,max:n});let c=requestAnimationFrame(()=>{Promise.resolve().then(async()=>{try{await r.applyConstraints(i)}catch(e){(0,o.Rm)(e.message,"showError")}})});return()=>cancelAnimationFrame(c)},[$,eY]),eQ=(0,s.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(a){if(t){if(em.current.has(e))return(0,o.Rm)("Reusing existing watching connection","debug","Voice WebSocket:"),em.current.get(e)}else if(eu.current.has(e))return(0,o.Rm)("Reusing existing screen connection","debug","Voice WebSocket:"),eu.current.get(e)}else if(ed.current.has(e))return(0,o.Rm)("Reusing existing mic connection","debug","Voice WebSocket:"),ed.current.get(e);let r=new RTCPeerConnection(W);if(a?t?em.current.set(e,r):eu.current.set(e,r):ed.current.set(e,r),eI.current&&!a&&eI.current.getTracks().forEach(e=>{r.addTrack(e,eI.current)}),Q.current&&a&&t&&Q.current.getTracks().forEach(e=>{r.addTrack(e,Q.current)}),r.onicecandidate=async r=>{r.candidate&&eB("webrtc_ice",{message:"Sending ICE Candidate",log_level:0},{payload:await n(btoa(JSON.stringify(r.candidate)),z),screen_share:a,watcher:!t,receiver_id:e},!1)},r.ontrack=r=>{if(r.track.onended=async()=>{if(a)if(t){let t=em.current.get(e);t&&t.removeTrack(r.track)}else{let t=eu.current.get(e);t&&t.removeTrack(r.track)}else{let t=ex.current.get(e);t&&t.removeTrack(r.track)}},a&&!t){let t=eh.current.get(e);t||(t=new MediaStream,eh.current.set(e,t)),r.track.enabled=!0,t.addTrack(r.track)}else{let t=ex.current.get(e);t||(t=new MediaStream,ex.current.set(e,t)),r.track.enabled=!0,t.addTrack(r.track);let a=ef.current.get(e);a&&t instanceof MediaStream?(a.srcObject=t,(0,o.Rm)("Set audio stream for user ".concat(e," (immediate)"),"debug")):a&&t?(0,o.Rm)("Invalid stream type for user ".concat(e,": ").concat(typeof t),"warning"):(0,o.Rm)("Audio element not yet available for user ".concat(e,", will be set when element is created"),"debug")}},t){let t=!1;a&&eB("watch_stream",{message:"".concat(p," allowed ").concat(e," to watch"),log_level:0},{want_to_watch:!1,receiver_id:e},!1),r.onnegotiationneeded=async()=>{if("stable"===r.signalingState&&!t&&!r.remoteDescription){t=!0;try{let t=await r.createOffer({offerToReceiveAudio:!a,offerToReceiveVideo:a});if("stable"!==r.signalingState)return;await r.setLocalDescription(t),eB("webrtc_sdp",{message:"Sending SDP Offer",log_level:0},{payload:await n(btoa(JSON.stringify(t)),z),screen_share:a,watcher:!1,receiver_id:e},!1)}finally{t=!1}}}}return r.onconnectionstatechange=()=>{"disconnected"===r.connectionState||"failed"===r.connectionState?a?t?em.current.delete(e):eu.current.delete(e):(ed.current.delete(e),ef.current.delete(e),ex.current.delete(e)):"connected"===r.connectionState&&((0,o.Rm)("Connected to ".concat(e),"success"),eA(t=>t.includes(e)?t:[...t,e]),a||requestAnimationFrame(()=>{let t=ef.current.get(e),a=ex.current.get(e);t&&a&&a instanceof MediaStream?(t.srcObject=a,(0,o.Rm)("Set audio stream for user ".concat(e),"debug")):t&&a&&(0,o.Rm)("Invalid stream type for user ".concat(e,": ").concat(typeof a),"warning")}))},r},[eB,W,n,z]),e0=(0,s.useCallback)(async(e,t,a)=>{eK(),setTimeout(()=>{t&&a&&(F(t),H(a)),k(!0),I(e)},100)},[]),e1=(0,s.useCallback)(()=>{eK()},[]);return(0,s.useEffect)(()=>{eI.current&&eG===i.vj.OPEN?L(!0):L(!1)},[eG,eI.current]),(0,s.useEffect)(()=>{let e;return D?e=setInterval(async()=>{let e=Date.now();await eB("ping",{message:"Ping from Client",log_level:-1},{last_ping:"string"==typeof O?0:O}).then(()=>{M(Date.now()-e)}).catch(e=>{(0,o.Rm)(e.message,"info")})},5e3):clearInterval(e),()=>clearInterval(e)},[D,eB]),(0,s.useEffect)(()=>{!async function(){D?eB("identification",{message:"Client identifying",log_level:0},{call_id:P,user_id:p,private_key_hash:x,call_secret_sha:await (0,o.sc)(z)}).then(async e=>{if("identification_response"===e.type){U(!0);let t=[];if(Object.keys(e.data.user_states).forEach(a=>{e.data.user_states[a].streaming&&t.push(a)}),eE(t),R){let e;""!==j&&(e=await b(j).then(e=>e.public_key),await N("call_invite",{message:"Invited ".concat(j," to the call ").concat(P),log_level:0},{receiver_id:j,call_id:P,call_secret:await n(btoa(z),await h(g,e)),call_secret_sha:await (0,o.sc)(z)}).then(e=>{"error"!==e.type?(0,o.Rm)("Sent Invite","success"):(0,o.Rm)(e.log.message,"showError")}))}}else U(!1)}):U(!1)}()},[D,eB]),(0,s.useEffect)(()=>{eI.current&&eI.current.getAudioTracks().forEach(e=>{e.enabled=!ee})},[ee]),(0,s.useEffect)(()=>{let e=eX();return()=>{try{null==e||e()}catch(e){}}},[eX]),(0,s.useEffect)(()=>()=>{try{var e;null==(e=ec.current)||e.disconnect()}catch(e){}ec.current=null,a.current.forEach(e=>{let{reject:t,timeoutId:a}=e;clearTimeout(a);let r=Error("WebSocket provider unmounted before response was received.");(0,o.Rm)(r.toString(),"error"),t(r)}),a.current.clear(),eK()},[]),(0,r.jsxs)(J.Provider,{value:{callId:P,setCallId:F,callSecret:z,setCallSecret:H,voiceSend:eB,clientPing:O,connected:D,startCall:e0,stopCall:e1,invitedToCall:A,setInvitedToCall:C,inviteData:E,setInviteData:T,mute:ee,toggleMute:eW,deaf:ea,toggleDeaf:eJ,stream:$,streamResolution:G,setStreamResolution:B,streamRefresh:q,setStreamRefresh:V,streamAudio:Y,setStreamAudio:X,startScreenStream:eq,stopScreenStream:eV,getScreenStream:eU,watchingUsers:eT,setWatchingUsers:eR,createP2PConnection:eQ,connectedUsers:ek,streamingUsers:eC,inputDeviceId:el,setInput:ei,outputDeviceId:es,setOutput:en,directionalAudio:ej,setDirectionalAudio:ey,inputSensitivity:eM,setInputSensitivity:eD,positions:eg,setPositions:ep,audioPositions:ev,setAudioPositions:eb,canvasSize:ew,setCanvasSize:eN,endUserDrag:ez},children:[(0,r.jsxs)("div",{hidden:!0,children:[(0,r.jsx)("audio",{ref:e=>{eS.current=e||null;try{e&&e_.current&&(e.srcObject=e_.current.stream,"function"==typeof e.setSinkId&&eo.current&&e.setSinkId(eo.current).catch(()=>{}))}catch(e){}},autoPlay:!0,muted:ea}),D?ek.map(e=>(0,r.jsx)("audio",{ref:t=>{if(t){ef.current.set(e,t);let a=ex.current.get(e);a&&a instanceof MediaStream?t.srcObject=a:a&&(0,o.Rm)("Invalid stream type for user ".concat(e,": ").concat(typeof a),"warning");try{"function"==typeof t.setSinkId&&eo.current&&t.setSinkId(eo.current).catch(()=>{})}catch(e){}}else ef.current.delete(e)},autoPlay:!0,muted:ea},e)):null]}),t]})},Z=(0,s.createContext)();function G(e){let{children:t}=e,[a,n]=(0,s.useState)({}),[i,c]=(0,s.useState)([]),o=U(),d=v(),u=(0,m.w)(),h=S(),x=C(),g=H(),p=f(),b=y();return(0,s.useEffect)(()=>{l.Ay.get("mods")&&""!==l.Ay.get("mods")&&n(JSON.parse(l.Ay.get("mods")))},[]),(0,s.useEffect)(()=>{a&&""!==a&&(l.Ay.set("mods",JSON.stringify(a)),Object.keys(a).forEach(e=>{let t=a[e];if(t.enabled)try{let e=atob(t.src),a={useCallContext:o,useCryptoContext:d,useEncryptionContext:u,useMessageContext:h,usePageContext:x,useThemeContext:g,useUsersContext:p,useWebSocketContext:b},r={};JSON.parse(e.split("\n")[0]).forEach(e=>{r[e]=a[e]});let s=Function("intents",e.replace(e.split("\n")[0],""));try{s(r)}catch(e){c(a=>[...a,{name:t.name,error:e.message}]),console.log("Failed to load [".concat(t.name,"] [Execution]: ").concat(e.message))}}catch(e){c(a=>[...a,{name:t.name,error:e.message}]),console.log("Failed to load [".concat(t.name,"] [Invalid Structure]: ").concat(e.message))}else console.log("Did not load: "+t.name)}))},[a]),(0,r.jsx)(Z.Provider,{value:{mods:a,setMods:n},children:t})}let B=(0,s.createContext)(null),q=()=>{let e=(0,s.useContext)(B);if(!e)throw Error("useCommunityContext must be used within a CommunityProvider");return e},V=e=>{let{children:t}=e,a=(0,s.useRef)(new Map),{encrypt_base64_using_aes:n,decrypt_base64_using_aes:l}=(0,m.w)(),{privateKeyHash:d,privateKey:u}=v(),{ownUuid:h,get:x}=f(),{receiver:g}=S(),{message:p,wsSend:b}=y(),[j,w]=(0,s.useState)(null),[N,_]=(0,s.useState)(!1),[k,A]=(0,s.useState)(null),[C,E]=(0,s.useState)(!1),[T,R]=(0,s.useState)(!1),[I,O]=(0,s.useState)("?"),[M,D]=(0,s.useState)(!0),[L,P]=(0,s.useState)(!1),F=(0,s.useCallback)(async e=>{let t=JSON.parse(e.data);if("pong"!==t.type&&(0,o.Rm)(t,"debug","Call WebSocket (Received):"),"asd"===t.type&&console.log("asd"),t.id&&a.current.has(t.id)){let{resolve:e,reject:r,timeoutId:s}=a.current.get(t.id);clearTimeout(s),a.current.delete(t.id),"error"===t.type&&L?r(Error("Received unknown response type '".concat(t.type,"' for request ID '").concat(t.id,"'."))):e(t)}else(0,o.Rm)(t.log.message,"info")},[l,n,L]),{sendMessage:z,readyState:H}=(0,i.Ay)(C&&!N&&j&&k?"".concat(M?"wss":"ws","://").concat(j,":").concat(k):null,{onOpen:async()=>{(0,o.Rm)("Community connected","info","Community WebSocket:")},onClose:()=>{(0,o.Rm)("Community disconnected","info","Community WebSocket:"),a.current.forEach(e=>{let{reject:t,timeoutId:a}=e;clearTimeout(a),t(Error("Call WebSocket connection closed before response was received."))}),a.current.clear()},onMessage:F,shouldReconnect:()=>C&&!N&&j&&k,share:!0,reconnectAttempts:5,reconnectInterval:3e3}),K=(0,s.useCallback)(async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=!(arguments.length>3)||void 0===arguments[3]||arguments[3];if(H!==i.vj.CLOSED&&H!==i.vj.CLOSING)if(s)return new Promise((s,n)=>{let l=(0,c.A)(),i={id:l,type:e,log:t,data:r};"ping"!==i.type&&(0,o.Rm)(i,"debug","Community WebSocket (Sent):");let d=setTimeout(()=>{a.current.delete(l),n(Error("Community WebSocket request timed out for ID: ".concat(l," (Type: ").concat(e,") after ").concat(1e4,"ms.")))},1e4);a.current.set(l,{resolve:s,reject:n,timeoutId:d});try{z(JSON.stringify(i))}catch(t){clearTimeout(d),a.current.delete(l);let e=Error("Failed to send Community WebSocket message: ".concat(t.message));(0,o.Rm)(e,"error"),n(e)}});else{let a={type:e,log:t,data:r};"ping"!==a.type&&(0,o.Rm)(a,"debug","Community WebSocket (Sent):"),z(JSON.stringify(a))}else(0,o.Rm)("Community WebSocket not connected","warning","Voice WebSocket:")},[z,T]);return(0,s.useEffect)(()=>{H===i.vj.OPEN?R(!0):R(!1)},[H]),(0,s.useEffect)(()=>{let e;return T?e=setInterval(async()=>{let e=Date.now();await K("ping",{message:"Ping from Client",log_level:-1}).then(()=>{O(Date.now()-e)}).catch(e=>{(0,o.Rm)(e.message,"info")})},1e4):clearInterval(e),()=>clearInterval(e)},[T,K]),(0,s.useEffect)(()=>{!async function(){T?K("identification",{message:"Client identifying",log_level:0},{user_id:h,signed:""}).then(async e=>{"identification_response"===e.type?P(!0):P(!1)}):P(!1)}()},[T,K]),(0,s.useEffect)(()=>()=>{a.current.forEach(e=>{let{reject:t,timeoutId:a}=e;clearTimeout(a);let r=Error("WebSocket provider unmounted before response was received.");(0,o.Rm)(r.toString(),"error"),t(r)}),a.current.clear()},[]),(0,r.jsx)(B.Provider,{value:{connected:T,domain:j,setDomain:w,port:k,setPort:A,invalidDomain:N,secureConnection:M,setSecureConnection:D,clientPing:I,setConnectToCommunity:E},children:t})};var Y=a(99708),X=a(74466),Q=a(22432),ee=a(50183),et=a(7881),ea=a(48288),er=a(15452),es=a(54416);function en(e){let{...t}=e;return(0,r.jsx)(er.bL,{"data-slot":"sheet",...t})}function el(e){let{...t}=e;return(0,r.jsx)(er.ZL,{"data-slot":"sheet-portal",...t})}function ei(e){let{className:t,...a}=e;return(0,r.jsx)(er.hJ,{"data-slot":"sheet-overlay",className:(0,o.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function ec(e){let{className:t,children:a,side:s="right",...n}=e;return(0,r.jsxs)(el,{children:[(0,r.jsx)(ei,{}),(0,r.jsxs)(er.UC,{"data-slot":"sheet-content",className:(0,o.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500","right"===s&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm","left"===s&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm","top"===s&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b","bottom"===s&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",t),...n,children:[a,(0,r.jsxs)(er.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[(0,r.jsx)(es.A,{className:"size-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function eo(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"sheet-header",className:(0,o.cn)("flex flex-col gap-1.5 p-4",t),...a})}function ed(e){let{className:t,...a}=e;return(0,r.jsx)(er.hE,{"data-slot":"sheet-title",className:(0,o.cn)("text-foreground font-semibold",t),...a})}function eu(e){let{className:t,...a}=e;return(0,r.jsx)(er.VY,{"data-slot":"sheet-description",className:(0,o.cn)("text-muted-foreground text-sm",t),...a})}function em(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"skeleton",className:(0,o.cn)("bg-accent animate-pulse rounded-md",t),...a})}var eh=a(58516);let ef=s.createContext(null);function ex(){let e=s.useContext(ef);if(!e)throw Error("useSidebar must be used within a SidebarProvider.");return e}function eg(e){let{defaultOpen:t=!0,open:a,onOpenChange:n,className:l,style:i,children:c,...d}=e,u=function(){let[e,t]=s.useState(void 0);return s.useEffect(()=>{let e=window.matchMedia("(max-width: ".concat(767,"px)")),a=()=>{t(window.innerWidth<768)};return e.addEventListener("change",a),t(window.innerWidth<768),()=>e.removeEventListener("change",a)},[]),!!e}(),[m,h]=s.useState(!1),[f,x]=s.useState(t),g=null!=a?a:f,p=s.useCallback(e=>{let t="function"==typeof e?e(g):e;n?n(t):x(t),document.cookie="".concat("sidebar_state","=").concat(t,"; path=/; max-age=").concat(604800)},[n,g]),v=s.useCallback(()=>u?h(e=>!e):p(e=>!e),[u,p,h]);s.useEffect(()=>{let e=e=>{"b"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),v())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[v]);let b=g?"expanded":"collapsed",j=s.useMemo(()=>({state:b,open:g,setOpen:p,isMobile:u,openMobile:m,setOpenMobile:h,toggleSidebar:v}),[b,g,p,u,m,h,v]);return(0,r.jsx)(ef.Provider,{value:j,children:(0,r.jsx)(eh.Bc,{delayDuration:0,children:(0,r.jsx)("div",{"data-slot":"sidebar-wrapper",style:{"--sidebar-width":"16rem","--sidebar-width-icon":"3rem",...i},className:(0,o.cn)("group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full",l),...d,children:c})})})}function ep(e){let{side:t="left",variant:a="sidebar",collapsible:s="offcanvas",className:n,children:l,...i}=e,{isMobile:c,state:d,openMobile:u,setOpenMobile:m}=ex();return"none"===s?(0,r.jsx)("div",{"data-slot":"sidebar",className:(0,o.cn)("bg-sidebar text-sidebar-foreground flex h-full w-(--sidebar-width) flex-col",n),...i,children:l}):c?(0,r.jsx)(en,{open:u,onOpenChange:m,...i,children:(0,r.jsxs)(ec,{"data-sidebar":"sidebar","data-slot":"sidebar","data-mobile":"true",className:"bg-sidebar text-sidebar-foreground w-(--sidebar-width) p-0 [&>button]:hidden",style:{"--sidebar-width":"18rem"},side:t,children:[(0,r.jsxs)(eo,{className:"sr-only",children:[(0,r.jsx)(ed,{children:"Sidebar"}),(0,r.jsx)(eu,{children:"Displays the mobile sidebar."})]}),(0,r.jsx)("div",{className:"flex h-full w-full flex-col",children:l})]})}):(0,r.jsxs)("div",{className:"group peer text-sidebar-foreground hidden md:block","data-state":d,"data-collapsible":"collapsed"===d?s:"","data-variant":a,"data-side":t,"data-slot":"sidebar",children:[(0,r.jsx)("div",{"data-slot":"sidebar-gap",className:(0,o.cn)("relative w-(--sidebar-width) bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180","floating"===a||"inset"===a?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4)))]":"group-data-[collapsible=icon]:w-(--sidebar-width-icon)")}),(0,r.jsx)("div",{"data-slot":"sidebar-container",className:(0,o.cn)("fixed inset-y-0 z-10 hidden h-svh w-(--sidebar-width) transition-[left,right,width] duration-200 ease-linear md:flex","left"===t?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]","floating"===a||"inset"===a?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4))+2px)]":"group-data-[collapsible=icon]:w-(--sidebar-width-icon) group-data-[side=left]:border-r group-data-[side=right]:border-l",n),...i,children:(0,r.jsx)("div",{"data-sidebar":"sidebar","data-slot":"sidebar-inner",className:"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm",children:l})})]})}function ev(e){let{className:t,onClick:a,...s}=e,{toggleSidebar:n}=ex();return(0,r.jsxs)(ee.$,{"data-sidebar":"trigger","data-slot":"sidebar-trigger",variant:"outline",size:"icon",className:(0,o.cn)("size-7",t),onClick:e=>{null==a||a(e),n()},...s,children:[(0,r.jsx)(Q.A,{}),(0,r.jsx)("span",{className:"sr-only",children:"Toggle Sidebar"})]})}function eb(e){let{className:t,...a}=e;return(0,r.jsx)("main",{"data-slot":"sidebar-inset",className:(0,o.cn)("bg-background relative flex w-full flex-1 flex-col","md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2",t),...a})}function ej(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"sidebar-header","data-sidebar":"header",className:(0,o.cn)("flex flex-col gap-2 p-2",t),...a})}function ey(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"sidebar-footer","data-sidebar":"footer",className:(0,o.cn)("flex flex-col gap-2 p-2",t),...a})}function ew(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"sidebar-content","data-sidebar":"content",className:(0,o.cn)("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",t),...a})}function eN(e){let{className:t,...a}=e;return(0,r.jsx)("ul",{"data-slot":"sidebar-menu","data-sidebar":"menu",className:(0,o.cn)("flex w-full min-w-0 flex-col gap-1",t),...a})}function e_(e){let{className:t,...a}=e;return(0,r.jsx)("li",{"data-slot":"sidebar-menu-item","data-sidebar":"menu-item",className:(0,o.cn)("group/menu-item relative",t),...a})}let eS=(0,X.F)("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:p-0!"}},defaultVariants:{variant:"default",size:"default"}});function ek(e){let{asChild:t=!1,isActive:a=!1,variant:s="default",size:n="default",tooltip:l,className:i,...c}=e,d=t?Y.DX:"button",{isMobile:u,state:m}=ex(),h=(0,r.jsx)(d,{"data-slot":"sidebar-menu-button","data-sidebar":"menu-button","data-size":n,"data-active":a,className:(0,o.cn)(eS({variant:s,size:n}),i),...c});return l?("string"==typeof l&&(l={children:l}),(0,r.jsxs)(eh.m_,{children:[(0,r.jsx)(eh.k$,{asChild:!0,children:h}),(0,r.jsx)(eh.ZI,{side:"right",align:"center",hidden:"collapsed"!==m||u,...l})]})):h}let eA=e=>{let{...t}=e;return(0,r.jsx)(N.l$,{className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...t})};var eC=a(57340),eE=a(381),eT=a(1243),eR=a(50675),eI=a(83086);a(82808);var eO=a(38274),eM=a(60760),eD=a(92335);function eL(e){let{...t}=e;return(0,r.jsx)(eD.bL,{"data-slot":"hover-card",...t})}function eP(e){let{...t}=e;return(0,r.jsx)(eD.l9,{"data-slot":"hover-card-trigger",...t})}function eF(e){let{className:t,align:a="center",sideOffset:s=4,...n}=e;return(0,r.jsx)(eD.ZL,{"data-slot":"hover-card-portal",children:(0,r.jsx)(eD.UC,{"data-slot":"hover-card-content",align:a,sideOffset:s,className:(0,o.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-64 origin-(--radix-hover-card-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...n})})}let ez={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.07}}},eH={hidden:{y:-20,opacity:0},visible:{y:0,opacity:1},exit:{y:-20,opacity:0,transition:{duration:.2}}};function eK(){let{sidebarRightSide:e}=H(),{get:t}=f(),{open:a}=ex(),{setPage:n}=C(),{failedMessages:l,navbarLoading:i,navbarLoadingMessage:d,receiver:u}=S(),{startCall:m}=U(),[h,x]=(0,s.useState)("");return(0,s.useEffect)(()=>{""!==u?t(u).then(e=>{x(e.display)}):x("")},[u]),(0,r.jsxs)("div",{className:"flex-1 flex items-center p-1.5 pb-0",style:{WebkitAppRegion:"drag"},children:[e?null:(0,r.jsx)("div",{className:(0,o.cn)("bg-sidebar hidden md:block transition-all duration-300",a?"w-[var(--sidebar-width)]":"w-0")}),(0,r.jsxs)(eO.P.div,{className:"bg-sidebar flex-1 flex items-center gap-3",variants:ez,initial:"hidden",animate:"visible",children:[(0,r.jsx)(eO.P.div,{layout:"position",variants:eH,children:(0,r.jsx)(ev,{className:"w-9 h-9"})}),(0,r.jsx)(eO.P.div,{layout:"position",variants:eH,children:(0,r.jsx)(ee.$,{className:"w-9 h-9",variant:"outline",onClick:()=>n({name:"home",data:""}),children:(0,r.jsx)(eC.A,{})})}),(0,r.jsx)(eO.P.div,{layout:"position",variants:eH,children:(0,r.jsx)(ee.$,{className:"w-9 h-9",variant:"outline",onClick:()=>n({name:"settings",data:""}),children:(0,r.jsx)(eE.A,{})})}),(0,r.jsx)(eM.N,{children:""!==h&&(0,r.jsx)(eO.P.div,{layout:"position",variants:eH,initial:"hidden",animate:"visible",exit:"exit",children:(0,r.jsx)("p",{className:"font-bold whitespace-nowrap overflow-hidden text-ellipsis",children:h})},"receiver-display")}),(0,r.jsx)(eO.P.div,{layout:!0,className:"w-full",variants:eH}),(0,r.jsxs)(eM.N,{children:[i&&(0,r.jsx)(eO.P.div,{layout:"position",variants:eH,initial:"hidden",animate:"visible",exit:"exit",children:(0,r.jsxs)(eL,{children:[(0,r.jsx)(eP,{asChild:!0,children:(0,r.jsx)(ee.$,{className:"w-9 h-9",variant:"outline",children:(0,r.jsx)(eI.A,{size:"16",stroke:"2",bgOpacity:"0",speed:"2",color:"var(--foreground)"})})}),(0,r.jsx)(eF,{children:(0,r.jsx)("p",{className:"text-sm",children:d})})]})},"loading-indicator"),l>0&&(0,r.jsx)(eO.P.div,{layout:"position",variants:eH,initial:"hidden",animate:"visible",exit:"exit",children:(0,r.jsxs)(eL,{children:[(0,r.jsx)(eP,{asChild:!0,children:(0,r.jsx)(ee.$,{className:"w-9 h-9 text-destructive",variant:"outline",children:(0,r.jsx)(eT.A,{})})}),(0,r.jsx)(eF,{children:(0,r.jsxs)("p",{className:"text-sm text-destructive",children:["Failed to load ",l," ",1===l?"message":"messages","."]})})]})},"failed-messages-indicator"),""!==u&&(0,r.jsx)(eO.P.div,{layout:"position",variants:eH,initial:"hidden",animate:"visible",exit:"exit",children:(0,r.jsx)(ee.$,{className:"w-9 h-9",variant:"outline",onClick:()=>{m(!0,(0,c.A)(),(0,c.A)())},children:(0,r.jsx)(eR.A,{})})},"call-button"),(0,o.b8)()&&(0,r.jsx)(eO.P.div,{layout:"position",variants:eH,initial:"hidden",animate:"visible",exit:"exit",children:(0,r.jsx)(ee.$,{className:"w-9 h-9",variant:"outline",onClick:()=>{window.close()},children:(0,r.jsx)(es.A,{})})},"call-button")]})]}),e?(0,r.jsx)("div",{className:(0,o.cn)("bg-sidebar hidden md:block transition-all duration-300",a?"w-[var(--sidebar-width)]":"w-0")}):null]})}var eW=a(66766),eJ=a(79397),eU=a(38611),e$=a(54011);function eZ(e){let{className:t,...a}=e;return(0,r.jsx)(e$.bL,{"data-slot":"avatar",className:(0,o.cn)("relative flex size-8 shrink-0 overflow-hidden rounded-full",t),...a})}function eG(e){let{className:t,...a}=e;return(0,r.jsx)(e$.H4,{"data-slot":"avatar-fallback",className:(0,o.cn)("bg-muted flex size-full items-center justify-center rounded-full",t),...a})}let eB=(0,X.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border bg-destructive text-sidebar/70 [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function eq(e){let{className:t,variant:a,asChild:s=!1,...n}=e,l=s?Y.DX:"span";return(0,r.jsx)(l,{"data-slot":"badge",className:(0,o.cn)(eB({variant:a}),t),...n})}function eV(e){let{id:t,state:a}=e,[n,l]=(0,s.useState)("..."),[i,c]=(0,s.useState)("..."),[d,u]=(0,s.useState)("..."),{get:m,refetchUser:h}=f();return(0,s.useEffect)(()=>{""!==t&&m(t).then(e=>{l(e.avatar),c(e.username),u(e.display)})},[t,h]),(0,r.jsx)("div",{className:"rounded-xl flex flex-col items-center p-3 gap-3 justify-center",children:(0,r.jsxs)("div",{className:"flex w-full gap-3 items-center",children:[(0,r.jsxs)("div",{className:"relative w-[35px] h-[35px]",children:["..."!==n?(0,r.jsxs)(eZ,{className:"bg-accent/50",children:[""!==n?(0,r.jsx)(eW.default,{className:"w-auto h-auto object-fill","data-slot":"avatar-image",width:36,height:36,src:n,alt:"",onError:()=>{l("")}}):null,(0,r.jsx)(eG,{children:(0,o.j3)(i)})]}):(0,r.jsx)(em,{className:"rounded-full size-8"}),(0,r.jsxs)(eh.m_,{children:[(0,r.jsx)(eh.k$,{asChild:!0,className:"absolute bottom-0 right-0 w-[15px] h-[15px]",children:(0,r.jsx)("div",{onClick:()=>(0,N.oR)("Huhu"),className:(0,o.cn)("cursor-pointer rounded-full border-3 border-card",o.PA[a]||"bg-white")})}),(0,r.jsx)(eh.ZI,{className:"border-1",children:(0,r.jsx)("p",{children:(0,o.F9)(a)})})]})]}),(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsx)("div",{className:"text-[14px] font-bold",children:"..."!==d?(0,r.jsx)("p",{children:d}):(0,r.jsx)(em,{className:"mr-20",children:(0,r.jsx)("p",{className:"invisible",children:"\uD83E\uDD74"})})}),(0,r.jsx)("div",{className:"text-[12px] font-bold text-foreground/67",children:"..."!==i?(0,r.jsx)("p",{children:i}):(0,r.jsx)(em,{className:"mr-8 mt-1",children:(0,r.jsx)("p",{className:"invisible",children:"\uD83E\uDD74"})})})]})]})})}function eY(e){let{id:t,state:a,showIotaStatus:n=!1,forceLoad:l=!1,callActive:i=!1,callId:c="",encCallSecret:d=""}=e,[u,h]=(0,s.useState)("..."),[x,g]=(0,s.useState)("..."),[p,b]=(0,s.useState)("..."),[j,y]=(0,s.useState)(""),[w,N]=(0,s.useState)(""),[_,S]=(0,s.useState)(!1),[k,A]=(0,s.useState)(i),{get:C,refetchUser:E}=f(),{privateKey:T}=v(),{get_shared_secret:R,decrypt_base64_using_aes:I}=(0,m.w)(),{startCall:O}=U();return(0,s.useEffect)(()=>{""!==d&&async function(){N(atob(await I(d,await R(T,await C(t).then(e=>e.public_key)))))}()},[d]),(0,s.useEffect)(()=>{""!==t&&C(t).then(e=>{h(e.avatar),g(e.username),b(e.display),y(e.status)})},[t,E]),(0,r.jsxs)("div",{className:"rounded-xl flex items-center h-12 pl-3 gap-3",children:[!l&&(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsxs)("div",{className:"relative w-[27px] h-[27px] mb-2",children:["..."!==u?(0,r.jsxs)(eZ,{className:"bg-accent/50",children:[""!==u&&(0,r.jsx)(eW.default,{className:"w-auto h-auto object-fill","data-slot":"avatar-image",width:36,height:36,src:u,alt:"",onError:()=>{h("")}}),(0,r.jsx)(eG,{children:(0,o.j3)(x)})]}):(0,r.jsx)(em,{className:"rounded-full size-8"}),(0,r.jsxs)(eh.m_,{children:[(0,r.jsx)(eh.k$,{asChild:!0,className:"absolute -bottom-2 -right-2 w-[15px] h-[15px]",children:"none"===a?(0,r.jsx)("div",{className:"cursor-pointer rounded-full border-3 border-card bg-card",children:(0,r.jsx)(em,{className:"bg-white w-full h-full"})}):(0,r.jsx)("div",{className:(0,o.cn)("cursor-pointer rounded-full border-3 border-card",o.PA[a]||"bg-white")})}),(0,r.jsx)(eh.ZI,{className:"border-1",children:(0,r.jsx)("p",{children:(0,o.F9)(a)})})]})]})}),(0,r.jsx)("div",{className:"min-w-0 flex-grow w-full",children:(0,r.jsx)("div",{className:"".concat(n&&"IOTA_OFFLINE"!==a?"flex":""," gap-2 text-[15px] overflow-hidden whitespace-nowrap text-overflow-ellipsis"),children:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("div",{className:"flex gap-2",children:"..."!==p||l?(0,r.jsx)("p",{children:l?"Debug Mode":p}):(0,r.jsx)(em,{children:(0,r.jsx)("p",{className:"invisible",children:"Tensamin :3"})})}),(0,r.jsx)("div",{className:"flex gap-1",children:(0,r.jsx)("p",{className:"text-xs text-foreground/75",children:l?"Chats wont load!":j})})]})})}),n&&"IOTA_OFFLINE"===a&&(0,r.jsx)("div",{className:"flex justify-center items-center",children:(0,r.jsxs)(eh.m_,{children:[(0,r.jsx)(eh.k$,{asChild:!0,children:(0,r.jsx)(eq,{variant:"destructive",className:"w-7 h-7",children:(0,r.jsx)(eJ.A,{})})}),(0,r.jsx)(eh.ZI,{children:(0,r.jsx)("p",{children:"Iota is Offline"})})]})}),k&&(0,r.jsx)("div",{className:"flex justify-center items-center",children:(0,r.jsxs)(eh.m_,{children:[(0,r.jsx)(eh.k$,{asChild:!0,children:(0,r.jsx)(eq,{className:"w-7 h-7",onMouseEnter:()=>S(!0),onMouseLeave:()=>S(!1),onClick:()=>{O(!1,c,w),A(!1)},children:_?(0,r.jsx)(eU.A,{}):(0,r.jsx)(eR.A,{})})}),(0,r.jsx)(eh.ZI,{children:(0,r.jsx)("p",{children:"Join call"})})]})})]})}function eX(e){let{id:t}=e,[a,n]=(0,s.useState)("..."),[l,i]=(0,s.useState)("..."),[c,d]=(0,s.useState)("..."),{get:u,refetchUser:m}=f();return(0,s.useEffect)(()=>{""!==t&&u(t).then(e=>{n(e.avatar),i(e.username),d(e.display)})},[t,m]),(0,r.jsx)("div",{className:"rounded-xl flex items-center h-7 gap-3",children:(0,r.jsxs)(r.Fragment,{children:["..."!==a?(0,r.jsxs)(eZ,{className:"bg-accent/50",children:[""!==a?(0,r.jsx)(eW.default,{className:"w-auto h-auto object-fill","data-slot":"avatar-image",width:36,height:36,src:a,alt:"",onError:()=>{n("")}}):null,(0,r.jsx)(eG,{children:(0,o.j3)(l)})]}):(0,r.jsx)(em,{className:"rounded-full size-8"}),"..."!==c?(0,r.jsx)("p",{className:"text-[15px] overflow-hidden whitespace-nowrap text-overflow-ellipsis",children:c}):(0,r.jsx)(em,{className:"mr-20",children:(0,r.jsx)("p",{className:"invisible",children:"\uD83E\uDD74"})})]})})}function eQ(e){let{id:t}=e,[a,n]=(0,s.useState)("..."),[l,i]=(0,s.useState)("..."),[c,d]=(0,s.useState)("..."),{get:u,refetchUser:m}=f();return(0,s.useEffect)(()=>{""!==t&&u(t).then(e=>{n(e.avatar),i(e.username),d(e.display)})},[t,m]),(0,r.jsx)("div",{className:"rounded-xl flex flex-col items-center p-3 gap-3 justify-center",children:(0,r.jsxs)("div",{className:"flex flex-col text-center w-full gap-3 items-center",children:[(0,r.jsx)("div",{className:"relative",children:"..."!==a?(0,r.jsxs)(eZ,{className:"size-40 bg-accent/50 border-1",children:[""!==a?(0,r.jsx)(eW.default,{className:"w-auto h-auto object-fill","data-slot":"avatar-image",width:150,height:150,src:a,alt:"",onError:()=>{n("")}}):null,(0,r.jsx)(eG,{children:(0,o.j3)(l)})]}):(0,r.jsx)(em,{className:"rounded-full size-8"})}),(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsx)("div",{className:"text-4xl font-bold",children:"..."!==c?(0,r.jsx)("p",{children:c}):(0,r.jsx)(em,{className:"mr-20",children:(0,r.jsx)("p",{className:"invisible",children:"\uD83E\uDD74"})})}),(0,r.jsx)("div",{className:"text-lg font-bold text-foreground/67",children:"..."!==l?(0,r.jsx)("p",{children:l}):(0,r.jsx)(em,{className:"mr-8 mt-1",children:(0,r.jsx)("p",{className:"invisible",children:"\uD83E\uDD74"})})})]})]})})}function e0(){let{send:e,connected:t,identified:a}=y(),{chatsArray:n,setChatsArray:l,forceLoad:i,getUserState:c,refreshChats:o}=f(),{setPage:d}=C();return(0,s.useEffect)(()=>{t&&a&&!i?e("get_chats",{log_level:0,message:"Getting all chats"},{}).then(e=>{l(e.data.user_ids.sort((e,t)=>t.last_message_at-e.last_message_at))}):l([{user_id:"",last_message_at:0}])},[t,a,i,o]),(0,r.jsx)("div",{className:"flex flex-col gap-2 mr-2 ml-3",children:n.map(e=>(0,r.jsx)(e_,{children:(0,r.jsx)(ee.$,{className:"w-full h-full p-1 pr-2.5 pl-0 rounded-2xl transition-all duration-200 ease-in-out",variant:"outline",onClick:()=>{d({name:"chat",data:e.user_id})},disabled:i,children:(0,r.jsx)("div",{variant:"outline",className:"w-full text-left justify-start",children:i?(0,r.jsx)(eY,{id:"",state:"none",showIotaStatus:!1,forceLoad:!0}):(0,r.jsx)(eY,{id:e.user_id,state:c(e.user_id),showIotaStatus:!0,callActive:e.call_active,callId:e.call_id||"",encCallSecret:e.call_secret||""})})})},e.user_id))})}function e1(e){let{ip:t,port:a,secure:s,state:n,forceLoad:l=!1}=e;return(0,r.jsxs)("div",{className:"rounded-xl flex items-center h-12 pl-3 gap-3",children:[!l&&(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsxs)("div",{className:"relative w-[27px] h-[27px] mb-2",children:["..."!==avatar?(0,r.jsxs)(eZ,{className:"bg-accent/50",children:[""!==avatar&&(0,r.jsx)(eW.default,{className:"w-auto h-auto object-fill","data-slot":"avatar-image",width:36,height:36,src:logo,alt:"",onError:()=>{setLogo("")}}),(0,r.jsx)(eG,{children:(0,o.j3)(communityname)})]}):(0,r.jsx)(em,{className:"rounded-full size-8"}),(0,r.jsxs)(eh.m_,{children:[(0,r.jsx)(eh.k$,{asChild:!0,className:"absolute -bottom-2 -right-2 w-[15px] h-[15px]",children:"none"===n?(0,r.jsx)("div",{className:"cursor-pointer rounded-full border-3 border-card bg-card",children:(0,r.jsx)(em,{className:"bg-white w-full h-full"})}):(0,r.jsx)("div",{className:(0,o.cn)("cursor-pointer rounded-full border-3 border-card",o.PA[n]||"bg-white")})}),(0,r.jsx)(eh.ZI,{className:"border-1",children:(0,r.jsx)("p",{children:(0,o.F9)(n)})})]})]})}),(0,r.jsx)("div",{className:"min-w-0 flex-grow w-full",children:(0,r.jsx)("div",{className:"".concat(showIotaStatus&&"IOTA_OFFLINE"!==n?"flex":""," gap-2 text-[15px] overflow-hidden whitespace-nowrap text-overflow-ellipsis"),children:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("div",{className:"flex gap-2",children:"..."!==display||l?(0,r.jsx)("p",{children:l?"Debug Mode":display}):(0,r.jsx)(em,{children:(0,r.jsx)("p",{className:"invisible",children:"Tensamin :3"})})}),(0,r.jsx)("div",{className:"flex gap-1",children:(0,r.jsx)("p",{className:"text-xs text-foreground/75",children:l?"Chats wont load!":status})})]})})})]})}function e2(){let{send:e,connected:t,identified:a}=y(),{communitiesArray:n,setCommunitiesArray:l,forceLoad:i,refreshCommunities:c}=f(),{setPage:o}=C();return(0,s.useEffect)(()=>{t&&a&&!i?e("get_communities",{log_level:0,message:"Getting all communities"},{}).then(e=>{l(e.data.communities.sort((e,t)=>e.position-t.position))}):l([{position:0,ip:"",port:0,secure:!1,state:"none"}])},[t,a,i,c]),(0,r.jsx)("div",{className:"flex flex-col gap-2 mr-2 ml-3",children:n.map(e=>(0,r.jsx)(e_,{children:(0,r.jsx)(ee.$,{className:"w-full h-full p-1 pr-2.5 pl-0 rounded-2xl transition-all duration-200 ease-in-out",variant:"outline",onClick:()=>{o({name:"community",data:JSON.stringify({ip:e.ip,port:e.port,secure:e.secure})})},disabled:i,children:(0,r.jsx)("div",{variant:"outline",className:"w-full text-left justify-start",children:i?(0,r.jsx)(e1,{forceLoad:!0}):(0,r.jsx)(e1,{ip:e.ip,port:e.port,secure:e.secure,state:e.state})})})},e.position))})}var e5=a(80987),e3=a(84355),e4=a(91064),e6=a(2182),e8=a(1576),e9=a(14738),e7=a(32999),te=a(15675),tt=a(97162),ta=a(15273),tr=a(52856),ts=a(62209),tn=a(91951),tl=a(97207),ti=a(23146),tc=a(57395),to=a(54765),td=a(21731),tu=a(23853);function tm(e){let{...t}=e;return(0,r.jsx)(tu.bL,{"data-slot":"dropdown-menu",...t})}function th(e){let{...t}=e;return(0,r.jsx)(tu.ZL,{"data-slot":"dropdown-menu-portal",...t})}function tf(e){let{...t}=e;return(0,r.jsx)(tu.l9,{"data-slot":"dropdown-menu-trigger",...t})}function tx(e){let{className:t,sideOffset:a=4,...s}=e;return(0,r.jsx)(tu.ZL,{children:(0,r.jsx)(tu.UC,{"data-slot":"dropdown-menu-content",sideOffset:a,className:(0,o.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",t),...s})})}function tg(e){let{...t}=e;return(0,r.jsx)(tu.YJ,{"data-slot":"dropdown-menu-group",...t})}function tp(e){let{className:t,inset:a,variant:s="default",...n}=e;return(0,r.jsx)(tu.q7,{"data-slot":"dropdown-menu-item","data-inset":a,"data-variant":s,className:(0,o.cn)("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n})}function tv(e){let{className:t,...a}=e;return(0,r.jsx)(tu.wv,{"data-slot":"dropdown-menu-separator",className:(0,o.cn)("bg-border -mx-1 my-1 h-px",t),...a})}function tb(e){let{...t}=e;return(0,r.jsx)(tu.Pb,{"data-slot":"dropdown-menu-sub",...t})}function tj(e){let{className:t,inset:a,children:s,...n}=e;return(0,r.jsx)(tu.ZP,{"data-slot":"dropdown-menu-sub-trigger","data-inset":a,className:(0,o.cn)("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n,children:s})}function ty(e){let{className:t,...a}=e;return(0,r.jsx)(tu.G5,{"data-slot":"dropdown-menu-sub-content",className:(0,o.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-lg",t),...a})}var tw=a(54059),tN=a(9428);function t_(e){let{className:t,...a}=e;return(0,r.jsx)(tw.bL,{"data-slot":"radio-group",className:(0,o.cn)("grid gap-3",t),...a})}function tS(e){let{className:t,...a}=e;return(0,r.jsx)(tw.q7,{"data-slot":"radio-group-item",className:(0,o.cn)("border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:(0,r.jsx)(tw.C1,{"data-slot":"radio-group-indicator",className:"relative flex items-center justify-center",children:(0,r.jsx)(tN.A,{className:"fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2"})})})}var tk=a(57580),tA=a(77740),tC=a(47924);function tE(e){let{...t}=e;return(0,r.jsx)(er.bL,{"data-slot":"dialog",...t})}function tT(e){let{...t}=e;return(0,r.jsx)(er.ZL,{"data-slot":"dialog-portal",...t})}function tR(e){let{className:t,...a}=e;return(0,r.jsx)(er.hJ,{"data-slot":"dialog-overlay",className:(0,o.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function tI(e){let{className:t,children:a,showCloseButton:s=!0,...n}=e;return(0,r.jsxs)(tT,{"data-slot":"dialog-portal",children:[(0,r.jsx)(tR,{}),(0,r.jsxs)(er.UC,{"data-slot":"dialog-content",className:(0,o.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...n,children:[a,s&&(0,r.jsxs)(er.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,r.jsx)(es.A,{}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function tO(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"dialog-header",className:(0,o.cn)("flex flex-col gap-2 text-center sm:text-left",t),...a})}function tM(e){let{className:t,...a}=e;return(0,r.jsx)(er.hE,{"data-slot":"dialog-title",className:(0,o.cn)("text-lg leading-none font-semibold",t),...a})}function tD(e){let{className:t,...a}=e;return(0,r.jsx)(er.VY,{"data-slot":"dialog-description",className:(0,o.cn)("text-muted-foreground text-sm",t),...a})}function tL(e){let{className:t,...a}=e;return(0,r.jsx)(tA.uB,{"data-slot":"command",className:(0,o.cn)("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",t),...a})}function tP(e){let{title:t="Command Palette",description:a="Search for a command to run...",children:s,className:n,showCloseButton:l=!0,...i}=e;return(0,r.jsxs)(tE,{...i,children:[(0,r.jsxs)(tO,{className:"sr-only",children:[(0,r.jsx)(tM,{children:t}),(0,r.jsx)(tD,{children:a})]}),(0,r.jsx)(tI,{className:(0,o.cn)("overflow-hidden p-0",n),showCloseButton:l,children:(0,r.jsx)(tL,{className:"[&_[cmdk-group-heading]]:text-muted-foreground **:data-[slot=command-input-wrapper]:h-12 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group]]:px-2 [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5",children:s})})]})}function tF(e){let{className:t,...a}=e;return(0,r.jsxs)("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[(0,r.jsx)(tC.A,{className:"size-4 shrink-0 opacity-50"}),(0,r.jsx)(tA.uB.Input,{"data-slot":"command-input",className:(0,o.cn)("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",t),...a})]})}function tz(e){let{className:t,...a}=e;return(0,r.jsx)(tA.uB.List,{"data-slot":"command-list",className:(0,o.cn)("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",t),...a})}function tH(e){let{...t}=e;return(0,r.jsx)(tA.uB.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...t})}function tK(e){let{className:t,...a}=e;return(0,r.jsx)(tA.uB.Group,{"data-slot":"command-group",className:(0,o.cn)("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",t),...a})}function tW(e){let{className:t,...a}=e;return(0,r.jsx)(tA.uB.Item,{"data-slot":"command-item",className:(0,o.cn)("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...a})}function tJ(){let{invitedToCall:e,setInvitedToCall:t,inviteData:a,setCallId:n,setCallSecret:l,startCall:i,stopCall:c}=U(),[o,d]=(0,s.useState)(""),[u,m]=(0,s.useState)(""),[h,f]=(0,s.useState)("");return(0,s.useEffect)(()=>{d(a.callerId),m(a.callId),f(a.callSecret)},[a]),(0,r.jsx)(tP,{showCloseButton:!1,open:e,onOpenChange:t,className:"rounded-3xl border shadow-md w-75 h-auto",children:(0,r.jsxs)("div",{className:"flex flex-col justify-center items-center w-full gap-5 p-5",children:[(0,r.jsx)(eQ,{id:o}),(0,r.jsxs)("div",{className:"flex gap-10",children:[(0,r.jsx)(ee.$,{className:"size-15 rounded-2xl",onClick:async()=>{i(!1,u,h),t(!1)},children:(0,r.jsx)("div",{className:"scale-140",children:(0,r.jsx)(eU.A,{})})}),(0,r.jsx)(ee.$,{className:"size-15 rounded-2xl bg-destructive hover:bg-destructive/90",onClick:()=>{t(!1)},children:(0,r.jsx)("div",{className:"scale-140",children:(0,r.jsx)(es.A,{})})})]})]})},e)}function tU(e){let{id:t,local:a=!1,className:n,onPlay:l}=e,i=(0,s.useRef)(null),{getScreenStream:c}=U(),[o,d]=(0,s.useState)(null),[u,m]=(0,s.useState)(0);function h(){l(!0)}return(0,s.useEffect)(()=>{a?d(c()):(void 0!==c(t)?d(c(t)):m(u+1),d(c(t)))},[a,u]),(0,s.useEffect)(()=>{i.current&&o&&(i.current.srcObject=o)},[o]),(0,s.useEffect)(()=>{let e=i.current;if(e)return e.addEventListener("play",h),()=>{e.removeEventListener("play",h)}},[]),(0,r.jsx)("video",{className:n,ref:i,autoPlay:!0,playsInline:!0,style:{width:"100%",height:"100%",objectFit:"contain"}})}function t$(e){let{id:t,onShouldClose:a}=e,{get:s}=f(),{get_shared_secret:n,encrypt_base64_using_aes:l}=(0,m.w)(),{privateKey:i}=v(),{send:c}=y(),{callId:d,callSecret:u}=U(),h=async()=>{try{await c("call_invite",{message:"Invited ".concat(t," to the call ").concat(d),log_level:0},{receiver_id:t,call_id:d,call_secret:await l(btoa(u),await n(i,await s(t).then(e=>e.public_key))),call_secret_sha:await (0,o.sc)(u)}).then(e=>{"error"!==e.type?(0,o.Rm)("Sent Invite","success"):(0,o.Rm)(e.log.message,"showError")})}catch(e){(0,o.Rm)("Failed to send invite: ".concat(e),"showError")}finally{a(!1)}};return(0,r.jsx)(tW,{onSelect:h,children:(0,r.jsx)(eX,{id:t})})}function tZ(){let{setPage:e}=C(),{toggleMute:t,toggleDeaf:a,mute:s,deaf:n,stream:l,stopCall:i,getScreenStream:c,startScreenStream:o,stopScreenStream:d,setStreamResolution:u,setStreamRefresh:m,setStreamAudio:h,streamResolution:f,streamRefresh:x,streamAudio:g}=U();return(0,r.jsxs)(to.Zp,{className:"flex w-full flex-col p-2 gap-2",children:[l&&(0,r.jsx)("div",{className:"aspect-16/9",children:(0,r.jsx)(tU,{local:!0,className:"rounded-lg border-1",onPlay:()=>{}})}),(0,r.jsxs)("div",{className:"flex flex-row justify-center gap-3",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsxs)("div",{className:"flex flex-row gap-3",children:[(0,r.jsxs)(eh.m_,{delayDuration:2e3,children:[(0,r.jsx)(eh.k$,{asChild:!0,children:(0,r.jsx)(ee.$,{disabled:!0,className:"h-9 w-9",onClick:()=>console.log("Soundboard"),children:(0,r.jsx)(e5.A,{})})}),(0,r.jsx)(eh.ZI,{children:(0,r.jsx)("p",{children:"Soundboard"})})]}),(0,r.jsxs)(eh.m_,{delayDuration:2e3,children:[(0,r.jsx)(eh.k$,{asChild:!0,children:(0,r.jsx)(ee.$,{disabled:!0,className:"h-9 w-9",onClick:()=>console.log("Camera"),children:(0,r.jsx)(e3.A,{})})}),(0,r.jsx)(eh.ZI,{children:(0,r.jsx)("p",{children:"Camera"})})]})]}),(0,r.jsxs)("div",{className:"flex flex-row gap-3",children:[(0,r.jsxs)(eh.m_,{delayDuration:2e3,children:[(0,r.jsx)(eh.k$,{asChild:!0,children:(0,r.jsx)(ee.$,{className:"h-9 w-9",onClick:()=>e({name:"voice-expanded",data:""}),children:(0,r.jsx)(e4.A,{})})}),(0,r.jsx)(eh.ZI,{children:(0,r.jsx)("p",{children:"Expand"})})]}),(0,r.jsxs)(eh.m_,{delayDuration:2e3,children:[(0,r.jsx)(eh.k$,{asChild:!0,children:(0,r.jsx)(ee.$,{className:"h-9 w-9",onClick:()=>e({name:"voice-rearrangement",data:""}),children:(0,r.jsx)(e6.A,{})})}),(0,r.jsx)(eh.ZI,{children:(0,r.jsx)("p",{children:"Rearrangement"})})]})]})]}),(0,r.jsx)("div",{className:"w-full h-auto flex justify-center items-center",children:(0,r.jsx)("div",{className:"h-3/4 border-l pl-0.5"})}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsxs)("div",{className:"flex flex-row gap-3",children:[(0,r.jsx)("div",{children:(0,r.jsxs)(tm,{children:[(0,r.jsxs)(eh.m_,{delayDuration:2e3,children:[(0,r.jsx)(eh.k$,{asChild:!0,children:(0,r.jsx)(tf,{asChild:!0,children:(0,r.jsx)(ee.$,{className:"h-9 w-9",children:l?(0,r.jsx)(e8.A,{}):(0,r.jsx)(e9.A,{})})})}),(0,r.jsx)(eh.ZI,{children:(0,r.jsx)("p",{children:"Stream"})})]}),(0,r.jsxs)(tx,{children:[(0,r.jsxs)(tg,{heading:"Actions",children:[(0,r.jsxs)(tp,{disabled:l,onClick:o,children:[(0,r.jsx)(e7.A,{className:"mr-2"}),(0,r.jsx)("span",{children:"Start Stream"})]}),(0,r.jsxs)(tp,{disabled:!l,onClick:d,children:[(0,r.jsx)(te.A,{className:"mr-2"}),(0,r.jsx)("span",{children:"Stop Stream"})]}),(0,r.jsxs)(tp,{disabled:!l,children:[(0,r.jsx)(tt.A,{className:"mr-2"}),(0,r.jsx)("span",{children:"Change Window"})]})]}),(0,r.jsx)(tv,{}),(0,r.jsxs)(tg,{heading:"Controls",children:[(0,r.jsxs)(tp,{onSelect:e=>e.preventDefault(),children:[(0,r.jsx)(ta.A,{className:"mr-2"}),(0,r.jsx)(td.J,{htmlFor:"stream-audio",className:"w-full text-sm font-normal",children:"Stream Audio"}),(0,r.jsx)(tk.S,{id:"stream-audio",checked:g,onCheckedChange:function(e){h(e)}})]}),(0,r.jsxs)(tb,{children:[(0,r.jsxs)(tj,{children:[(0,r.jsx)(tr.A,{className:"mr-2"}),(0,r.jsx)("span",{children:"Change Quality"})]}),(0,r.jsx)(th,{children:(0,r.jsxs)(ty,{children:[(0,r.jsx)(tg,{children:(0,r.jsxs)(t_,{className:"gap-0.5",defaultValue:x,onValueChange:function(e){m(e)},children:[(0,r.jsxs)(tp,{children:[(0,r.jsx)(tS,{value:"15",id:"15"}),(0,r.jsx)(td.J,{className:"w-full pl-2",htmlFor:"15",children:"15 FPS"})]}),(0,r.jsxs)(tp,{children:[(0,r.jsx)(tS,{value:"30",id:"30"}),(0,r.jsx)(td.J,{className:"w-full pl-2",htmlFor:"30",children:"30 FPS"})]}),(0,r.jsxs)(tp,{children:[(0,r.jsx)(tS,{value:"60",id:"60"}),(0,r.jsx)(td.J,{className:"w-full pl-2",htmlFor:"60",children:"60 FPS"})]}),(0,r.jsxs)(tp,{children:[(0,r.jsx)(tS,{value:"120",id:"120"}),(0,r.jsx)(td.J,{className:"w-full pl-2",htmlFor:"120",children:"120 FPS"})]})]})}),(0,r.jsx)(tv,{}),(0,r.jsx)(tg,{children:(0,r.jsxs)(t_,{className:"gap-0.5",defaultValue:f,onValueChange:function(e){u(e)},children:[(0,r.jsxs)(tp,{children:[(0,r.jsx)(tS,{value:"854x480",id:"480"}),(0,r.jsx)(td.J,{className:"w-full pl-2",htmlFor:"480",children:"480p"})]}),(0,r.jsxs)(tp,{children:[(0,r.jsx)(tS,{value:"1280x720",id:"720"}),(0,r.jsx)(td.J,{className:"w-full pl-2",htmlFor:"720",children:"720p"})]}),(0,r.jsxs)(tp,{children:[(0,r.jsx)(tS,{value:"1920x1080",id:"1080"}),(0,r.jsx)(td.J,{className:"w-full pl-2",htmlFor:"1080",children:"1080p"})]}),(0,r.jsxs)(tp,{children:[(0,r.jsx)(tS,{value:"2560x1440",id:"1440"}),(0,r.jsx)(td.J,{className:"w-full pl-2",htmlFor:"1440",children:"1440p"})]})]})})]})})]})]})]})]})}),(0,r.jsxs)(eh.m_,{delayDuration:2e3,children:[(0,r.jsx)(eh.k$,{asChild:!0,children:(0,r.jsx)(ee.$,{variant:"destructive",className:"h-9 w-9",onClick:i,children:(0,r.jsx)(ts.A,{})})}),(0,r.jsx)(eh.ZI,{children:(0,r.jsx)("p",{children:"Exit Call"})})]})]}),(0,r.jsxs)("div",{className:"flex flex-row gap-3",children:[(0,r.jsxs)(eh.m_,{delayDuration:2e3,children:[(0,r.jsx)(eh.k$,{asChild:!0,children:(0,r.jsx)(ee.$,{variant:s?"destructive":"default",className:"h-9 w-9",onClick:t,children:s?(0,r.jsx)(tn.A,{}):(0,r.jsx)(tl.A,{})})}),(0,r.jsx)(eh.ZI,{children:(0,r.jsx)("p",{children:"Toggle Mute"})})]}),(0,r.jsxs)(eh.m_,{delayDuration:2e3,children:[(0,r.jsx)(eh.k$,{asChild:!0,children:(0,r.jsx)(ee.$,{variant:n?"destructive":"default",className:"h-9 w-9",onClick:a,children:n?(0,r.jsx)(ti.A,{}):(0,r.jsx)(tc.A,{})})}),(0,r.jsx)(eh.ZI,{children:(0,r.jsx)("p",{children:"Toggle Deaf"})})]})]})]})]})]})}function tG(e){let{forceLoad:t,ownUuid:a}=f(),{sidebarRightSide:s}=H(),{connected:n}=U(),{sidebarCategory:l,setSidebarCategory:i}=C();return(0,r.jsxs)(ep,{side:s?"right":"left",variant:"inset",...e,children:[(0,r.jsxs)(ej,{children:[(0,r.jsx)(eN,{children:(0,r.jsx)(e_,{className:"border-1 bg-card rounded-xl",children:(0,r.jsx)(ek,{size:"lg",asChild:!0,children:(0,r.jsx)(eV,{id:a,state:"ONLINE"})})})}),n&&(0,r.jsx)(eN,{children:(0,r.jsx)(e_,{children:(0,r.jsx)(ek,{size:"lg",asChild:!0,children:(0,r.jsx)(tZ,{})})})}),(0,r.jsx)(eN,{className:"pt-3 pb-3",children:(0,r.jsx)(e_,{children:(0,r.jsxs)("div",{className:"flex w-full justify-center rounded-full bg-card py-1 px-1.5 gap-1",children:[(0,r.jsx)(ee.$,{variant:"communities"!==l?"ghost":"outline",className:"w-1/2 rounded-full",disabled:t,onClick:()=>{"communities"!==l&&i("communities")},children:"Communities"}),(0,r.jsx)(ee.$,{variant:"chats"!==l?"ghost":"outline",className:"w-1/2 rounded-full",disabled:t,onClick:()=>{"chats"!==l&&i("chats")},children:"Chats"})]})})})]}),(0,r.jsx)(ew,{children:(0,r.jsx)(eN,{children:"chats"===l?(0,r.jsx)(e0,{}):(0,r.jsx)(e2,{})})}),(0,r.jsx)(ey,{})]})}var tB=a(69074),tq=a(73314),tV=a(71007),tY=a(53145);function tX(e){let{...t}=e;return(0,r.jsx)(tY.bL,{"data-slot":"context-menu",...t})}function tQ(e){let{...t}=e;return(0,r.jsx)(tY.l9,{"data-slot":"context-menu-trigger",...t})}function t0(e){let{className:t,...a}=e;return(0,r.jsx)(tY.ZL,{children:(0,r.jsx)(tY.UC,{"data-slot":"context-menu-content",className:(0,o.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",t),...a})})}function t1(e){let{className:t,inset:a,variant:s="default",...n}=e;return(0,r.jsx)(tY.q7,{"data-slot":"context-menu-item","data-inset":a,"data-variant":s,className:(0,o.cn)("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n})}function t2(e){let{className:t,...a}=e;return(0,r.jsx)(tY.wv,{"data-slot":"context-menu-separator",className:(0,o.cn)("bg-border -mx-1 my-1 h-px",t),...a})}var t5=a(88240),t3=a(84823),t4=a(75418);a(49848);var t6=a(5623),t8=a(81497),t9=a(54032),t7=a(58497),ae=a(34646),at=a(5196),aa=a(32650);function ar(e){let{language:t,code:a}=e,[n,l]=s.useState(!1);async function i(){a&&(await navigator.clipboard.writeText(a),l(!0),setTimeout(()=>l(!1),2e3))}return(0,r.jsxs)("div",{className:"relative p-3 bg-background/45 rounded-2xl border pr-11",children:[(0,r.jsx)(ee.$,{className:"absolute top-0 right-0 dark:hover:bg-border m-1.5 rounded-xl",variant:"ghost",size:"icon",onClick:i,children:n?(0,r.jsx)(at.A,{}):(0,r.jsx)(aa.A,{})}),(0,r.jsx)(t7.A,{language:t,style:ae.iU,customStyle:{margin:0,padding:0,background:"transparent",fontSize:"0.875rem"},wrapLines:!0,showLineNumbers:!0,PreTag:"div",children:String(a)})]})}let as=e=>{let{children:t}=e;return(0,r.jsx)("h1",{className:"text-4xl font-extrabold mb-4 text-foreground leading-tight border-b-2 border-border pb-2",children:t})},an=e=>{let{children:t}=e;return(0,r.jsx)("h2",{className:"text-3xl font-bold mb-3 text-foreground leading-tight border-b border-border pb-1",children:t})},al=e=>{let{children:t}=e;return(0,r.jsx)("h3",{className:"text-2xl font-semibold mb-2  leading-snug",children:t})},ai=e=>{let{children:t}=e;return(0,r.jsx)("h4",{className:"text-xl font-medium mb-1  leading-normal",children:t})},ac=e=>{let{children:t}=e;return(0,r.jsx)("h5",{className:"text-lg font-medium ",children:t})},ao=e=>{let{children:t}=e;return(0,r.jsx)("h6",{className:"text-base font-medium ",children:t})},ad=e=>{let{children:t}=e;return(0,r.jsx)("code",{className:"bg-muted text-primary px-1 py-0.5 rounded text-sm font-mono break-words",children:t})},au=e=>{let{language:t,children:a}=e;return(0,r.jsx)(ar,{language:t,code:a})},am={h1:e=>{let{node:t,...a}=e;return(0,r.jsx)(as,{...a})},h2:e=>{let{node:t,...a}=e;return(0,r.jsx)(an,{...a})},h3:e=>{let{node:t,...a}=e;return(0,r.jsx)(al,{...a})},h4:e=>{let{node:t,...a}=e;return(0,r.jsx)(ai,{...a})},h5:e=>{let{node:t,...a}=e;return(0,r.jsx)(ac,{...a})},h6:e=>{let{node:t,...a}=e;return(0,r.jsx)(ao,{...a})},p:e=>{let{children:t}=e;return(0,r.jsx)("div",{className:"leading-relaxed",children:t})},a:e=>{let{href:t,title:a,children:s}=e;return(0,r.jsx)("a",{href:t,title:a,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:text-foreground underline transition-colors duration-200",children:s})},img:e=>{let{src:t,alt:a}=e;return(0,r.jsx)("img",{src:t,alt:a,className:"max-w-full h-auto rounded-lg shadow-md my-4 block mx-auto",loading:"lazy",decoding:"async"})},code:e=>{let{node:t,inline:a,className:s,children:n,...l}=e,i=/language-(\w+)/.exec(s||"");return!a&&i?(0,r.jsx)(au,{language:i[1],children:String(n).replace(/\n$/,"")}):(0,r.jsx)(ad,{children:n})},blockquote:e=>{let{children:t}=e;return(0,r.jsx)("blockquote",{className:"border-l-4 border-primary pl-4 py-2 my-4 italic  bg-muted bg-opacity-50 rounded-r-md",children:t})},ul:e=>{let{children:t}=e;return(0,r.jsx)("ul",{className:"list-disc ml-5 mb-4 pl-4 space-y-2",children:t})},ol:e=>{let{start:t,children:a}=e;return(0,r.jsx)("ol",{start:t,className:"list-decimal ml-5 mb-4 pl-4 space-y-2",children:a})},li:e=>{let{children:t}=e;return(0,r.jsx)("li",{className:"mb-2 ",children:t})},em:e=>{let{children:t}=e;return(0,r.jsx)("em",{className:"italic text-foreground",children:t})},strong:e=>{let{children:t}=e;return(0,r.jsx)("strong",{className:"font-bold text-foreground",children:t})},hr:()=>(0,r.jsx)("hr",{className:"border-t-2 border-border my-8 w-full mx-auto"}),table:e=>{let{children:t}=e;return(0,r.jsx)("table",{className:"w-full border-collapse my-6  shadow-sm rounded-lg overflow-hidden",children:t})},thead:e=>{let{children:t}=e;return(0,r.jsx)("thead",{className:"bg-muted",children:t})},tbody:e=>{let{children:t}=e;return(0,r.jsx)("tbody",{children:t})},tr:e=>{let{children:t}=e;return(0,r.jsx)("tr",{className:"border-b border-border last:border-b-0 even:bg-muted",children:t})},th:e=>{let{children:t}=e;return(0,r.jsx)("th",{className:"px-4 py-3 text-left font-semibold text-foreground uppercase text-sm tracking-wider border border-border",children:t})},td:e=>{let{children:t}=e;return(0,r.jsx)("td",{className:"px-4 py-3 border border-border",children:t})}},ah=/^data:image\/(png|jpe?g|gif|webp|avif);base64,/i,af=e=>e&&e.startsWith("data:")?e:(0,t5.Lv)(e),ax=e=>{if("img"===e.tagName){var t;let a=null==(t=e.properties)?void 0:t.src;return"string"==typeof a&&ah.test(a)}return!0};function ag(e){let{src:t,alt:a,title:s,...n}=e;return"string"==typeof t&&ah.test(t)?(0,r.jsx)("img",{src:t,alt:a,title:s,className:"max-w-full h-auto",...n}):null}function ap(e){let{message:t,sendToServer:a}=e,[n,l]=(0,s.useState)(!1),i=t.content;(0,s.useEffect)(()=>{if(a){let e=setTimeout(()=>l(!0),2500);return()=>clearTimeout(e)}},[a]);let c={...am,img:ag};return(0,r.jsxs)(tX,{children:[(0,r.jsx)(tQ,{children:(0,r.jsxs)("div",{className:"flex gap-2 text-foreground hover:bg-input/15 rounded-sm pl-1 ".concat(a?"opacity-50":null),children:[(0,r.jsx)("div",{className:"whitespace-pre-wrap w-full",children:(0,r.jsx)(t5.oz,{remarkPlugins:[t3.A],urlTransform:af,allowElement:ax,components:c,children:i})}),(0,r.jsx)("div",{className:"pt-0.5",children:a?(0,r.jsx)("div",{className:"h-full transition-opacity duration-500 ease-in-out ".concat(a&&n?"opacity-100":"opacity-0"),children:(0,r.jsx)(t4.A,{size:14,speed:2,color:"var(--foreground)"})}):(0,r.jsx)("div",{className:"invisible hover:visible h-full transition-opacity duration-500 ease-in-out",children:(0,r.jsx)(t6.A,{size:14})})})]})}),(0,r.jsxs)(t0,{className:"w-52",children:[(0,r.jsxs)(t1,{onClick:()=>{(0,o.eM)(t.content)},children:[(0,r.jsx)(t8.A,{})," Copy Message"]}),(0,r.jsx)(t2,{}),(0,r.jsxs)(t1,{children:[(0,r.jsx)(t9.A,{})," Reply"]})]})]})}function av(e){let{message:t}=e,a=new Date(t.id),n=!0,[l,i]=(0,s.useState)("..."),[c,d]=(0,s.useState)("..."),[u,m]=(0,s.useState)(""),{get:h}=f(),{receiver:x}=S();(0,s.useEffect)(()=>{""!==t.sender&&h(t.sender).then(e=>{i(e.username),d(e.display),m(e.avatar)})},[t.sender,x]);try{let e=new Intl.DateTimeFormat(void 0,{hour:"numeric",hour12:!0}),t=new Date(2e3,0,1,13,0,0),a=e.format(t);n=!a.includes("AM")&&!a.includes("PM")}catch(e){log(e.message,"error")}let g={hour:"numeric",minute:"numeric",hour12:!n,timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},p=new Intl.DateTimeFormat(void 0,g).format(a);return t.subMessages?(0,r.jsx)("div",{className:"w-full flex mb-3 mt-3",children:(0,r.jsxs)(tX,{children:[(0,r.jsx)(tQ,{children:(0,r.jsxs)("div",{className:"border-1 rounded-xl p-2 min-w-60 bg-input/20 hover:bg-input/23",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-[35px] h-[35px]",children:(0,r.jsxs)(eZ,{className:"bg-accent/50",children:[""!==u?(0,r.jsx)(eW.default,{className:"w-auto h-auto object-fill","data-slot":"avatar-imaasdge",width:36,height:36,src:u,alt:"",onError:()=>{m("")}}):null,(0,r.jsx)(eG,{children:(0,o.j3)(l)})]})}),(0,r.jsxs)("div",{className:"text-[15px] w-full font-bold",children:[c,(0,r.jsx)("p",{className:"text-[11.5px] text-foreground/67 pt-0.5",children:p})]})]}),(0,r.jsx)("div",{className:"text-sm break-all",children:t.subMessages.map((e,t)=>(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"p-1",children:(0,r.jsx)(ea.w,{className:"bg-border/40"})}),(0,r.jsx)(ap,{message:e,sendToServer:e.sendToServer})]},t))})]})}),(0,r.jsxs)(t0,{className:"w-52",children:[(0,r.jsxs)(t1,{onClick:()=>{(0,o.eM)(new Date(t.id))},children:[(0,r.jsx)(tB.A,{})," Copy Date"]}),(0,r.jsxs)(t1,{onClick:()=>{(0,o.eM)(t.id)},children:[(0,r.jsx)(tq.A,{})," Copy UNIX Time"]}),(0,r.jsxs)(t1,{disabled:""===u,onClick:()=>{(0,o.eM)(u)},children:[(0,r.jsx)(tV.A,{})," Copy Avatar"]})]})]})}):null}function ab(e){let{message:t}=e;return(0,r.jsx)("div",{className:"w-full flex mb-3 mt-3",children:(0,r.jsxs)("div",{className:"border-1 rounded-xl p-2 min-w-60 bg-input/20",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-[35px] h-[35px]",children:(0,r.jsx)(em,{className:"rounded-full size-8"})}),(0,r.jsxs)("div",{className:"text-[15px] w-full font-bold",children:[(0,r.jsx)(em,{className:"mr-".concat(Math.floor(16*Math.random())+10),children:(0,r.jsx)("p",{className:"invisible",children:"\uD83E\uDD74"})}),(0,r.jsx)("div",{className:"text-[11.5px] text-foreground/67 pt-0.5",children:(0,r.jsx)(em,{className:"mr-25",children:(0,r.jsx)("p",{className:"invisible",children:"\uD83E\uDD74"})})})]})]}),(0,r.jsx)("div",{className:"text-sm break-all",children:t.subMessages.map((e,t)=>(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"p-1",children:(0,r.jsx)(ea.w,{className:"bg-border/40"})}),(0,r.jsx)(em,{className:"mr-".concat(Math.floor(16*Math.random())+10),children:(0,r.jsx)("p",{className:"invisible",children:"\uD83E\uDD74"})})]},t))})]})})}var aj=a(84616);function ay(){let[e,t]=(0,s.useState)(""),{ownUuid:a,makeChatTop:n}=f(),{connected:l}=y(),{addMessage:i,navbarLoading:c,navbarLoadingMessage:o,receiver:d}=S(),u=(0,s.useRef)(null),m=(0,s.useRef)(null),h=(0,s.useCallback)(e=>{if(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)return;let t=document.activeElement;t&&("INPUT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable)&&t!==u.current||!["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End","PageUp","PageDown","Tab","Escape"].includes(e.key)&&(1===e.key.length||"Backspace"===e.key||"Delete"===e.key||"Enter"===e.key)&&u.current&&t!==u.current&&u.current.focus()},[]);async function x(r){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(r.preventDefault(),l){if(0===(s?c:e).trim().length)return;i({id:Math.floor(Date.now()).toString(),sender:a,content:s?c:e,sendToServer:!0}),n(d),s||t("")}else N.oR.error("You are not connected to a Omikron Server!")}async function g(e){var t;if(!e.target.files[0])return;let a=await (t=e.target.files[0],new Promise((e,a)=>{let r=new FileReader;r.onerror=()=>a(Error("Failed to read file")),r.onload=()=>{e(r.result.split(",")[1])},r.readAsDataURL(t)})),r="data:".concat(e.target.files[0].type,";base64,").concat(a),s="![".concat(e.target.files[0].name,"](").concat(r,")").replace("\n","");x(e,!0,s)}return(0,s.useEffect)(()=>(document.addEventListener("keydown",h),()=>{document.removeEventListener("keydown",h)}),[h]),(0,s.useEffect)(()=>{u.current&&(u.current.style.height="46px",u.current.style.height="".concat(u.current.scrollHeight,"px"))},[e]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{ref:m,type:"file",onChange:g,hidden:!0}),(0,r.jsxs)("form",{className:"flex gap-3 w-full items-center",onSubmit:x,children:[(0,r.jsx)(ee.$,{variant:"outline",className:"w-10.5 h-10.5 rounded-xl",onClick:()=>{m.current.click()},children:(0,r.jsx)(aj.A,{})}),(0,r.jsx)("textarea",{ref:u,className:"p-2.5 w-full rounded-xl text-sm resize-none placeholder:text-muted-foreground border outline-0 text-md border-input bg-card overflow-hidden",placeholder:c&&o||"Send a message...",id:"message",name:"message",value:e,onChange:e=>t(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||x(e)}})]})]})}function aw(e){let{data:t}=e,a=(0,s.useRef)(null),n=(0,s.useRef)(null),{messages:l,resetReceiver:i,navbarLoading:c,setLoadMoreMessages:o,moreMessagesLoadedOnce:d,loadedAllMessages:u,noMessageWithUser:m}=S();return(0,s.useEffect)(()=>{i(t)},[t]),(0,s.useLayoutEffect)(()=>{let e=a.current;if(e)if(null!==n.current){let t=e.scrollHeight-n.current;e.scrollTop=t,n.current=null}else d||c||(e.scrollTop=e.scrollHeight)},[l,c,d]),(0,s.useEffect)(()=>{let e=a.current;if(!e)return;let t=()=>{!(e.scrollTop<5)||c||u||m||(n.current=e.scrollHeight,o(!0))};return e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)},[c,u,m,o]),(0,r.jsxs)("div",{className:"flex h-full w-full flex-col gap-2 rounded-xl",children:[(0,r.jsxs)(to.Zp,{className:"flex flex-grow flex-col items-center gap-0 overflow-y-auto px-2.5 py-0 font-normal",ref:a,children:[u&&!m?(0,r.jsx)("p",{className:"p-2 text-sm",children:"Loaded all messages."}):null,m?(0,r.jsx)("p",{className:"p-2 text-sm",children:"You have no messages with this user."}):null,c?(0,r.jsx)(r.Fragment,{children:l.map(e=>(0,r.jsx)(ab,{message:e},e.id))}):(0,r.jsx)(r.Fragment,{children:l.map(e=>(0,r.jsx)(av,{message:e},e.id))})]}),(0,r.jsx)(ay,{})]})}var aN=a(17649);function a_(e){let{...t}=e;return(0,r.jsx)(aN.bL,{"data-slot":"alert-dialog",...t})}function aS(e){let{...t}=e;return(0,r.jsx)(aN.l9,{"data-slot":"alert-dialog-trigger",...t})}function ak(e){let{...t}=e;return(0,r.jsx)(aN.ZL,{"data-slot":"alert-dialog-portal",...t})}function aA(e){let{className:t,...a}=e;return(0,r.jsx)(aN.hJ,{"data-slot":"alert-dialog-overlay",className:(0,o.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function aC(e){let{className:t,...a}=e;return(0,r.jsxs)(ak,{children:[(0,r.jsx)(aA,{}),(0,r.jsx)(aN.UC,{"data-slot":"alert-dialog-content",className:(0,o.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...a})]})}function aE(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"alert-dialog-header",className:(0,o.cn)("flex flex-col gap-2 text-center sm:text-left",t),...a})}function aT(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"alert-dialog-footer",className:(0,o.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...a})}function aR(e){let{className:t,...a}=e;return(0,r.jsx)(aN.hE,{"data-slot":"alert-dialog-title",className:(0,o.cn)("text-lg font-semibold",t),...a})}function aI(e){let{className:t,...a}=e;return(0,r.jsx)(aN.VY,{"data-slot":"alert-dialog-description",className:(0,o.cn)("text-muted-foreground text-sm",t),...a})}function aO(e){let{className:t,...a}=e;return(0,r.jsx)(aN.rc,{className:(0,o.cn)((0,ee.r)(),t),...a})}function aM(e){let{className:t,...a}=e;return(0,r.jsx)(aN.ZD,{className:(0,o.cn)((0,ee.r)({variant:"outline"}),t),...a})}function aD(){let[e,t]=(0,s.useState)(!1),[a,n]=(0,s.useState)(""),[l,i]=(0,s.useState)(""),{setConnectToCommunity:c,connected:u,setPort:m,setDomain:h,setSecureConnection:x,secureConnection:g}=q(),{send:p}=y(),{doChatRefresh:v}=f();async function b(){try{let e="...";await fetch("".concat(d.s.username_to_uuid).concat(a)).then(e=>e.json()).then(t=>{if("error"===t.type)return void(0,o.Rm)(t.log.message,"showError");e=t.data.user_id}),(0,o.O1)(e)?await p("add_chat",{message:"Adding chat",log_level:1},{user_id:e}).then(e=>{"error"!==e.type&&((0,o.Rm)("Added ".concat(a),"success"),v())}):(0,o.Rm)("That user does not exist!","warning")}catch(e){(0,o.Rm)(e.message,"error")}finally{n("")}}async function j(){try{let e=l.split(":");h(e[0]),m(e[1]||1984),c(!0)}catch(e){(0,o.Rm)(e.message,"error")}}return(0,r.jsxs)("div",{className:"w-full h-full flex gap-3",children:[(0,r.jsxs)(to.Zp,{className:"w-full h-full",children:[(0,r.jsx)(to.aR,{children:(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)(a_,{children:[(0,r.jsx)(aS,{asChild:!0,children:(0,r.jsx)("div",{className:"flex",children:(0,r.jsx)("button",{role:"combobox","aria-expanded":e,className:"flex",children:(0,r.jsx)(eq,{children:"Add Chat"})})})}),(0,r.jsxs)(aC,{children:[(0,r.jsxs)(aE,{children:[(0,r.jsx)(aR,{children:"Enter a username"}),(0,r.jsx)(aI,{children:(0,r.jsx)(et.p,{className:"text-foreground",placeholder:"some_user",value:a,onChange:e=>{n(e.target.value)},onSubmit:b})})]}),(0,r.jsxs)(aT,{children:[(0,r.jsx)(aM,{children:"Cancel"}),(0,r.jsx)(aO,{onClick:b,children:"Add"})]})]})]}),(0,r.jsxs)(a_,{children:[(0,r.jsx)(aS,{asChild:!0,children:(0,r.jsx)("div",{className:"flex",children:(0,r.jsx)("button",{role:"combobox","aria-expanded":e,className:"flex",children:(0,r.jsx)(eq,{children:"Add Community"})})})}),(0,r.jsxs)(aC,{children:[(0,r.jsxs)(aE,{children:[(0,r.jsx)(aR,{children:"Enter a domain"}),(0,r.jsx)(aI,{asChild:!0,children:(0,r.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,r.jsx)(et.p,{className:"text-foreground",placeholder:"methanium.net",value:l,onChange:e=>{i(e.target.value)},onSubmit:j}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(tk.S,{id:"use-secure-connection",checked:g,onCheckedChange:x}),(0,r.jsx)(td.J,{className:"text-foreground",htmlFor:"use-secure-connection",children:"Use secure connection"})]})]})})]}),(0,r.jsxs)(aT,{children:[(0,r.jsx)(aM,{children:"Cancel"}),(0,r.jsx)(aO,{onClick:j,children:"Add"})]})]})]})]})}),(0,r.jsx)(to.Wu,{className:"h-full w-full",children:(0,r.jsx)("p",{children:"Homepage (Temp)"})})]}),(0,r.jsx)(to.Zp,{className:"w-70"})]})}let aL={rE:"0.1.1"};var aP=a(35169),aF=a(6670),az=a(10081),aH=a(74126),aK=a(50430),aW=a(51976);function aJ(e){let{className:t,...a}=e;return(0,r.jsx)("textarea",{"data-slot":"textarea",className:(0,o.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...a})}var aU=a(20547);function a$(e){let{...t}=e;return(0,r.jsx)(aU.bL,{"data-slot":"popover",...t})}function aZ(e){let{...t}=e;return(0,r.jsx)(aU.l9,{"data-slot":"popover-trigger",...t})}function aG(e){let{className:t,align:a="center",sideOffset:s=4,...n}=e;return(0,r.jsx)(aU.ZL,{children:(0,r.jsx)(aU.UC,{"data-slot":"popover-content",align:a,sideOffset:s,className:(0,o.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...n})})}var aB=a(4884);function aq(e){let{className:t,...a}=e;return(0,r.jsx)(aB.bL,{"data-slot":"switch",className:(0,o.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:(0,r.jsx)(aB.zi,{"data-slot":"switch-thumb",className:(0,o.cn)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}function aV(e){let{value:t,onSave:a,className:n,placeholder:l}=e,[i,c]=(0,s.useState)(!1),o=(0,s.useRef)(null);return(0,s.useEffect)(()=>{if(i&&o.current){o.current.focus();let e=document.createRange(),t=window.getSelection();e.selectNodeContents(o.current),e.collapse(!1),t.removeAllRanges(),t.addRange(e)}},[i]),(0,r.jsx)("p",{ref:o,className:"break-words whitespace-pre-wrap outline-none ".concat(i?"cursor-text":""," ").concat(""===t&&!i?"opacity-50":""," ").concat(n),onClick:()=>{c(!0)},onBlur:()=>{c(!1),o.current&&a&&a(o.current.textContent.trim())},onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),o.current.blur())},contentEditable:i,suppressContentEditableWarning:!0,children:""!==t||i?t:l})}function aY(e){let{name:t,value:a,onSave:n,onChar:l,maxChars:i,className:c,placeholder:d}=e,[u,m]=(0,s.useState)("");return(0,s.useEffect)(()=>{m(a)},[a]),(0,r.jsx)(aJ,{className:(0,o.cn)("placeholder break-words whitespace-pre-wrap outline-none cursor-text resize-none h-35",c),onBlur:function(){u.length<=i?n(u):N.oR.error("".concat(t," too long!"))},placeholder:d,value:u,onChange:function(e){m(e.target.value),l(e.target.value.length)}})}var aX=a(29869);function aQ(e){let{avatarUrl:t,onSave:a,className:n}=e,l=(0,s.useRef)(null),[i,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)(null),m=async e=>{let t=e.target.files[0];if(t){if(u(null),c(!0),!t.type.startsWith("image/")){u("Please upload an image file (e.g., .jpg, .png)."),c(!1);return}if(t.size>5242880){u("File size exceeds ".concat(5,"MB.")),c(!1);return}try{let e=new FileReader;e.readAsDataURL(t),e.onloadend=async()=>{let t=e.result,r=await (0,o.D4)(t,!0,0);a(r),c(!1)},e.onerror=e=>{(0,o.Rm)(e.message,"showError"),u("Failed to read file."),c(!1)}}catch(e){(0,o.Rm)(e.message,"showError"),u("Error processing image."),c(!1)}finally{e.target.value=""}}};return(0,s.useEffect)(()=>{""!==d&&null!==d&&N.oR.error(d)},[d]),(0,r.jsxs)("div",{className:(0,o.cn)("relative group cursor-pointer",n),onClick:()=>{l.current&&l.current.click()},children:[(0,r.jsx)("img",{src:t,alt:"User Avatar",className:"border-1 bg-input/15 w-full h-full object-cover rounded-full transition-all duration-300\n                    ".concat(i?"opacity-50":"group-hover:opacity-75"),onError:e=>{e.target.onerror=null,e.target.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAAtJREFUGFdjYAACAAAFAAGq1chRAAAAAElFTkSuQmCC"}}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-background/75 text-foreground rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:i?(0,r.jsx)(eI.A,{size:"20",stroke:"3",bgOpacity:"0",speed:"2",color:"var(--foreground)"}):(0,r.jsx)(aX.A,{size:20})}),(0,r.jsx)("input",{type:"file",ref:l,onChange:m,accept:"image/*",className:"hidden"})]})}var a0=a(75313);function a1(e){let{className:t,defaultValue:a,value:n,min:l=0,max:i=100,...c}=e,d=s.useMemo(()=>Array.isArray(n)?n:Array.isArray(a)?a:[l,i],[n,a,l,i]);return(0,r.jsxs)(a0.bL,{"data-slot":"slider",defaultValue:a,value:n,min:l,max:i,className:(0,o.cn)("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",t),...c,children:[(0,r.jsx)(a0.CC,{"data-slot":"slider-track",className:(0,o.cn)("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:(0,r.jsx)(a0.Q6,{"data-slot":"slider-range",className:(0,o.cn)("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:d.length},(e,t)=>(0,r.jsx)(a0.zi,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},t))]})}function a2(e){return new Promise((t,a)=>{let r=new FileReader;r.onload=e=>{t(e.target.result)},r.onerror=e=>{a(e)},r.readAsText(e)})}let a5=[{name:"Profile",id:"profile",disabled:!1,comp:function(){let{get:e,ownUuid:t,ownState:a,clearFromCache:n}=f(),{send:l}=y(),{privateKeyHash:i}=v(),[c,u]=(0,s.useState)({username:"...",display:"...",avatar:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAAtJREFUGFdjYAACAAAFAAGq1chRAAAAAElFTkSuQmCC",about:"...",status:"..."}),[m,h]=(0,s.useState)(0);function x(e,r){u(t=>({...t,[e]:r})),fetch("".concat(d.s.change).concat(e,"/").concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:'{"private_key_hash": "'.concat(i,'", "').concat(e,'": "').concat("about"!==e?r:btoa(r),'"}')}).then(e=>e.json()).then(r=>{"error"!==r.type?(N.oR.success("Updated your ".concat("display"===e?"Display Name":(0,o.Zr)(e),"!")),n(t),l("client_changed",{message:"Changed State",log_level:0},{user_state:a}).catch(e=>{})):(0,o.Rm)(r.log.message,"showError")}).catch(e=>{(0,o.Rm)(e.message,"error")})}return(0,s.useEffect)(()=>{e(t).then(e=>{u({username:e.username,display:e.display,avatar:e.avatar,about:e.about,status:e.status,sub_level:e.sub_level,sub_end:e.sub_end}),h(e.about.length)})},[]),(0,r.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,r.jsx)("p",{className:"text-muted-foreground/50",children:"Click any field to edit it"}),(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row w-full gap-5",children:[(0,r.jsxs)("div",{className:"flex flex-col w-3/4 border-1 bg-input/20 p-4 rounded-xl gap-3",children:[(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("div",{className:"flex",children:(0,r.jsx)(aQ,{avatarUrl:c.avatar,onSave:e=>x("avatar",e),className:"w-17 h-17 z-10"})}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsxs)("div",{className:"pt-9",children:[(0,r.jsx)("div",{className:"-rotate-z-45 h-5 w-0 border-l-1 border-foreground"}),(0,r.jsx)("div",{className:"-rotate-z-45 h-5 w-0 border-l-1 border-foreground"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(eq,{className:"mb-3",children:(0,r.jsx)(aV,{value:c.status,onSave:e=>x("status",e),className:"max-w-full text-background",placeholder:"Watching Memes"})}),(0,r.jsx)(aV,{value:c.display,onSave:e=>x("display",e),className:"text-2xl font-bold"}),(0,r.jsx)(aV,{value:c.username,onSave:e=>x("username",e.toLowerCase()),className:"text-foreground/67 font-bold text-sm"})]})]})]}),(0,r.jsx)("div",{children:(0,r.jsx)(aY,{name:"Description",value:c.about,onSave:e=>x("about",e),onChar:e=>h(e),maxChars:200,className:"text-sm",placeholder:"Professional nap-taker, coffee enthusiast and part-time superhero.",useBase64:!0})}),(0,r.jsx)("div",{className:"flex gap-2",children:(0,r.jsxs)("p",{className:"text-xs ".concat(m>200?"text-destructive":""),children:[m," / 200 "]})})]}),(0,r.jsxs)("div",{className:"border-1 bg-input/20 p-4 rounded-xl flex flex-col w-full justify-center items-center",children:[(0,r.jsx)("p",{children:"This is reserved space for"}),(0,r.jsx)("p",{className:"bg-clip-text text-transparent bg-gradient-to-r from-primary/60 to-primary",children:"future customizations"})]})]}),(0,r.jsx)("div",{className:"flex",children:(0,r.jsx)(ee.$,{onClick:()=>{x("avatar",o.o$)},children:"Use Clippy as profile picture"})})]})}},{name:"Appearance",id:"appearance",disabled:!1,comp:function(){let{sidebarRightSide:e,setSidebarRightSide:t,customCss:a,setCustomCss:n,customHex:i,setCustomHex:c,themeTint:d,setThemeTint:u,themeScheme:m,setThemeScheme:h}=H(),{setSidebarCategory:f}=C(),[x,g]=(0,s.useState)(a||""),[p,v]=(0,s.useState)(l.Ay.get("layout_sidebar_category_policy")||"last"),[b,j]=(0,s.useState)(i||""),[y,w]=(0,s.useState)(d||"soft"),[_,S]=(0,s.useState)(m||"dark"),[k,A]=(0,s.useState)(!1),[E,T]=(0,s.useState)(!1),[R,O]=(0,s.useState)(!1),[M,D]=(0,s.useState)(JSON.stringify(JSON.parse(l.Ay.get("theme_control"))||I,null,2));return(0,s.useEffect)(()=>{b&&(0,o.fd)(b)&&c(b)},[b]),(0,s.useEffect)(()=>{y&&u(y)},[y]),(0,s.useEffect)(()=>{_&&h(_)},[_]),(0,s.useMemo)(()=>{if(!b||!(0,o.fd)(b))return{};try{let e;if("soft"===y)e="dark"===_?F(b,"dark"):F(b,"light");else if("hard"===y)e="dark"===_?L(b,null,"dark"):L(b,null,"light");else{let t=JSON.parse(M);e="dark"===_?L(b,t,"dark"):L(b,t,"light")}let t={};for(let a in e)t[a]=e[a];return t}catch(e){return(0,o.Rm)(e.message,"error"),{}}},[b,y,_,M]),(0,s.useEffect)(()=>{l.Ay.set("layout_sidebar_category_policy",p)},[p]),(0,s.useEffect)(()=>{g(a||"")},[a]),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-2 h-full",children:[(0,r.jsxs)("div",{className:"flex w-50 flex-col gap-2",children:[(0,r.jsxs)(a$,{open:k,onOpenChange:A,children:[(0,r.jsx)(aZ,{asChild:!0,children:(0,r.jsxs)(ee.$,{variant:"outline",role:"combobox","aria-expanded":k,className:"w-[200px] justify-between",children:["soft"===y?"Soft Tint":"hard"===y?"Hard Tint":"Hard Tint (Advanced)",(0,r.jsx)(az.A,{className:"opacity-50"})]})}),(0,r.jsx)(aG,{className:"w-[200px] p-0",children:(0,r.jsx)(tL,{children:(0,r.jsx)(tz,{children:(0,r.jsxs)(tK,{children:[(0,r.jsxs)(tW,{value:"soft",onSelect:e=>{w(e),A(!1)},children:["Soft Tint",(0,r.jsx)(at.A,{className:(0,o.cn)("ml-auto","soft"===y?"opacity-100":"opacity-0")})]}),(0,r.jsxs)(tW,{value:"hard",onSelect:e=>{w(e),A(!1)},children:["Hard Tint",(0,r.jsx)(at.A,{className:(0,o.cn)("ml-auto","hard"===y?"opacity-100":"opacity-0")})]}),(0,r.jsxs)(tW,{value:"hard_a",onSelect:e=>{w(e),A(!1)},children:["Hard Tint (Advanced)",(0,r.jsx)(at.A,{className:(0,o.cn)("ml-auto","hard_a"===y?"opacity-100":"opacity-0")})]})]})})})})]}),(0,r.jsxs)(a$,{open:E,onOpenChange:T,children:[(0,r.jsx)(aZ,{asChild:!0,children:(0,r.jsxs)(ee.$,{variant:"outline",role:"combobox","aria-expanded":E,className:"w-[200px] justify-between",children:["dark"===_?"Dark":"Light",(0,r.jsx)(az.A,{className:"opacity-50"})]})}),(0,r.jsx)(aG,{className:"w-[200px] p-0",children:(0,r.jsx)(tL,{children:(0,r.jsx)(tz,{children:(0,r.jsxs)(tK,{children:[(0,r.jsxs)(tW,{value:"dark",onSelect:e=>{S(e),T(!1)},children:["Dark",(0,r.jsx)(at.A,{className:(0,o.cn)("ml-auto","dark"===_?"opacity-100":"opacity-0")})]}),(0,r.jsxs)(tW,{value:"light",onSelect:e=>{S(e),T(!1)},children:["Light",(0,r.jsx)(at.A,{className:(0,o.cn)("ml-auto","light"===_?"opacity-100":"opacity-0")})]})]})})})})]}),(0,r.jsx)("form",{className:"flex gap-2",onSubmit:function(e){e.preventDefault(),(0,o.fd)(b)&&c(b)},children:(0,r.jsx)(et.p,{placeholder:"#000000",value:b,onChange:function(e){j(e.target.value)}})}),(0,r.jsx)(aF.jI,{color:b,onChange:j})]}),(0,r.jsx)("div",{className:"flex flex-col gap-2 w-full h-auto",children:(0,r.jsx)(aJ,{placeholder:"/* Enter your custom CSS here */",value:x,onChange:e=>g(e.target.value),onBlur:()=>{n(x),N.oR.success("Applied custom CSS")},className:"border-1 resize-none h-full"})})]}),(0,r.jsx)("br",{}),"hard_a"===y?(0,r.jsxs)("form",{className:"flex flex-col gap-5",onSubmit:function(e){e.preventDefault(),l.Ay.set("theme_control",M),window.location.reload()},children:[(0,r.jsx)(aJ,{className:"border-1 resize-none outline-0",value:M,onChange:function(e){D(e.target.value)}}),(0,r.jsxs)(ee.$,{variant:"outline",type:"submit",children:[(0,r.jsx)(aa.A,{}),(0,r.jsx)("p",{className:"w-full text-left",children:"Update Theme Controls"})]})]}):null,(0,r.jsxs)(a_,{children:[(0,r.jsx)(aS,{asChild:!0,children:(0,r.jsxs)(ee.$,{variant:"destructive",className:"w-full h-9",children:[(0,r.jsx)(aH.A,{}),(0,r.jsx)("p",{className:"w-full text-left",children:"Reset color theme"})]})}),(0,r.jsxs)(aC,{children:[(0,r.jsxs)(aE,{children:[(0,r.jsx)(aR,{children:"Are you sure you want to reset your color theme?"}),(0,r.jsx)(aI,{children:"This action cannot be undone. This will delete your theme hex and all your theme control data."})]}),(0,r.jsxs)(aT,{children:[(0,r.jsx)(aM,{children:"Cancel"}),(0,r.jsx)(aO,{onClick:()=>{j(""),l.Ay.remove("theme_tint"),l.Ay.remove("theme_scheme"),l.Ay.remove("theme_hex"),l.Ay.remove("theme_control"),n(""),window.location.reload()},children:"Continue"})]})]})]})]}),(0,r.jsx)("br",{}),(0,r.jsx)("p",{className:"text-xl font-bold",children:"Layout Controls"}),(0,r.jsx)("br",{}),(0,r.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(aq,{id:"sidebar-right-switch",checked:e,onCheckedChange:t}),(0,r.jsx)(td.J,{htmlFor:"sidebar-right-switch",children:"Sidebar Right"})]}),(0,r.jsxs)(a$,{open:R,onOpenChange:O,children:[(0,r.jsx)(aZ,{asChild:!0,children:(0,r.jsxs)(ee.$,{variant:"outline",role:"combobox","aria-expanded":k,className:"w-[200px] justify-between",children:["last"===p?"Last Selected":"chats"===p?"Chats":"Communities",(0,r.jsx)(az.A,{className:"opacity-50"})]})}),(0,r.jsx)(aG,{className:"w-[200px] p-0",children:(0,r.jsx)(tL,{children:(0,r.jsx)(tz,{children:(0,r.jsxs)(tK,{children:[(0,r.jsxs)(tW,{value:"last",onSelect:e=>{v(e),O(!1)},children:["Last Selected",(0,r.jsx)(at.A,{className:(0,o.cn)("ml-auto","last"===p?"opacity-100":"opacity-0")})]}),(0,r.jsxs)(tW,{value:"chats",onSelect:e=>{v(e),l.Ay.set("layout_sidebar_category",e),O(!1)},children:["Chats",(0,r.jsx)(at.A,{className:(0,o.cn)("ml-auto","chats"===p?"opacity-100":"opacity-0")})]}),(0,r.jsxs)(tW,{value:"communities",onSelect:e=>{v(e),l.Ay.set("layout_sidebar_category",e),O(!1)},children:["Communities",(0,r.jsx)(at.A,{className:(0,o.cn)("ml-auto","communities"===p?"opacity-100":"opacity-0")})]})]})})})})]})]})]})}},{name:"Notifications",id:"notifications",disabled:!1,comp:function(){let[e,t]=(0,s.useState)("enabled"===l.Ay.get("notifications")),[a,n]=(0,s.useState)("enabled"===l.Ay.get("notifications")?"Notifications enabled.":"Enable Notifications"),{requestNotificationPermission:i}=S();return(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(ee.$,{disabled:e,onClick:async()=>{n("Requesting Permission..."),t(!0),i().then(e=>{e.success?l.Ay.set("notifications","enabled"):t(!1),n(e.message)})},children:a}),e&&(0,r.jsx)(ee.$,{variant:"outline",className:"w-9 h-9",onClick:async()=>{n("Enable Notifications"),t(!1),l.Ay.remove("notifications")},children:(0,r.jsx)(aK.A,{})})]})}},{name:"Voice",id:"voice",disabled:!1,comp:function(){var e,t;let[a,n]=(0,s.useState)([]),[l,i]=(0,s.useState)([]),[c,d]=(0,s.useState)(!1),[u,m]=(0,s.useState)(!1),[h,f]=(0,s.useState)(null),{inputDeviceId:x,setInput:g,outputDeviceId:p,setOutput:v,inputSensitivity:b,setInputSensitivity:j}=U();async function y(){if(!navigator.permissions||!navigator.permissions.query)return"unsupported";try{return(await navigator.permissions.query({name:"microphone"})).state}catch(e){return"unknown"}}return(0,s.useEffect)(()=>{let e=!0;return async function(){if(f(await y()!=="granted"),"mediaDevices"in navigator){try{let t=(await navigator.mediaDevices.enumerateDevices()).filter(e=>"audiooutput"===e.kind);e&&n(t)}catch(e){}try{let t=(await navigator.mediaDevices.enumerateDevices()).filter(e=>"audioinput"===e.kind);e&&i(t)}catch(e){}}}(),()=>{e=!1}},[]),(0,r.jsxs)("div",{className:"p-4 space-y-2",children:[h&&(0,r.jsx)(ee.$,{onClick:async()=>{try{await navigator.mediaDevices.getUserMedia({audio:!0}).then(()=>{window.location.reload()})}catch(e){}},children:"Request microphone permission"}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)(td.J,{children:"Output Device"}),(0,r.jsxs)(a$,{open:c,onOpenChange:d,children:[(0,r.jsx)(aZ,{asChild:!0,children:(0,r.jsxs)(ee.$,{disabled:h,variant:"outline",role:"combobox","aria-expanded":c,className:"justify-between w-[200px]",children:[(0,r.jsx)("p",{className:"truncate",children:h?"None":p?null==(e=a.find(e=>e.deviceId===p))?void 0:e.label:"Select device..."}),(0,r.jsx)(az.A,{className:"opacity-50"})]})}),(0,r.jsx)(aG,{className:"w-[200px] p-0",children:(0,r.jsx)(tL,{children:(0,r.jsxs)(tz,{children:[(0,r.jsx)(tH,{children:"No devices found."}),(0,r.jsx)(tK,{children:a.map(e=>(0,r.jsxs)(tW,{value:e.deviceId,onSelect:e=>{v(e===p?"default":e),d(!1)},children:[e.label||"Output ".concat(e.deviceId),(0,r.jsx)(at.A,{className:(0,o.cn)("ml-auto",p===e.deviceId?"opacity-100":"opacity-0")})]},e.deviceId))})]})})})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)(td.J,{children:"Input Device"}),(0,r.jsxs)(a$,{open:u,onOpenChange:m,children:[(0,r.jsx)(aZ,{asChild:!0,children:(0,r.jsxs)(ee.$,{disabled:h,variant:"outline",role:"combobox","aria-expanded":u,className:"justify-between w-[200px]",children:[(0,r.jsx)("p",{className:"truncate",children:h?"None":x?null==(t=l.find(e=>e.deviceId===x))?void 0:t.label:"Select device..."}),(0,r.jsx)(az.A,{className:"opacity-50"})]})}),(0,r.jsx)(aG,{className:"w-[200px] p-0",children:(0,r.jsx)(tL,{children:(0,r.jsxs)(tz,{children:[(0,r.jsx)(tH,{children:"No devices found."}),(0,r.jsx)(tK,{children:l.map(e=>(0,r.jsxs)(tW,{value:e.deviceId,onSelect:e=>{g(e===x?"default":e),m(!1)},children:[e.label||"Input ".concat(e.deviceId),(0,r.jsx)(at.A,{className:(0,o.cn)("ml-auto",x===e.deviceId?"opacity-100":"opacity-0")})]},e.deviceId))})]})})})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2 w-full max-w-md",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(td.J,{htmlFor:"input-sensitivity",children:"Input Sensitivity"}),(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:b})]}),(0,r.jsx)("div",{className:"px-1",children:(0,r.jsx)(a1,{id:"input-sensitivity",min:0,max:100,value:[b],onValueChange:e=>{let t=Array.isArray(e)?e[0]:Number(e);Number.isFinite(t)&&j(Math.min(100,Math.max(0,Math.round(t))))}})}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Lower means more sensitive; higher means you need to speak louder to transmit."})]})]})}},{name:"Premium",id:"premium",disabled:!0,comp:function(){let{get:e,ownUuid:t}=f(),[a,n]=(0,s.useState)(0),[l,i]=(0,s.useState)(0);return(0,s.useEffect)(()=>{e(t).then(e=>{n(e.sub_level),i(e.sub_end)})},[]),(0,r.jsxs)(to.Zp,{children:[(0,r.jsx)(to.Wu,{className:"ml-3",children:(0,r.jsxs)("ul",{className:"list-disc",children:[(0,r.jsx)("li",{children:"Animated & Uncompressed Profile Pictures"}),(0,r.jsx)("li",{children:(0,r.jsxs)("div",{className:"flex items-center gap-1",children:["You support us",(0,r.jsx)("div",{className:"text-red-500",children:(0,r.jsx)(aW.A,{fill:"red",size:18})})]})})]})}),(0,r.jsx)(to.wL,{children:a>=1?(0,r.jsxs)("p",{className:l<=7?"text-destructive":"",children:["Expires in ",l," Days."]}):(0,r.jsx)("p",{children:"Premium not active"})})]})}},{name:"Mods",id:"mods",disabled:!1,comp:function(){let{mods:e,setMods:t}=function(){let e=(0,s.useContext)(Z);if(void 0===e)throw Error("useModsContext must be used within a ModsProvider");return e}(),[a,n]=(0,s.useState)(""),[l,i]=(0,s.useState)(""),c=(0,s.useRef)(null),d=(0,s.useRef)(null);(0,s.useEffect)(()=>{if(a&&""!==a)try{let e=JSON.parse(a);if(e.name&&e.description&&e.version&&e.src){let a=e.name;fetch(e.src).then(e=>e.text()).then(r=>{t(t=>({...t,[a]:{name:e.name,description:e.description,version:e.version,src:btoa(r),enabled:!0}})),N.oR.success("Added Mod")})}else(0,N.oR)("Invalid Mod")}catch(e){(0,N.oR)("Invalid Mod")}},[a,t]),(0,s.useEffect)(()=>{if(l&&""!==l)try{let e=JSON.parse(l);Object.keys(e).length>=1?(t(e),N.oR.success("Added Mods")):(0,N.oR)("Invalid Mods")}catch(e){(0,N.oR)("Invalid Mods")}},[l,t]);let u=(e,a)=>{t(t=>t&&t[e]&&t[e].enabled!==a?{...t,[e]:{...t[e],enabled:a}}:t)};function m(e){let{modKey:a,mod:n,onToggle:l}=e,[i,c]=(0,s.useState)(!!n.enabled);return(0,s.useEffect)(()=>{c(!!n.enabled)},[n.enabled]),(0,r.jsx)(to.Zp,{className:"bg-input/30 border-input hover:bg-input/50",children:(0,r.jsxs)(to.aR,{children:[(0,r.jsx)(to.ZB,{children:n.name}),(0,r.jsxs)(to.X9,{className:"flex items-center gap-3",children:[(0,r.jsx)(aq,{checked:i,onCheckedChange:e=>{c(e),l&&l(a,e)}}),(0,r.jsxs)(a_,{children:[(0,r.jsx)(aS,{asChild:!0,children:(0,r.jsx)(ee.$,{variant:"ghost",className:"w-9 h-9",children:(0,r.jsx)(aH.A,{})})}),(0,r.jsxs)(aC,{children:[(0,r.jsxs)(aE,{children:[(0,r.jsx)(aR,{children:"Are you sure?"}),(0,r.jsx)(aI,{children:"This is just a confirmation so you don't accidentally delete something."})]}),(0,r.jsxs)(aT,{children:[(0,r.jsx)(aM,{children:"Cancel"}),(0,r.jsx)(aO,{onClick:()=>{t(e=>{let t={...e};return delete t[n.name],t})},children:"Continue"})]})]})]})]}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:n.description})]})},a)}return(0,r.jsxs)("div",{className:"flex flex-col gap-6 h-full",children:[(0,r.jsx)("div",{children:(0,r.jsx)("p",{className:"text-destructive text-xs md:text-md",children:"Mods are not reviewed and can steal your JWK / private key!"})}),(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-2",children:[(0,r.jsx)("input",{ref:c,onChange:async e=>{let t=Array.from(e.target.files||[]);t[0]&&n(await a2(t[0]))},className:"hidden",id:"new-mod-file",type:"file"}),(0,r.jsx)("input",{ref:d,onChange:async e=>{let t=Array.from(e.target.files||[]);t[0]&&i(await a2(t[0]))},className:"hidden",id:"new-mods-file",type:"file"}),(0,r.jsx)(ee.$,{onClick:()=>{c.current.click()},children:"Add Mod"}),(0,r.jsx)("div",{className:"w-full hidden md:block"}),(0,r.jsx)(ee.$,{variant:"outline",onClick:()=>{(0,o.YN)("mods.json",JSON.stringify(e))},children:"Export Mods"}),(0,r.jsx)(ee.$,{variant:"outline",onClick:()=>{d.current.click()},children:"Import Mods"})]}),e&&""!==e&&Object.keys(e).length>=1?(0,r.jsx)("div",{children:Object.keys(e).map(t=>(0,r.jsx)(m,{modKey:t,mod:e[t],onToggle:u},t))}):(0,r.jsxs)("div",{className:"w-full h-full flex flex-col justify-center items-center",children:[(0,r.jsx)("img",{className:"select-none [user-drag:none] [-webkit-user-drag:none]",src:"/megamind.png",width:200,height:200,alt:"Meme",loading:"eager"}),(0,r.jsx)("p",{className:"text-2xl",children:"No Mods?"})]})]})}},{name:"Developer",id:"developer",disabled:!1,comp:function(){let[e,t]=(0,s.useState)("true"===l.Ay.get("debug"));return(0,s.useEffect)(()=>{e?l.Ay.set("debug","true"):l.Ay.remove("debug")},[e]),(0,r.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,r.jsx)(aq,{id:"debugMode",checked:e,onCheckedChange:function(e){t(e)}}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)(td.J,{htmlFor:"debugMode",children:"Debug Mode"}),(0,r.jsx)("p",{className:"text-destructive text-xs",children:"Sensitive data will be printed to the console!"})]})]})}}];function a3(){let[e,t]=(0,s.useState)(""),{iotaPing:a,clientPing:n}=y();function i(t){return e===t}return(0,r.jsxs)("div",{className:"w-full h-full flex gap-3",children:[(0,r.jsxs)(to.Zp,{className:"relative p-3 w-full md:w-45 overflow-auto ".concat(""!==e&&"hidden md:block"),children:[(0,r.jsxs)(to.Wu,{className:"flex flex-col gap-2 h-full p-0",children:[a5.map(a=>(0,r.jsx)(ee.$,{disabled:a.disabled,variant:"outline",onClick:()=>{var r;e===(r=a.id)?t(""):t(r)},className:"".concat(e===a.id?"scale-105 dark:bg-card dark:hover:bg-accent/25":""," text-lg md:text-sm h-11 md:h-9"),children:a.name},a.id)),(0,r.jsx)(ee.$,{variant:"destructive",onClick:()=>{l.Ay.remove("auth_uuid"),l.Ay.remove("auth_cred_id"),l.Ay.remove("auth_private_key"),window.location.reload()},className:"text-lg md:text-sm h-11 md:h-9",children:"Logout"})]}),(0,r.jsx)(to.wL,{className:"absolute bottom-0 left-0 p-0 m-3",children:(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)("p",{className:"text-foreground/50 text-xs",children:["Version: ",aL.rE]}),(0,r.jsxs)("p",{className:"text-foreground/50 text-xs",children:["Client Ping: ",n,"ms"]}),(0,r.jsxs)("p",{className:"text-foreground/50 text-xs",children:["Iota Ping: ",a,"ms"]})]})})]}),(0,r.jsx)(to.Zp,{className:"w-full h-full overflow-auto ".concat(""===e&&"hidden md:block"),children:a5.map(a=>e===a.id?(0,r.jsxs)(to.Wu,{className:"h-full flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(ee.$,{id:"back-button",variant:"outline",className:"w-7 h-7 mr-1 md:hidden",onClick:()=>t(""),children:(0,r.jsx)(aP.A,{})}),(0,r.jsx)(td.J,{htmlFor:"back-button",className:"text-xl font-bold",children:a.name})]}),(0,r.jsx)("br",{}),(0,r.jsx)(a.comp,{})]},a.id):null)})]})}var a4=a(73553),a6=a(76517),a8=a(94449),a9=a(12486);function a7(){let{ownUuid:e}=f(),{connectedUsers:t,streamingUsers:a}=U(),[n,l]=(0,s.useState)("");return(0,s.useEffect)(()=>{if(n)return;let a=t.find(t=>t!==e);a&&l(a)},[n,t,e]),(0,s.useEffect)(()=>{n&&(t.includes(n)||l(""))},[n,t]),(0,r.jsxs)("div",{className:"flex h-full w-full flex-col gap-4 overflow-hidden",children:[(0,r.jsx)(rs,{}),(0,r.jsxs)("div",{className:"flex w-full flex-1 min-h-0 flex-col gap-2",children:[(0,r.jsx)("div",{className:"flex-1 min-h-0 px-1",children:(0,r.jsx)("div",{className:"mx-auto h-full w-full max-w-screen-xl",children:n?(0,r.jsx)(rt,{id:n,streams:a.includes(n),onFocus:e=>{e&&l("")},focused:!0,fitToParent:!0}):(0,r.jsx)("div",{className:"h-full w-full grid place-items-center text-sm text-muted-foreground",children:"Select a user from thumbnails below"})})}),(0,r.jsx)("div",{className:"flex w-full flex-none gap-2 overflow-x-auto px-1 pb-1 pt-2",children:t.filter(t=>t!==e).map(e=>n===e?null:(0,r.jsx)("div",{className:"w-[280px] flex-shrink-0",children:(0,r.jsx)(rt,{id:e,streams:a.includes(e),onFocus:t=>{t&&l(e)},focused:!1})},"thumb-".concat(e)))})]})]})}function re(){let{ownUuid:e,chatsArray:t}=f(),{connected:a,connectedUsers:n,streamingUsers:l,positions:i,setPositions:c,audioPositions:o,setAudioPositions:d,directionalAudio:u,setDirectionalAudio:m,setCanvasSize:h,endUserDrag:x}=U(),[g,p]=(0,s.useState)(!1),v=(0,s.useRef)(new Map),b=(0,s.useRef)(new Set),[,j]=(0,s.useState)(0),y=(0,s.useRef)(null),{width:w,height:N}=rr(y);(0,s.useEffect)(()=>{w&&(h({width:w,height:N||0}),c(e=>{let t={...e};Object.keys(t).forEach(e=>{n.includes(e)||delete t[e]});let a=Math.max(1,Math.floor((w+16)/112));return n.forEach((e,r)=>{if(t[e])return;let s=Math.floor(r/a);t[e]={x:r%a*112,y:112*s}}),t}),null==d||d(e=>{try{let t={...e};return Object.keys(t).forEach(e=>{n.includes(e)||delete t[e]}),n.forEach(e=>{!t[e]&&i[e]&&(t[e]={...i[e]})}),t}catch(t){return e}}))},[n,w,N,h]);let _=(0,s.useCallback)(e=>t=>{try{t.preventDefault(),t.stopPropagation()}catch(e){}let a=v.current.get(e)||t.currentTarget;if(!a)return;try{var r;null==(r=a.setPointerCapture)||r.call(a,t.pointerId)}catch(e){}let s=document.body.style.userSelect;document.body.style.userSelect="none",b.current.add(e),j(e=>e+1&65535);let n=t.clientX,l=t.clientY,o=i[e]||{x:0,y:0},d=o.x,u=o.y,m=null,h=!1,f=()=>{m=null,a.style.willChange="transform",a.style.transform="translate3d(".concat(d,"px, ").concat(u,"px, 0)"),h=!1},g=e=>{d=o.x+(e.clientX-n),u=o.y+(e.clientY-l),h||(h=!0,m=requestAnimationFrame(f))},p=()=>{window.removeEventListener("pointermove",g),window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",p);try{var r;null==(r=a.releasePointerCapture)||r.call(a,t.pointerId)}catch(e){}m&&cancelAnimationFrame(m),c(t=>({...t,[e]:{x:d,y:u}}));try{x(e)}catch(e){}a.style.willChange="",document.body.style.userSelect=s,b.current.delete(e),j(e=>e+1&65535)};window.addEventListener("pointermove",g,{passive:!0}),window.addEventListener("pointerup",p,{once:!0}),window.addEventListener("pointercancel",p,{once:!0})},[i,c,x]);return(0,r.jsxs)("div",{className:"flex h-full w-full flex-col gap-4 overflow-hidden",children:[(0,r.jsx)(rs,{}),(0,r.jsx)("div",{className:"flex w-full flex-1 min-h-0 flex-col",children:(0,r.jsxs)("div",{ref:y,className:"relative flex-1 min-h-0 w-full overflow-hidden",children:[(0,r.jsx)("div",{className:"pointer-events-none absolute inset-0 grid place-items-center",children:(0,r.jsxs)("div",{className:"relative h-28 w-28",children:[(0,r.jsx)(ta.A,{className:"absolute left-1/2 top-1/2 z-10 h-10 w-10 -translate-x-1/2 -translate-y-1/2 text-foreground"}),(0,r.jsx)("span",{className:"absolute inset-0 rounded-full border border-border/75"}),(0,r.jsx)("span",{className:"absolute -inset-10 rounded-full border border-border/50"}),(0,r.jsx)("span",{className:"absolute -inset-20 rounded-full border border-border/25"})]})}),n.filter(t=>t!==e).map(e=>{let t=i[e]||{x:0,y:0},a=b.current.has(e);return(0,r.jsx)("div",{className:"absolute cursor-grab active:cursor-grabbing",style:{...a?{}:{transform:"translate3d(".concat(t.x,"px, ").concat(t.y,"px, 0)")},width:"".concat(96,"px"),touchAction:"none"},ref:t=>{t?v.current.set(e,t):v.current.delete(e)},onPointerDown:_(e),children:(0,r.jsx)(rt,{id:e,streams:l.includes(e),focused:!1,onFocus:()=>{},mode:"avatarOnly"})},"free-".concat(e))})]})})]})}function rt(e){let{id:t,streams:a=!1,focused:n=!1,onFocus:l,dragHandleProps:i={},mode:c="tile",fitToParent:d=!1}=e,[u,m]=(0,s.useState)("..."),[h,x]=(0,s.useState)("..."),[g,p]=(0,s.useState)("..."),[v,b]=(0,s.useState)(!0),{get:j,ownUuid:y}=f(),{watchingUsers:w,voiceSend:N}=U();(0,s.useEffect)(()=>{let e=!0;return""!==t&&j(t).then(t=>{e&&(m(t.avatar),x(t.username),p(t.display))}),()=>{e=!1}},[t,j]);let _=w.includes(t),S=a&&t!==y,k=(0,s.useRef)(null),A=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:9,{width:r,height:n}=rr(e),[l,i]=(0,s.useState)({width:0,height:0});return(0,s.useLayoutEffect)(()=>{if(!r||!n)return void i({width:0,height:0});let e=t/a,s=r,l=s/e;l>n&&(s=(l=n)*e),i({width:Math.floor(s),height:Math.floor(l)})},[r,n,t,a]),l}(k,16,9);return"avatarOnly"===c?(0,r.jsx)("div",{className:"flex items-center justify-center cursor-grab active:cursor-grabbing",...i,children:"..."!==u?(0,r.jsx)("button",{className:"inline-flex items-center justify-center rounded-full border bg-background/60 hover:bg-background cursor-grab active:cursor-grabbing",children:(0,r.jsxs)(eZ,{className:"size-14 bg-background/10",children:[""!==u?(0,r.jsx)(eW.default,{className:"object-cover","data-slot":"avatar-image",width:100,height:100,src:u,alt:"",onError:()=>m("")}):null,(0,r.jsx)(eG,{children:(0,o.j3)(h)})]})}):(0,r.jsx)(em,{className:"size-14 rounded-full"})}):(0,r.jsxs)(to.Zp,{className:"\n        flex w-full flex-col overflow-hidden rounded-2xl p-3\n        ".concat(d?"h-full":"","\n      "),children:[a&&t!==y&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("div",{className:"flex min-w-0 flex-1 items-center gap-2 rounded-xl border border-input bg-input/30 p-2",children:[(0,r.jsx)("div",{className:"shrink-0",...i,children:"..."!==u?(0,r.jsxs)(eZ,{className:"size-8 bg-accent border",children:[""!==u?(0,r.jsx)(eW.default,{className:"object-cover","data-slot":"avatar-image",width:100,height:100,src:u,alt:"",onError:()=>m("")}):null,(0,r.jsx)(eG,{children:(0,o.j3)(h)})]}):(0,r.jsx)(em,{className:"size-8 rounded-full"})}),(0,r.jsx)("div",{className:"min-w-0 flex-1",children:"..."!==g?(0,r.jsx)("p",{className:"truncate",children:g}):(0,r.jsx)(em,{className:"h-4 w-20"})})]}),(0,r.jsx)(ee.$,{className:"h-auto rounded-xl p-2",variant:"outline",onClick:()=>l(!0),title:n?"Shrink":"Expand",children:n?(0,r.jsx)(a4.A,{}):(0,r.jsx)(e4.A,{})})]}),d?(0,r.jsx)("div",{ref:k,className:"relative grid h-full place-items-center",children:(0,r.jsx)("div",{className:"relative overflow-hidden rounded-xl border bg-background/40",style:{width:"".concat(A.width||0,"px"),height:"".concat(A.height||0,"px")},onClick:()=>{l(!0)},children:ra({showVideo:S,isWatching:_,loading:v,setLoading:b,id:t,ownUuid:y,voiceSend:N,onFocus:l,children:(0,r.jsx)("div",{className:"flex items-center justify-center",children:"..."!==u?(0,r.jsx)("button",{className:"inline-flex items-center justify-center rounded-full border bg-background/60 hover:bg-background",children:(0,r.jsxs)(eZ,{className:"size-25 bg-background/10",children:[""!==u?(0,r.jsx)(eW.default,{className:"object-cover","data-slot":"avatar-image",width:250,height:250,src:u,alt:"",onError:()=>m("")}):null,(0,r.jsx)(eG,{children:(0,o.j3)(h)})]})}):(0,r.jsx)(em,{className:"size-14 rounded-full"})})})})}):(0,r.jsx)("div",{className:"relative w-full overflow-hidden rounded-xl border bg-background/40 aspect-[16/9]",onClick:()=>{l(!0)},children:ra({showVideo:S,isWatching:_,loading:v,setLoading:b,id:t,ownUuid:y,voiceSend:N,onFocus:l,children:(0,r.jsx)("div",{className:"flex items-center justify-center",children:"..."!==u?(0,r.jsx)("button",{className:"inline-flex items-center justify-center rounded-full border bg-background/60 hover:bg-background",children:(0,r.jsxs)(eZ,{className:"size-15 bg-background/10",children:[""!==u?(0,r.jsx)(eW.default,{className:"object-cover","data-slot":"avatar-image",width:250,height:250,src:u,alt:"",onError:()=>m("")}):null,(0,r.jsx)(eG,{children:(0,o.j3)(h)})]})}):(0,r.jsx)(em,{className:"size-14 rounded-full"})})})})]})}function ra(e){let{showVideo:t,isWatching:a,loading:s,setLoading:n,id:l,ownUuid:i,voiceSend:c,onFocus:o,children:d}=e;return t?a?(0,r.jsxs)(r.Fragment,{children:[s&&(0,r.jsx)(em,{className:"absolute inset-0 h-full w-full rounded-xl"}),(0,r.jsx)(tU,{className:"absolute inset-0 h-full w-full ".concat(s?"hidden":""," object-contain"),id:l,onPlay:()=>n(!1)},l)]}):(0,r.jsx)(ee.$,{className:"absolute inset-0 flex h-full w-full items-center justify-center rounded-xl text-lg",variant:"outline",onClick:()=>{o(!0),c("watch_stream",{message:"".concat(i," wants to watch ").concat(l),log_level:0},{want_to_watch:!0,receiver_id:l},!1)},children:"Watch Stream..."}):(0,r.jsx)("div",{className:"absolute inset-0 flex h-full w-full flex-col items-center justify-center gap-3 p-4",children:d})}function rr(e){let[t,a]=(0,s.useState)({width:0,height:0});return(0,s.useEffect)(()=>{if(!e.current)return;let t=e.current,r=new ResizeObserver(e=>{for(let t of e){let e=t.contentRect;a({width:e.width,height:e.height})}});return r.observe(t),()=>r.disconnect()},[e]),t}function rs(){let{connected:e,directionalAudio:t,setDirectionalAudio:a,callId:n,callSecret:l}=U(),{chatsArray:i}=f(),[c,o]=(0,s.useState)(!1);return(0,r.jsxs)("div",{className:"flex w-full gap-2",children:[(0,r.jsx)(ee.$,{variant:e?"default":"destructive",className:"gap-2",children:e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a6.A,{})," Connected"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a8.A,{})," Disconnected"]})}),(0,r.jsxs)(ee.$,{className:"h-9 gap-2",onClick:()=>o(!0),disabled:!e,children:[(0,r.jsx)(a9.A,{})," Invite"]}),(0,r.jsxs)("div",{className:"flex gap-2 justify-center items-center",children:[(0,r.jsx)(aq,{id:"directional-audio",checked:t,onCheckedChange:a}),(0,r.jsx)(td.J,{htmlFor:"directional-audio",children:"Directional Audio"})]}),(0,r.jsxs)(tP,{open:c,onOpenChange:o,children:[(0,r.jsx)(tF,{placeholder:"Search for a Friend..."}),(0,r.jsxs)(tz,{children:[(0,r.jsx)(tH,{children:"No friends to invite."}),(0,r.jsx)(tK,{children:i.map(e=>(0,r.jsx)(t$,{id:e.user_id,onShouldClose:o},e.user_id))})]})]})]})}function rn(e){let{data:t}=e;return console.log(t),(0,r.jsx)("div",{children:"Community"})}function rl(){let[e,t]=(0,s.useState)(!1),{page:a}=C(),{sidebarRightSide:n}=H();return(0,s.useEffect)(()=>{let e=setTimeout(()=>{t(!0)},1);return()=>clearTimeout(e)},[]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eg,{className:"bg-sidebar",children:(0,r.jsxs)("div",{className:"flex flex-col w-screen h-screen overflow-hidden",children:[(0,r.jsx)("div",{className:"flex h-10",children:(0,r.jsx)(eK,{})}),(0,r.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[n?null:(0,r.jsx)(tG,{}),(0,r.jsx)(eb,{className:"border-1 border-card rounded-4xl m-2 flex flex-col flex-1 overflow-hidden",children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-5 flex-1 overflow-auto p-5 h-full transition-all duration-175 ease-out ".concat(e?"opacity-100 scale-100":"opacity-0 scale-90"),children:[(0,r.jsx)(tJ,{}),"chat"===a.name?(0,r.jsx)(aw,{data:a.data}):null,"home"===a.name?(0,r.jsx)(aD,{data:a.data}):null,"settings"===a.name?(0,r.jsx)(a3,{data:a.data}):null,"voice-expanded"===a.name?(0,r.jsx)(a7,{data:a.data}):null,"voice-rearrangement"===a.name?(0,r.jsx)(re,{data:a.data}):null,"community"===a.name?(0,r.jsx)(rn,{data:a.data}):null]})}),n?(0,r.jsx)(tG,{}):null]})]})}),(0,r.jsx)(eA,{})]})}function ri(){let[e,t]=(0,s.useState)(!1),[a,i]=(0,s.useState)(!0),c=(0,n.useRouter)(),o=(0,n.usePathname)();return(0,s.useEffect)(()=>{let e=l.Ay.get("auth_private_key"),a=l.Ay.get("auth_uuid"),r=e&&a;if(t(r),"/login"===o)return void i(!1);if(!r){c.push("/login"),i(!0);return}},[c,o]),(0,s.useEffect)(()=>{if("/login"===o)return void i(!1);e?i(!1):i(!0)},[e,o]),(0,s.useEffect)(()=>{setInterval(()=>{"true"!==l.Ay.get("debug")&&"no-warning"!==l.Ay.get("debug")&&(console.log("\n  %cDO NOT PASTE ANYTHING IN HERE!\n","color: red; font-size: 20px; font-weight: bold;"),console.log("Enabled debug mode to hide this warning."))},3e3)},[]),a?(0,r.jsx)(g.Loading,{}):"/login"===o?(0,r.jsx)(rl,{}):e?(0,r.jsx)(m.x,{children:(0,r.jsx)(x,{children:(0,r.jsx)(b,{children:(0,r.jsx)(w,{children:(0,r.jsx)(k,{children:(0,r.jsx)($,{children:(0,r.jsx)(E,{children:(0,r.jsx)(V,{children:(0,r.jsx)(K,{children:(0,r.jsx)(G,{children:(0,r.jsx)(rl,{})})})})})})})})})})}):null}},46446:(e,t,a)=>{Promise.resolve().then(a.bind(a,8180))}},e=>{var t=t=>e(e.s=t);e.O(0,[9,268,690,887,419,708,670,441,684,358],()=>t(46446)),_N_E=e.O()}]);